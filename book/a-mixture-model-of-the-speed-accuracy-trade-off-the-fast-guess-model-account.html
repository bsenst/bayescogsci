<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>20.1 A mixture model of the speed-accuracy trade-off: The fast-guess model account | An Introduction to Bayesian Data Analysis for Cognitive Science</title>
  <meta name="description" content="An introduction to Bayesian data analysis for Cognitive Science." />
  <meta name="generator" content="bookdown 0.24.1 and GitBook 2.6.7" />

  <meta property="og:title" content="20.1 A mixture model of the speed-accuracy trade-off: The fast-guess model account | An Introduction to Bayesian Data Analysis for Cognitive Science" />
  <meta property="og:type" content="book" />
  <meta property="og:url" content="https://vasishth.github.io/Bayes_CogSci/" />
  <meta property="og:image" content="https://vasishth.github.io/Bayes_CogSci//images/temporarycover.jpg" />
  <meta property="og:description" content="An introduction to Bayesian data analysis for Cognitive Science." />
  <meta name="github-repo" content="https://github.com/vasishth/Bayes_CogSci" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="20.1 A mixture model of the speed-accuracy trade-off: The fast-guess model account | An Introduction to Bayesian Data Analysis for Cognitive Science" />
  
  <meta name="twitter:description" content="An introduction to Bayesian data analysis for Cognitive Science." />
  <meta name="twitter:image" content="https://vasishth.github.io/Bayes_CogSci//images/temporarycover.jpg" />

<meta name="author" content="Bruno Nicenboim, Daniel Schad, and Shravan Vasishth" />


<meta name="date" content="2021-09-05" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="ch:mixture.html"/>
<link rel="next" href="summary-14.html"/>
<script src="libs/jquery/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook/css/style.css" rel="stylesheet" />
<link href="libs/gitbook/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections/anchor-sections.js"></script>
<script>
// FOLD code from 
// https://github.com/bblodfon/rtemps/blob/master/docs/bookdown-lite/hide_code.html
/* ========================================================================
 * Bootstrap: transition.js v3.3.7
 * http://getbootstrap.com/javascript/#transitions
 * ========================================================================
 * Copyright 2011-2016 Twitter, Inc.
 * Licensed under MIT (https://github.com/twbs/bootstrap/blob/master/LICENSE)
 * ======================================================================== */


+function ($) {
  'use strict';

  // CSS TRANSITION SUPPORT (Shoutout: http://www.modernizr.com/)
  // ============================================================

  function transitionEnd() {
    var el = document.createElement('bootstrap')

    var transEndEventNames = {
      WebkitTransition : 'webkitTransitionEnd',
      MozTransition    : 'transitionend',
      OTransition      : 'oTransitionEnd otransitionend',
      transition       : 'transitionend'
    }

    for (var name in transEndEventNames) {
      if (el.style[name] !== undefined) {
        return { end: transEndEventNames[name] }
      }
    }

    return false // explicit for ie8 (  ._.)
  }

  // http://blog.alexmaccaw.com/css-transitions
  $.fn.emulateTransitionEnd = function (duration) {
    var called = false
    var $el = this
    $(this).one('bsTransitionEnd', function () { called = true })
    var callback = function () { if (!called) $($el).trigger($.support.transition.end) }
    setTimeout(callback, duration)
    return this
  }

  $(function () {
    $.support.transition = transitionEnd()

    if (!$.support.transition) return

    $.event.special.bsTransitionEnd = {
      bindType: $.support.transition.end,
      delegateType: $.support.transition.end,
      handle: function (e) {
        if ($(e.target).is(this)) return e.handleObj.handler.apply(this, arguments)
      }
    }
  })

}(jQuery);
</script>
<script>
/* ========================================================================
 * Bootstrap: collapse.js v3.3.7
 * http://getbootstrap.com/javascript/#collapse
 * ========================================================================
 * Copyright 2011-2016 Twitter, Inc.
 * Licensed under MIT (https://github.com/twbs/bootstrap/blob/master/LICENSE)
 * ======================================================================== */

/* jshint latedef: false */

+function ($) {
  'use strict';

  // COLLAPSE PUBLIC CLASS DEFINITION
  // ================================

  var Collapse = function (element, options) {
    this.$element      = $(element)
    this.options       = $.extend({}, Collapse.DEFAULTS, options)
    this.$trigger      = $('[data-toggle="collapse"][href="#' + element.id + '"],' +
                           '[data-toggle="collapse"][data-target="#' + element.id + '"]')
    this.transitioning = null

    if (this.options.parent) {
      this.$parent = this.getParent()
    } else {
      this.addAriaAndCollapsedClass(this.$element, this.$trigger)
    }

    if (this.options.toggle) this.toggle()
  }

  Collapse.VERSION  = '3.3.7'

  Collapse.TRANSITION_DURATION = 350

  Collapse.DEFAULTS = {
    toggle: true
  }

  Collapse.prototype.dimension = function () {
    var hasWidth = this.$element.hasClass('width')
    return hasWidth ? 'width' : 'height'
  }

  Collapse.prototype.show = function () {
    if (this.transitioning || this.$element.hasClass('in')) return

    var activesData
    var actives = this.$parent && this.$parent.children('.panel').children('.in, .collapsing')

    if (actives && actives.length) {
      activesData = actives.data('bs.collapse')
      if (activesData && activesData.transitioning) return
    }

    var startEvent = $.Event('show.bs.collapse')
    this.$element.trigger(startEvent)
    if (startEvent.isDefaultPrevented()) return

    if (actives && actives.length) {
      Plugin.call(actives, 'hide')
      activesData || actives.data('bs.collapse', null)
    }

    var dimension = this.dimension()

    this.$element
      .removeClass('collapse')
      .addClass('collapsing')[dimension](0)
      .attr('aria-expanded', true)

    this.$trigger
      .removeClass('collapsed')
      .attr('aria-expanded', true)

    this.transitioning = 1

    var complete = function () {
      this.$element
        .removeClass('collapsing')
        .addClass('collapse in')[dimension]('')
      this.transitioning = 0
      this.$element
        .trigger('shown.bs.collapse')
    }

    if (!$.support.transition) return complete.call(this)

    var scrollSize = $.camelCase(['scroll', dimension].join('-'))

    this.$element
      .one('bsTransitionEnd', $.proxy(complete, this))
      .emulateTransitionEnd(Collapse.TRANSITION_DURATION)[dimension](this.$element[0][scrollSize])
  }

  Collapse.prototype.hide = function () {
    if (this.transitioning || !this.$element.hasClass('in')) return

    var startEvent = $.Event('hide.bs.collapse')
    this.$element.trigger(startEvent)
    if (startEvent.isDefaultPrevented()) return

    var dimension = this.dimension()

    this.$element[dimension](this.$element[dimension]())[0].offsetHeight

    this.$element
      .addClass('collapsing')
      .removeClass('collapse in')
      .attr('aria-expanded', false)

    this.$trigger
      .addClass('collapsed')
      .attr('aria-expanded', false)

    this.transitioning = 1

    var complete = function () {
      this.transitioning = 0
      this.$element
        .removeClass('collapsing')
        .addClass('collapse')
        .trigger('hidden.bs.collapse')
    }

    if (!$.support.transition) return complete.call(this)

    this.$element
      [dimension](0)
      .one('bsTransitionEnd', $.proxy(complete, this))
      .emulateTransitionEnd(Collapse.TRANSITION_DURATION)
  }

  Collapse.prototype.toggle = function () {
    this[this.$element.hasClass('in') ? 'hide' : 'show']()
  }

  Collapse.prototype.getParent = function () {
    return $(this.options.parent)
      .find('[data-toggle="collapse"][data-parent="' + this.options.parent + '"]')
      .each($.proxy(function (i, element) {
        var $element = $(element)
        this.addAriaAndCollapsedClass(getTargetFromTrigger($element), $element)
      }, this))
      .end()
  }

  Collapse.prototype.addAriaAndCollapsedClass = function ($element, $trigger) {
    var isOpen = $element.hasClass('in')

    $element.attr('aria-expanded', isOpen)
    $trigger
      .toggleClass('collapsed', !isOpen)
      .attr('aria-expanded', isOpen)
  }

  function getTargetFromTrigger($trigger) {
    var href
    var target = $trigger.attr('data-target')
      || (href = $trigger.attr('href')) && href.replace(/.*(?=#[^\s]+$)/, '') // strip for ie7

    return $(target)
  }


  // COLLAPSE PLUGIN DEFINITION
  // ==========================

  function Plugin(option) {
    return this.each(function () {
      var $this   = $(this)
      var data    = $this.data('bs.collapse')
      var options = $.extend({}, Collapse.DEFAULTS, $this.data(), typeof option == 'object' && option)

      if (!data && options.toggle && /show|hide/.test(option)) options.toggle = false
      if (!data) $this.data('bs.collapse', (data = new Collapse(this, options)))
      if (typeof option == 'string') data[option]()
    })
  }

  var old = $.fn.collapse

  $.fn.collapse             = Plugin
  $.fn.collapse.Constructor = Collapse


  // COLLAPSE NO CONFLICT
  // ====================

  $.fn.collapse.noConflict = function () {
    $.fn.collapse = old
    return this
  }


  // COLLAPSE DATA-API
  // =================

  $(document).on('click.bs.collapse.data-api', '[data-toggle="collapse"]', function (e) {
    var $this   = $(this)

    if (!$this.attr('data-target')) e.preventDefault()

    var $target = getTargetFromTrigger($this)
    var data    = $target.data('bs.collapse')
    var option  = data ? 'toggle' : $this.data()

    Plugin.call($target, option)
  })

}(jQuery);
</script>
<script>
window.initializeCodeFolding = function(show) {

  // handlers for show-all and hide all
  $("#rmd-show-all-code").click(function() {
    // close the dropdown menu when an option is clicked
    $("#allCodeButton").dropdown("toggle");
    $('div.r-code-collapse').each(function() {
      $(this).collapse('show');
    });
  });
  $("#rmd-hide-all-code").click(function() {
    // close the dropdown menu when an option is clicked
    $("#allCodeButton").dropdown("toggle");
    $('div.r-code-collapse').each(function() {
      $(this).collapse('hide');
    });
  });

  // index for unique code element ids
  var currentIndex = 1;

  // select all R code blocks
  var rCodeBlocks = $('pre.sourceCode, pre.r, pre.python, pre.bash, pre.sql, pre.cpp, pre.stan');
  rCodeBlocks.each(function() {

    // if code block has been labeled with class `fold-show`, show the code on init!
    var classList = $(this).attr('class').split(/\s+/);
    for (var i = 0; i < classList.length; i++) {
    if (classList[i] === 'fold-show') {
        show = true;
      }
    }

    // create a collapsable div to wrap the code in
    var div = $('<div class="collapse r-code-collapse"></div>');
    if (show)
      div.addClass('in');
    var id = 'rcode-643E0F36' + currentIndex++;
    div.attr('id', id);
    $(this).before(div);
    $(this).detach().appendTo(div);

    // add a show code button right above
    var showCodeText = $('<span>' + (show ? 'Hide' : 'Code') + '</span>');
    var showCodeButton = $('<button type="button" class="btn btn-default btn-xs code-folding-btn pull-right"></button>');
    showCodeButton.append(showCodeText);
    showCodeButton
        .attr('data-toggle', 'collapse')
        .attr('data-target', '#' + id)
        .attr('aria-expanded', show)
        .attr('aria-controls', id);

    var buttonRow = $('<div class="row"></div>');
    var buttonCol = $('<div class="col-md-12"></div>');

    buttonCol.append(showCodeButton);
    buttonRow.append(buttonCol);

    div.before(buttonRow);

    // hack: return show to false, otherwise all next codeBlocks will be shown!
    show = false;

    // update state of button on show/hide
    div.on('hidden.bs.collapse', function () {
      showCodeText.text('Code');
    });
    div.on('show.bs.collapse', function () {
      showCodeText.text('Hide');
    });
  });

}
</script>
<script>
/* ========================================================================
 * Bootstrap: dropdown.js v3.3.7
 * http://getbootstrap.com/javascript/#dropdowns
 * ========================================================================
 * Copyright 2011-2016 Twitter, Inc.
 * Licensed under MIT (https://github.com/twbs/bootstrap/blob/master/LICENSE)
 * ======================================================================== */


+function ($) {
  'use strict';

  // DROPDOWN CLASS DEFINITION
  // =========================

  var backdrop = '.dropdown-backdrop'
  var toggle   = '[data-toggle="dropdown"]'
  var Dropdown = function (element) {
    $(element).on('click.bs.dropdown', this.toggle)
  }

  Dropdown.VERSION = '3.3.7'

  function getParent($this) {
    var selector = $this.attr('data-target')

    if (!selector) {
      selector = $this.attr('href')
      selector = selector && /#[A-Za-z]/.test(selector) && selector.replace(/.*(?=#[^\s]*$)/, '') // strip for ie7
    }

    var $parent = selector && $(selector)

    return $parent && $parent.length ? $parent : $this.parent()
  }

  function clearMenus(e) {
    if (e && e.which === 3) return
    $(backdrop).remove()
    $(toggle).each(function () {
      var $this         = $(this)
      var $parent       = getParent($this)
      var relatedTarget = { relatedTarget: this }

      if (!$parent.hasClass('open')) return

      if (e && e.type == 'click' && /input|textarea/i.test(e.target.tagName) && $.contains($parent[0], e.target)) return

      $parent.trigger(e = $.Event('hide.bs.dropdown', relatedTarget))

      if (e.isDefaultPrevented()) return

      $this.attr('aria-expanded', 'false')
      $parent.removeClass('open').trigger($.Event('hidden.bs.dropdown', relatedTarget))
    })
  }

  Dropdown.prototype.toggle = function (e) {
    var $this = $(this)

    if ($this.is('.disabled, :disabled')) return

    var $parent  = getParent($this)
    var isActive = $parent.hasClass('open')

    clearMenus()

    if (!isActive) {
      if ('ontouchstart' in document.documentElement && !$parent.closest('.navbar-nav').length) {
        // if mobile we use a backdrop because click events don't delegate
        $(document.createElement('div'))
          .addClass('dropdown-backdrop')
          .insertAfter($(this))
          .on('click', clearMenus)
      }

      var relatedTarget = { relatedTarget: this }
      $parent.trigger(e = $.Event('show.bs.dropdown', relatedTarget))

      if (e.isDefaultPrevented()) return

      $this
        .trigger('focus')
        .attr('aria-expanded', 'true')

      $parent
        .toggleClass('open')
        .trigger($.Event('shown.bs.dropdown', relatedTarget))
    }

    return false
  }

  Dropdown.prototype.keydown = function (e) {
    if (!/(38|40|27|32)/.test(e.which) || /input|textarea/i.test(e.target.tagName)) return

    var $this = $(this)

    e.preventDefault()
    e.stopPropagation()

    if ($this.is('.disabled, :disabled')) return

    var $parent  = getParent($this)
    var isActive = $parent.hasClass('open')

    if (!isActive && e.which != 27 || isActive && e.which == 27) {
      if (e.which == 27) $parent.find(toggle).trigger('focus')
      return $this.trigger('click')
    }

    var desc = ' li:not(.disabled):visible a'
    var $items = $parent.find('.dropdown-menu' + desc)

    if (!$items.length) return

    var index = $items.index(e.target)

    if (e.which == 38 && index > 0)                 index--         // up
    if (e.which == 40 && index < $items.length - 1) index++         // down
    if (!~index)                                    index = 0

    $items.eq(index).trigger('focus')
  }


  // DROPDOWN PLUGIN DEFINITION
  // ==========================

  function Plugin(option) {
    return this.each(function () {
      var $this = $(this)
      var data  = $this.data('bs.dropdown')

      if (!data) $this.data('bs.dropdown', (data = new Dropdown(this)))
      if (typeof option == 'string') data[option].call($this)
    })
  }

  var old = $.fn.dropdown

  $.fn.dropdown             = Plugin
  $.fn.dropdown.Constructor = Dropdown


  // DROPDOWN NO CONFLICT
  // ====================

  $.fn.dropdown.noConflict = function () {
    $.fn.dropdown = old
    return this
  }


  // APPLY TO STANDARD DROPDOWN ELEMENTS
  // ===================================

  $(document)
    .on('click.bs.dropdown.data-api', clearMenus)
    .on('click.bs.dropdown.data-api', '.dropdown form', function (e) { e.stopPropagation() })
    .on('click.bs.dropdown.data-api', toggle, Dropdown.prototype.toggle)
    .on('keydown.bs.dropdown.data-api', toggle, Dropdown.prototype.keydown)
    .on('keydown.bs.dropdown.data-api', '.dropdown-menu', Dropdown.prototype.keydown)

}(jQuery);
</script>
<style type="text/css">
.code-folding-btn {
  margin-bottom: 4px;
}

.row { display: flex; }
.collapse { display: none; }
.in { display:block }
.pull-right > .dropdown-menu {
    right: 0;
    left: auto;
}

.dropdown-menu {
    position: absolute;
    top: 100%;
    left: 0;
    z-index: 1000;
    display: none;
    float: left;
    min-width: 160px;
    padding: 5px 0;
    margin: 2px 0 0;
    font-size: 14px;
    text-align: left;
    list-style: none;
    background-color: #fff;
    -webkit-background-clip: padding-box;
    background-clip: padding-box;
    border: 1px solid #ccc;
    border: 1px solid rgba(0,0,0,.15);
    border-radius: 4px;
    -webkit-box-shadow: 0 6px 12px rgba(0,0,0,.175);
    box-shadow: 0 6px 12px rgba(0,0,0,.175);
}

.open > .dropdown-menu {
    display: block;
    color: #ffffff;
    background-color: #ffffff;
    background-image: none;
    border-color: #92897e;
}

.dropdown-menu > li > a {
  display: block;
  padding: 3px 20px;
  clear: both;
  font-weight: 400;
  line-height: 1.42857143;
  color: #000000;
  white-space: nowrap;
}

.dropdown-menu > li > a:hover,
.dropdown-menu > li > a:focus {
  color: #ffffff;
  text-decoration: none;
  background-color: #e95420;
}

.dropdown-menu > .active > a,
.dropdown-menu > .active > a:hover,
.dropdown-menu > .active > a:focus {
  color: #ffffff;
  text-decoration: none;
  background-color: #e95420;
  outline: 0;
}
.dropdown-menu > .disabled > a,
.dropdown-menu > .disabled > a:hover,
.dropdown-menu > .disabled > a:focus {
  color: #aea79f;
}

.dropdown-menu > .disabled > a:hover,
.dropdown-menu > .disabled > a:focus {
  text-decoration: none;
  cursor: not-allowed;
  background-color: transparent;
  background-image: none;
  filter: progid:DXImageTransform.Microsoft.gradient(enabled = false);
}

.btn {
  display: inline-block;
  margin-bottom: 1;
  font-weight: normal;
  text-align: center;
  white-space: nowrap;
  vertical-align: middle;
  -ms-touch-action: manipulation;
      touch-action: manipulation;
  cursor: pointer;
  background-image: none;
  border: 1px solid transparent;
  padding: 4px 8px;
  font-size: 14px;
  line-height: 1.42857143;
  border-radius: 4px;
  -webkit-user-select: none;
  -moz-user-select: none;
  -ms-user-select: none;
  user-select: none;
}

.btn:focus,
.btn:active:focus,
.btn.active:focus,
.btn.focus,
.btn:active.focus,
.btn.active.focus {
  outline: 5px auto -webkit-focus-ring-color;
  outline-offset: -2px;
}
.btn:hover,
.btn:focus,
.btn.focus {
  color: #ffffff;
  text-decoration: none;
}
.btn:active,
.btn.active {
  background-image: none;
  outline: 0;
  box-shadow: inset 0 3px 5px rgba(0, 0, 0, 0.125);
}
.btn.disabled,
.btn[disabled],
fieldset[disabled] .btn {
  cursor: not-allowed;
  filter: alpha(opacity=65);
  opacity: 0.65;
  box-shadow: none;
}
a.btn.disabled,
fieldset[disabled] a.btn {
  pointer-events: none;
}
.btn-default {
  color: #ffffff;
  background-color: #aea79f; #important
  border-color: #aea79f;
}

.btn-default:focus,
.btn-default.focus {
  color: #ffffff;
  background-color: #978e83;
  border-color: #6f675e;
}

.btn-default:hover {
  color: #ffffff;
  background-color: #978e83;
  border-color: #92897e;
}
.btn-default:active,
.btn-default.active,
.btn-group > .btn:not(:first-child):not(:last-child):not(.dropdown-toggle) {
  border-radius: 0;
}
.btn-group > .btn:first-child {
  margin-left: 0;
}
.btn-group > .btn:first-child:not(:last-child):not(.dropdown-toggle) {
  border-top-right-radius: 0;
  border-bottom-right-radius: 0;
}
.btn-group > .btn:last-child:not(:first-child),
.btn-group > .dropdown-toggle:not(:first-child) {
  border-top-left-radius: 0;
  border-bottom-left-radius: 0;
}
.btn-group > .btn-group {
  float: left;
}
.btn-group > .btn-group:not(:first-child):not(:last-child) > .btn {
  border-radius: 0;
}
.btn-group > .btn-group:first-child:not(:last-child) > .btn:last-child,
.btn-group > .btn-group:first-child:not(:last-child) > .dropdown-toggle {
  border-top-right-radius: 0;
  border-bottom-right-radius: 0;
}
.btn-group > .btn-group:last-child:not(:first-child) > .btn:first-child {
  border-top-left-radius: 0;
  border-bottom-left-radius: 0;
}
.btn-group .dropdown-toggle:active,
.btn-group.open .dropdown-toggle {
  outline: 0;
}
.btn-group > .btn + .dropdown-toggle {
  padding-right: 8px;
  padding-left: 8px;
}
.btn-group > .btn-lg + .dropdown-toggle {
  padding-right: 12px;
  padding-left: 12px;
}
.btn-group.open .dropdown-toggle {
  box-shadow: inset 0 3px 5px rgba(0, 0, 0, 0.125);
}
.btn-group.open .dropdown-toggle.btn-link {
  box-shadow: none;
}

</style>
<script>
var str = '<div class="btn-group pull-right" style="position: fixed; right: 50px; top: 10px; z-index: 200"><button type="button" class="btn btn-default btn-xs dropdown-toggle" id="allCodeButton" data-toggle="dropdown" aria-haspopup="true" aria-expanded="true" data-_extension-text-contrast=""><span>Code</span> <span class="caret"></span></button><ul class="dropdown-menu" style="min-width: 50px;"><li><a id="rmd-show-all-code" href="#">Show All Code</a></li><li><a id="rmd-hide-all-code" href="#">Hide All Code</a></li></ul></div>';
document.write(str);
</script>
<script>
$(document).ready(function () {
  window.initializeCodeFolding("show" === "hide");
});
</script>


<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(data-line-number);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="css/style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Bayesian Data Analysis for Cognitive Science</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a><ul>
<li class="chapter" data-level="" data-path="prerequisites.html"><a href="prerequisites.html"><i class="fa fa-check"></i>Prerequisites</a></li>
<li class="chapter" data-level="" data-path="developing-the-right-mindset-for-this-book.html"><a href="developing-the-right-mindset-for-this-book.html"><i class="fa fa-check"></i>Developing the right mindset for this book</a></li>
<li class="chapter" data-level="" data-path="how-to-read-this-book.html"><a href="how-to-read-this-book.html"><i class="fa fa-check"></i>How to read this book</a></li>
<li class="chapter" data-level="" data-path="online-materials.html"><a href="online-materials.html"><i class="fa fa-check"></i>Online materials</a></li>
<li class="chapter" data-level="" data-path="software-needed.html"><a href="software-needed.html"><i class="fa fa-check"></i>Software needed</a></li>
<li class="chapter" data-level="" data-path="acknowledgments.html"><a href="acknowledgments.html"><i class="fa fa-check"></i>Acknowledgments</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="about-the-authors.html"><a href="about-the-authors.html"><i class="fa fa-check"></i>About the Authors</a></li>
<li class="part"><span><b>I Foundational ideas</b></span></li>
<li class="chapter" data-level="1" data-path="ch:intro.html"><a href="ch:intro.html"><i class="fa fa-check"></i><b>1</b> Introduction</a><ul>
<li class="chapter" data-level="1.1" data-path="introprob.html"><a href="introprob.html"><i class="fa fa-check"></i><b>1.1</b> Probability</a></li>
<li class="chapter" data-level="1.2" data-path="conditional-probability.html"><a href="conditional-probability.html"><i class="fa fa-check"></i><b>1.2</b> Conditional probability</a></li>
<li class="chapter" data-level="1.3" data-path="the-law-of-total-probability.html"><a href="the-law-of-total-probability.html"><i class="fa fa-check"></i><b>1.3</b> The law of total probability</a></li>
<li class="chapter" data-level="1.4" data-path="sec:binomialcloze.html"><a href="sec:binomialcloze.html"><i class="fa fa-check"></i><b>1.4</b> Discrete random variables: An example using the Binomial distribution</a><ul>
<li class="chapter" data-level="1.4.1" data-path="sec:binomialcloze.html"><a href="sec:binomialcloze.html#the-mean-and-variance-of-the-binomial-distribution"><i class="fa fa-check"></i><b>1.4.1</b> The mean and variance of the Binomial distribution</a></li>
<li class="chapter" data-level="1.4.2" data-path="sec:binomialcloze.html"><a href="sec:binomialcloze.html#what-information-does-a-probability-distribution-provide"><i class="fa fa-check"></i><b>1.4.2</b> What information does a probability distribution provide?</a></li>
</ul></li>
<li class="chapter" data-level="1.5" data-path="continuous-random-variables-an-example-using-the-normal-distribution.html"><a href="continuous-random-variables-an-example-using-the-normal-distribution.html"><i class="fa fa-check"></i><b>1.5</b> Continuous random variables: An example using the Normal distribution</a><ul>
<li class="chapter" data-level="1.5.1" data-path="continuous-random-variables-an-example-using-the-normal-distribution.html"><a href="continuous-random-variables-an-example-using-the-normal-distribution.html#an-important-distinction-probability-vs.density-in-a-continuous-random-variable"><i class="fa fa-check"></i><b>1.5.1</b> An important distinction: probability vs. density in a continuous random variable</a></li>
<li class="chapter" data-level="1.5.2" data-path="continuous-random-variables-an-example-using-the-normal-distribution.html"><a href="continuous-random-variables-an-example-using-the-normal-distribution.html#truncating-a-normal-distribution"><i class="fa fa-check"></i><b>1.5.2</b> Truncating a normal distribution</a></li>
</ul></li>
<li class="chapter" data-level="1.6" data-path="bivariate-and-multivariate-distributions.html"><a href="bivariate-and-multivariate-distributions.html"><i class="fa fa-check"></i><b>1.6</b> Bivariate and multivariate distributions</a><ul>
<li class="chapter" data-level="1.6.1" data-path="bivariate-and-multivariate-distributions.html"><a href="bivariate-and-multivariate-distributions.html#example-1-discrete-bivariate-distributions"><i class="fa fa-check"></i><b>1.6.1</b> Example 1: Discrete bivariate distributions</a></li>
<li class="chapter" data-level="1.6.2" data-path="bivariate-and-multivariate-distributions.html"><a href="bivariate-and-multivariate-distributions.html#sec:contbivar"><i class="fa fa-check"></i><b>1.6.2</b> Example 2: Continuous bivariate distributions</a></li>
<li class="chapter" data-level="1.6.3" data-path="bivariate-and-multivariate-distributions.html"><a href="bivariate-and-multivariate-distributions.html#sec:generatebivariatedata"><i class="fa fa-check"></i><b>1.6.3</b> Generate simulated bivariate (multivariate) data</a></li>
</ul></li>
<li class="chapter" data-level="1.7" data-path="sec:marginal.html"><a href="sec:marginal.html"><i class="fa fa-check"></i><b>1.7</b> An important concept: The marginal likelihood (integrating out a parameter)</a></li>
<li class="chapter" data-level="1.8" data-path="summary-of-useful-r-functions-relating-to-distributions.html"><a href="summary-of-useful-r-functions-relating-to-distributions.html"><i class="fa fa-check"></i><b>1.8</b> Summary of useful R functions relating to distributions</a></li>
<li class="chapter" data-level="1.9" data-path="summary.html"><a href="summary.html"><i class="fa fa-check"></i><b>1.9</b> Summary</a></li>
<li class="chapter" data-level="1.10" data-path="further-reading.html"><a href="further-reading.html"><i class="fa fa-check"></i><b>1.10</b> Further reading</a></li>
<li class="chapter" data-level="1.11" data-path="sec:Foundationsexercises.html"><a href="sec:Foundationsexercises.html"><i class="fa fa-check"></i><b>1.11</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="ch:introBDA.html"><a href="ch:introBDA.html"><i class="fa fa-check"></i><b>2</b> Introduction to Bayesian data analysis</a><ul>
<li class="chapter" data-level="2.1" data-path="bayes-rule.html"><a href="bayes-rule.html"><i class="fa fa-check"></i><b>2.1</b> Bayes’ rule</a></li>
<li class="chapter" data-level="2.2" data-path="sec:analytical.html"><a href="sec:analytical.html"><i class="fa fa-check"></i><b>2.2</b> Deriving the posterior using Bayes’ rule: An analytical example</a><ul>
<li class="chapter" data-level="2.2.1" data-path="sec:analytical.html"><a href="sec:analytical.html#choosing-a-likelihood"><i class="fa fa-check"></i><b>2.2.1</b> Choosing a likelihood</a></li>
<li class="chapter" data-level="2.2.2" data-path="sec:analytical.html"><a href="sec:analytical.html#sec:choosepriortheta"><i class="fa fa-check"></i><b>2.2.2</b> Choosing a prior for <span class="math inline">\(\theta\)</span></a></li>
<li class="chapter" data-level="2.2.3" data-path="sec:analytical.html"><a href="sec:analytical.html#using-bayes-rule-to-compute-the-posterior-pthetank"><i class="fa fa-check"></i><b>2.2.3</b> Using Bayes’ rule to compute the posterior <span class="math inline">\(p(\theta|n,k)\)</span></a></li>
<li class="chapter" data-level="2.2.4" data-path="sec:analytical.html"><a href="sec:analytical.html#summary-of-the-procedure"><i class="fa fa-check"></i><b>2.2.4</b> Summary of the procedure</a></li>
<li class="chapter" data-level="2.2.5" data-path="sec:analytical.html"><a href="sec:analytical.html#visualizing-the-prior-likelihood-and-the-posterior"><i class="fa fa-check"></i><b>2.2.5</b> Visualizing the prior, likelihood, and the posterior</a></li>
<li class="chapter" data-level="2.2.6" data-path="sec:analytical.html"><a href="sec:analytical.html#the-posterior-distribution-is-a-compromise-between-the-prior-and-the-likelihood"><i class="fa fa-check"></i><b>2.2.6</b> The posterior distribution is a compromise between the prior and the likelihood</a></li>
<li class="chapter" data-level="2.2.7" data-path="sec:analytical.html"><a href="sec:analytical.html#incremental-knowledge-gain-using-prior-knowledge"><i class="fa fa-check"></i><b>2.2.7</b> Incremental knowledge gain using prior knowledge</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="summary-1.html"><a href="summary-1.html"><i class="fa fa-check"></i><b>2.3</b> Summary</a></li>
<li class="chapter" data-level="2.4" data-path="further-reading-1.html"><a href="further-reading-1.html"><i class="fa fa-check"></i><b>2.4</b> Further reading</a></li>
<li class="chapter" data-level="2.5" data-path="sec:BDAexercises.html"><a href="sec:BDAexercises.html"><i class="fa fa-check"></i><b>2.5</b> Exercises</a></li>
</ul></li>
<li class="part"><span><b>II Regression models with brms</b></span></li>
<li class="chapter" data-level="3" data-path="ch:compbda.html"><a href="ch:compbda.html"><i class="fa fa-check"></i><b>3</b> Computational Bayesian data analysis</a><ul>
<li class="chapter" data-level="3.1" data-path="sec:sampling.html"><a href="sec:sampling.html"><i class="fa fa-check"></i><b>3.1</b> Deriving the posterior through sampling</a><ul>
<li class="chapter" data-level="3.1.1" data-path="sec:sampling.html"><a href="sec:sampling.html#bayesian-regression-models-using-stan-brms"><i class="fa fa-check"></i><b>3.1.1</b> Bayesian Regression Models using ‘Stan’: brms</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="sec:priorpred.html"><a href="sec:priorpred.html"><i class="fa fa-check"></i><b>3.2</b> Prior predictive distribution</a></li>
<li class="chapter" data-level="3.3" data-path="sec:sensitivity.html"><a href="sec:sensitivity.html"><i class="fa fa-check"></i><b>3.3</b> The influence of priors: sensitivity analysis</a><ul>
<li class="chapter" data-level="3.3.1" data-path="sec:sensitivity.html"><a href="sec:sensitivity.html#flat-uninformative-priors"><i class="fa fa-check"></i><b>3.3.1</b> Flat, uninformative priors</a></li>
<li class="chapter" data-level="3.3.2" data-path="sec:sensitivity.html"><a href="sec:sensitivity.html#regularizing-priors"><i class="fa fa-check"></i><b>3.3.2</b> Regularizing priors</a></li>
<li class="chapter" data-level="3.3.3" data-path="sec:sensitivity.html"><a href="sec:sensitivity.html#principled-priors"><i class="fa fa-check"></i><b>3.3.3</b> Principled priors</a></li>
<li class="chapter" data-level="3.3.4" data-path="sec:sensitivity.html"><a href="sec:sensitivity.html#informative-priors"><i class="fa fa-check"></i><b>3.3.4</b> Informative priors</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="sec:revisit.html"><a href="sec:revisit.html"><i class="fa fa-check"></i><b>3.4</b> Revisiting the button-pressing example with different priors</a></li>
<li class="chapter" data-level="3.5" data-path="sec:ppd.html"><a href="sec:ppd.html"><i class="fa fa-check"></i><b>3.5</b> Posterior predictive distribution</a><ul>
<li class="chapter" data-level="3.5.1" data-path="sec:ppd.html"><a href="sec:ppd.html#comparing-different-likelihoods"><i class="fa fa-check"></i><b>3.5.1</b> Comparing different likelihoods</a></li>
<li class="chapter" data-level="3.5.2" data-path="sec:ppd.html"><a href="sec:ppd.html#sec:lnfirst"><i class="fa fa-check"></i><b>3.5.2</b> The log-normal likelihood</a></li>
<li class="chapter" data-level="3.5.3" data-path="sec:ppd.html"><a href="sec:ppd.html#sec:lognormal"><i class="fa fa-check"></i><b>3.5.3</b> Re-fitting a single subject pressing a button repeatedly with a log-normal likelihood</a></li>
</ul></li>
<li class="chapter" data-level="3.6" data-path="summary-2.html"><a href="summary-2.html"><i class="fa fa-check"></i><b>3.6</b> Summary</a></li>
<li class="chapter" data-level="3.7" data-path="sec:ch3furtherreading.html"><a href="sec:ch3furtherreading.html"><i class="fa fa-check"></i><b>3.7</b> Further reading</a></li>
<li class="chapter" data-level="3.8" data-path="ex:compbda.html"><a href="ex:compbda.html"><i class="fa fa-check"></i><b>3.8</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="ch:reg.html"><a href="ch:reg.html"><i class="fa fa-check"></i><b>4</b> Bayesian regression models</a><ul>
<li class="chapter" data-level="4.1" data-path="sec:pupil.html"><a href="sec:pupil.html"><i class="fa fa-check"></i><b>4.1</b> A first linear regression: Does attentional load affect pupil size?</a><ul>
<li class="chapter" data-level="4.1.1" data-path="sec:pupil.html"><a href="sec:pupil.html#likelihood-and-priors"><i class="fa fa-check"></i><b>4.1.1</b> Likelihood and priors</a></li>
<li class="chapter" data-level="4.1.2" data-path="sec:pupil.html"><a href="sec:pupil.html#the-brms-model"><i class="fa fa-check"></i><b>4.1.2</b> The <code>brms</code> model</a></li>
<li class="chapter" data-level="4.1.3" data-path="sec:pupil.html"><a href="sec:pupil.html#how-to-communicate-the-results"><i class="fa fa-check"></i><b>4.1.3</b> How to communicate the results?</a></li>
<li class="chapter" data-level="4.1.4" data-path="sec:pupil.html"><a href="sec:pupil.html#sec:pupiladq"><i class="fa fa-check"></i><b>4.1.4</b> Descriptive adequacy</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="sec:trial.html"><a href="sec:trial.html"><i class="fa fa-check"></i><b>4.2</b> Log-normal model: Does trial affect response times?</a><ul>
<li class="chapter" data-level="4.2.1" data-path="sec:trial.html"><a href="sec:trial.html#likelihood-and-priors-for-the-log-normal-model"><i class="fa fa-check"></i><b>4.2.1</b> Likelihood and priors for the log-normal model</a></li>
<li class="chapter" data-level="4.2.2" data-path="sec:trial.html"><a href="sec:trial.html#the-brms-model-1"><i class="fa fa-check"></i><b>4.2.2</b> The <code>brms</code> model</a></li>
<li class="chapter" data-level="4.2.3" data-path="sec:trial.html"><a href="sec:trial.html#how-to-communicate-the-results-1"><i class="fa fa-check"></i><b>4.2.3</b> How to communicate the results?</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="sec:logistic.html"><a href="sec:logistic.html"><i class="fa fa-check"></i><b>4.3</b> Logistic regression: Does set size affect free recall?</a><ul>
<li class="chapter" data-level="4.3.1" data-path="sec:logistic.html"><a href="sec:logistic.html#the-likelihood-for-the-logistic-regression-model"><i class="fa fa-check"></i><b>4.3.1</b> The likelihood for the logistic regression model</a></li>
<li class="chapter" data-level="4.3.2" data-path="sec:logistic.html"><a href="sec:logistic.html#priors-for-the-logistic-regression"><i class="fa fa-check"></i><b>4.3.2</b> Priors for the logistic regression</a></li>
<li class="chapter" data-level="4.3.3" data-path="sec:logistic.html"><a href="sec:logistic.html#the-brms-model-2"><i class="fa fa-check"></i><b>4.3.3</b> The <code>brms</code> model</a></li>
<li class="chapter" data-level="4.3.4" data-path="sec:logistic.html"><a href="sec:logistic.html#sec:comlogis"><i class="fa fa-check"></i><b>4.3.4</b> How to communicate the results?</a></li>
<li class="chapter" data-level="4.3.5" data-path="sec:logistic.html"><a href="sec:logistic.html#descriptive-adequacy"><i class="fa fa-check"></i><b>4.3.5</b> Descriptive adequacy</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="summary-3.html"><a href="summary-3.html"><i class="fa fa-check"></i><b>4.4</b> Summary</a></li>
<li class="chapter" data-level="4.5" data-path="sec:ch4furtherreading.html"><a href="sec:ch4furtherreading.html"><i class="fa fa-check"></i><b>4.5</b> Further reading</a></li>
<li class="chapter" data-level="4.6" data-path="sec:LMexercises.html"><a href="sec:LMexercises.html"><i class="fa fa-check"></i><b>4.6</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="ch:hierarchical.html"><a href="ch:hierarchical.html"><i class="fa fa-check"></i><b>5</b> Bayesian hierarchical models</a><ul>
<li class="chapter" data-level="5.1" data-path="sec:N400hierarchical.html"><a href="sec:N400hierarchical.html"><i class="fa fa-check"></i><b>5.1</b> A hierarchical model with a normal likelihood: The N400 effect</a><ul>
<li class="chapter" data-level="5.1.1" data-path="sec:N400hierarchical.html"><a href="sec:N400hierarchical.html#complete-pooling-model-m_cp"><i class="fa fa-check"></i><b>5.1.1</b> Complete pooling model (<span class="math inline">\(M_{cp}\)</span>)</a></li>
<li class="chapter" data-level="5.1.2" data-path="sec:N400hierarchical.html"><a href="sec:N400hierarchical.html#no-pooling-model-m_np"><i class="fa fa-check"></i><b>5.1.2</b> No pooling model (<span class="math inline">\(M_{np}\)</span>)</a></li>
<li class="chapter" data-level="5.1.3" data-path="sec:N400hierarchical.html"><a href="sec:N400hierarchical.html#sec:uncorrelated"><i class="fa fa-check"></i><b>5.1.3</b> Varying intercepts and varying slopes model (<span class="math inline">\(M_{v}\)</span>)</a></li>
<li class="chapter" data-level="5.1.4" data-path="sec:N400hierarchical.html"><a href="sec:N400hierarchical.html#sec:mcvivs"><i class="fa fa-check"></i><b>5.1.4</b> Correlated varying intercept varying slopes model (<span class="math inline">\(M_{h}\)</span>)</a></li>
<li class="chapter" data-level="5.1.5" data-path="sec:N400hierarchical.html"><a href="sec:N400hierarchical.html#sec:sih"><i class="fa fa-check"></i><b>5.1.5</b> By-subjects and by-items correlated varying intercept varying slopes model (<span class="math inline">\(M_{sih}\)</span>)</a></li>
<li class="chapter" data-level="5.1.6" data-path="sec:N400hierarchical.html"><a href="sec:N400hierarchical.html#sec:distrmodel"><i class="fa fa-check"></i><b>5.1.6</b> Beyond the maximal model–Distributional regression models</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="sec:stroop.html"><a href="sec:stroop.html"><i class="fa fa-check"></i><b>5.2</b> A hierarchical log-normal model: The Stroop effect</a><ul>
<li class="chapter" data-level="5.2.1" data-path="sec:stroop.html"><a href="sec:stroop.html#a-correlated-varying-intercept-varying-slopes-log-normal-model"><i class="fa fa-check"></i><b>5.2.1</b> A correlated varying intercept varying slopes log-normal model</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="why-fitting-a-bayesian-hierarchical-model-is-worth-the-effort.html"><a href="why-fitting-a-bayesian-hierarchical-model-is-worth-the-effort.html"><i class="fa fa-check"></i><b>5.3</b> Why fitting a Bayesian hierarchical model is worth the effort</a></li>
<li class="chapter" data-level="5.4" data-path="summary-4.html"><a href="summary-4.html"><i class="fa fa-check"></i><b>5.4</b> Summary</a></li>
<li class="chapter" data-level="5.5" data-path="further-reading-2.html"><a href="further-reading-2.html"><i class="fa fa-check"></i><b>5.5</b> Further reading</a></li>
<li class="chapter" data-level="5.6" data-path="sec:HLMexercises.html"><a href="sec:HLMexercises.html"><i class="fa fa-check"></i><b>5.6</b> Exercises</a><ul>
<li class="chapter" data-level="" data-path="sec:HLMexercises.html"><a href="sec:HLMexercises.html#exercises-with-a-normal-likelihood"><i class="fa fa-check"></i>Exercises with a normal likelihood</a></li>
<li class="chapter" data-level="" data-path="sec:HLMexercises.html"><a href="sec:HLMexercises.html#exercises-with-a-log-normal-likelihood"><i class="fa fa-check"></i>Exercises with a log-normal likelihood</a></li>
<li class="chapter" data-level="" data-path="sec:HLMexercises.html"><a href="sec:HLMexercises.html#exercises-with-a-logistic-regression-bernoulli-likelihood."><i class="fa fa-check"></i>Exercises with a logistic regression (Bernoulli likelihood).</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="ch:priors.html"><a href="ch:priors.html"><i class="fa fa-check"></i><b>6</b> The Art and Science of Prior Elicitation</a><ul>
<li class="chapter" data-level="6.1" data-path="sec:simpleexamplepriors.html"><a href="sec:simpleexamplepriors.html"><i class="fa fa-check"></i><b>6.1</b> Eliciting priors from oneself for a self-paced reading study: A simple example</a></li>
<li class="chapter" data-level="6.2" data-path="eliciting-priors-from-experts.html"><a href="eliciting-priors-from-experts.html"><i class="fa fa-check"></i><b>6.2</b> Eliciting priors from experts</a></li>
<li class="chapter" data-level="6.3" data-path="deriving-priors-from-meta-analyses.html"><a href="deriving-priors-from-meta-analyses.html"><i class="fa fa-check"></i><b>6.3</b> Deriving priors from meta-analyses</a></li>
<li class="chapter" data-level="6.4" data-path="using-previous-experiments-posteriors-as-priors-for-a-new-study.html"><a href="using-previous-experiments-posteriors-as-priors-for-a-new-study.html"><i class="fa fa-check"></i><b>6.4</b> Using previous experiments’ posteriors as priors for a new study</a></li>
<li class="chapter" data-level="6.5" data-path="summary-5.html"><a href="summary-5.html"><i class="fa fa-check"></i><b>6.5</b> Summary</a></li>
<li class="chapter" data-level="6.6" data-path="further-reading-3.html"><a href="further-reading-3.html"><i class="fa fa-check"></i><b>6.6</b> Further reading</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="ch:workflow.html"><a href="ch:workflow.html"><i class="fa fa-check"></i><b>7</b> Workflow</a><ul>
<li class="chapter" data-level="7.1" data-path="model-building.html"><a href="model-building.html"><i class="fa fa-check"></i><b>7.1</b> Model building</a></li>
<li class="chapter" data-level="7.2" data-path="principled-questions-on-a-model.html"><a href="principled-questions-on-a-model.html"><i class="fa fa-check"></i><b>7.2</b> Principled questions on a model</a><ul>
<li class="chapter" data-level="7.2.1" data-path="principled-questions-on-a-model.html"><a href="principled-questions-on-a-model.html#prior-predictive-checks-checking-consistency-with-domain-expertise"><i class="fa fa-check"></i><b>7.2.1</b> Prior predictive checks: Checking consistency with domain expertise</a></li>
<li class="chapter" data-level="7.2.2" data-path="principled-questions-on-a-model.html"><a href="principled-questions-on-a-model.html#computational-faithfulness-testing-for-correct-posterior-approximations"><i class="fa fa-check"></i><b>7.2.2</b> Computational faithfulness: Testing for correct posterior approximations</a></li>
<li class="chapter" data-level="7.2.3" data-path="principled-questions-on-a-model.html"><a href="principled-questions-on-a-model.html#model-sensitivity"><i class="fa fa-check"></i><b>7.2.3</b> Model sensitivity</a></li>
<li class="chapter" data-level="7.2.4" data-path="principled-questions-on-a-model.html"><a href="principled-questions-on-a-model.html#posterior-predictive-checks-does-the-model-adequately-capture-the-data"><i class="fa fa-check"></i><b>7.2.4</b> Posterior predictive checks: Does the model adequately capture the data?</a></li>
</ul></li>
<li class="chapter" data-level="7.3" data-path="exemplary-data-analysis.html"><a href="exemplary-data-analysis.html"><i class="fa fa-check"></i><b>7.3</b> Exemplary data analysis</a><ul>
<li class="chapter" data-level="7.3.1" data-path="exemplary-data-analysis.html"><a href="exemplary-data-analysis.html#prior-predictive-checks"><i class="fa fa-check"></i><b>7.3.1</b> Prior predictive checks</a></li>
<li class="chapter" data-level="7.3.2" data-path="exemplary-data-analysis.html"><a href="exemplary-data-analysis.html#adjusting-priors"><i class="fa fa-check"></i><b>7.3.2</b> Adjusting priors</a></li>
<li class="chapter" data-level="7.3.3" data-path="exemplary-data-analysis.html"><a href="exemplary-data-analysis.html#computational-faithfulness-and-model-sensitivity"><i class="fa fa-check"></i><b>7.3.3</b> Computational faithfulness and model sensitivity</a></li>
<li class="chapter" data-level="7.3.4" data-path="exemplary-data-analysis.html"><a href="exemplary-data-analysis.html#posterior-predictive-checks-model-adequacy"><i class="fa fa-check"></i><b>7.3.4</b> Posterior predictive checks: Model adequacy</a></li>
</ul></li>
<li class="chapter" data-level="7.4" data-path="summary-6.html"><a href="summary-6.html"><i class="fa fa-check"></i><b>7.4</b> Summary</a></li>
<li class="chapter" data-level="7.5" data-path="further-reading-4.html"><a href="further-reading-4.html"><i class="fa fa-check"></i><b>7.5</b> Further reading</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="ch:contr.html"><a href="ch:contr.html"><i class="fa fa-check"></i><b>8</b> Contrast coding</a><ul>
<li class="chapter" data-level="8.1" data-path="basic-concepts-illustrated-using-a-two-level-factor.html"><a href="basic-concepts-illustrated-using-a-two-level-factor.html"><i class="fa fa-check"></i><b>8.1</b> Basic concepts illustrated using a two-level factor</a><ul>
<li class="chapter" data-level="8.1.1" data-path="basic-concepts-illustrated-using-a-two-level-factor.html"><a href="basic-concepts-illustrated-using-a-two-level-factor.html#treatmentcontrasts"><i class="fa fa-check"></i><b>8.1.1</b> Default contrast coding: Treatment contrasts</a></li>
<li class="chapter" data-level="8.1.2" data-path="basic-concepts-illustrated-using-a-two-level-factor.html"><a href="basic-concepts-illustrated-using-a-two-level-factor.html#inverseMatrix"><i class="fa fa-check"></i><b>8.1.2</b> Defining comparisons</a></li>
<li class="chapter" data-level="8.1.3" data-path="basic-concepts-illustrated-using-a-two-level-factor.html"><a href="basic-concepts-illustrated-using-a-two-level-factor.html#effectcoding"><i class="fa fa-check"></i><b>8.1.3</b> Sum contrasts</a></li>
<li class="chapter" data-level="8.1.4" data-path="basic-concepts-illustrated-using-a-two-level-factor.html"><a href="basic-concepts-illustrated-using-a-two-level-factor.html#sec:cellMeans"><i class="fa fa-check"></i><b>8.1.4</b> Cell means parameterization and posterior comparisons</a></li>
</ul></li>
<li class="chapter" data-level="8.2" data-path="the-hypothesis-matrix-illustrated-with-a-three-level-factor.html"><a href="the-hypothesis-matrix-illustrated-with-a-three-level-factor.html"><i class="fa fa-check"></i><b>8.2</b> The hypothesis matrix illustrated with a three-level factor</a><ul>
<li class="chapter" data-level="8.2.1" data-path="the-hypothesis-matrix-illustrated-with-a-three-level-factor.html"><a href="the-hypothesis-matrix-illustrated-with-a-three-level-factor.html#sumcontrasts"><i class="fa fa-check"></i><b>8.2.1</b> Sum contrasts</a></li>
<li class="chapter" data-level="8.2.2" data-path="the-hypothesis-matrix-illustrated-with-a-three-level-factor.html"><a href="the-hypothesis-matrix-illustrated-with-a-three-level-factor.html#the-hypothesis-matrix"><i class="fa fa-check"></i><b>8.2.2</b> The hypothesis matrix</a></li>
<li class="chapter" data-level="8.2.3" data-path="the-hypothesis-matrix-illustrated-with-a-three-level-factor.html"><a href="the-hypothesis-matrix-illustrated-with-a-three-level-factor.html#generating-contrasts-the-hypr-package"><i class="fa fa-check"></i><b>8.2.3</b> Generating contrasts: The <code>hypr</code> package</a></li>
</ul></li>
<li class="chapter" data-level="8.3" data-path="sec:4levelFactor.html"><a href="sec:4levelFactor.html"><i class="fa fa-check"></i><b>8.3</b> Other types of contrasts: illustration with a factor with four levels</a><ul>
<li class="chapter" data-level="8.3.1" data-path="sec:4levelFactor.html"><a href="sec:4levelFactor.html#repeatedcontrasts"><i class="fa fa-check"></i><b>8.3.1</b> Repeated contrasts</a></li>
<li class="chapter" data-level="8.3.2" data-path="sec:4levelFactor.html"><a href="sec:4levelFactor.html#helmertcontrasts"><i class="fa fa-check"></i><b>8.3.2</b> Helmert contrasts</a></li>
<li class="chapter" data-level="8.3.3" data-path="sec:4levelFactor.html"><a href="sec:4levelFactor.html#contrasts-in-linear-regression-analysis-the-design-or-model-matrix"><i class="fa fa-check"></i><b>8.3.3</b> Contrasts in linear regression analysis: The design or model matrix</a></li>
<li class="chapter" data-level="8.3.4" data-path="sec:4levelFactor.html"><a href="sec:4levelFactor.html#polynomialContrasts"><i class="fa fa-check"></i><b>8.3.4</b> Polynomial contrasts</a></li>
<li class="chapter" data-level="8.3.5" data-path="sec:4levelFactor.html"><a href="sec:4levelFactor.html#an-alternative-to-contrasts-monotonic-effects"><i class="fa fa-check"></i><b>8.3.5</b> An alternative to contrasts: monotonic effects</a></li>
</ul></li>
<li class="chapter" data-level="8.4" data-path="nonOrthogonal.html"><a href="nonOrthogonal.html"><i class="fa fa-check"></i><b>8.4</b> What makes a good set of contrasts?</a><ul>
<li class="chapter" data-level="8.4.1" data-path="nonOrthogonal.html"><a href="nonOrthogonal.html#centered-contrasts"><i class="fa fa-check"></i><b>8.4.1</b> Centered contrasts</a></li>
<li class="chapter" data-level="8.4.2" data-path="nonOrthogonal.html"><a href="nonOrthogonal.html#orthogonal-contrasts"><i class="fa fa-check"></i><b>8.4.2</b> Orthogonal contrasts</a></li>
<li class="chapter" data-level="8.4.3" data-path="nonOrthogonal.html"><a href="nonOrthogonal.html#the-role-of-the-intercept-in-non-centered-contrasts"><i class="fa fa-check"></i><b>8.4.3</b> The role of the intercept in non-centered contrasts</a></li>
</ul></li>
<li class="chapter" data-level="8.5" data-path="computing-condition-means-from-estimated-contrasts.html"><a href="computing-condition-means-from-estimated-contrasts.html"><i class="fa fa-check"></i><b>8.5</b> Computing condition means from estimated contrasts</a></li>
<li class="chapter" data-level="8.6" data-path="summary-7.html"><a href="summary-7.html"><i class="fa fa-check"></i><b>8.6</b> Summary</a></li>
<li class="chapter" data-level="8.7" data-path="further-reading-5.html"><a href="further-reading-5.html"><i class="fa fa-check"></i><b>8.7</b> Further reading</a></li>
<li class="chapter" data-level="8.8" data-path="sec:Contrastsexercises.html"><a href="sec:Contrastsexercises.html"><i class="fa fa-check"></i><b>8.8</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="ch:coding2x2.html"><a href="ch:coding2x2.html"><i class="fa fa-check"></i><b>9</b> Contrast coding for designs with two predictor variables</a><ul>
<li class="chapter" data-level="9.1" data-path="sec:MR:ANOVA.html"><a href="sec:MR:ANOVA.html"><i class="fa fa-check"></i><b>9.1</b> Contrast coding in a factorial <span class="math inline">\(2 \times 2\)</span> design</a><ul>
<li class="chapter" data-level="9.1.1" data-path="sec:MR:ANOVA.html"><a href="sec:MR:ANOVA.html#nestedEffects"><i class="fa fa-check"></i><b>9.1.1</b> Nested effects</a></li>
<li class="chapter" data-level="9.1.2" data-path="sec:MR:ANOVA.html"><a href="sec:MR:ANOVA.html#interactions-between-contrasts"><i class="fa fa-check"></i><b>9.1.2</b> Interactions between contrasts</a></li>
</ul></li>
<li class="chapter" data-level="9.2" data-path="sec:contrast:covariate.html"><a href="sec:contrast:covariate.html"><i class="fa fa-check"></i><b>9.2</b> One factor and one covariate</a><ul>
<li class="chapter" data-level="9.2.1" data-path="sec:contrast:covariate.html"><a href="sec:contrast:covariate.html#estimating-a-group-difference-and-controlling-for-a-covariate"><i class="fa fa-check"></i><b>9.2.1</b> Estimating a group difference and controlling for a covariate</a></li>
<li class="chapter" data-level="9.2.2" data-path="sec:contrast:covariate.html"><a href="sec:contrast:covariate.html#estimating-differences-in-slopes"><i class="fa fa-check"></i><b>9.2.2</b> Estimating differences in slopes</a></li>
</ul></li>
<li class="chapter" data-level="9.3" data-path="sec:interactions:NLM.html"><a href="sec:interactions:NLM.html"><i class="fa fa-check"></i><b>9.3</b> Interactions in generalized linear models (with non-linear link functions) and non-linear models</a></li>
<li class="chapter" data-level="9.4" data-path="summary-8.html"><a href="summary-8.html"><i class="fa fa-check"></i><b>9.4</b> Summary</a></li>
<li class="chapter" data-level="9.5" data-path="further-readings.html"><a href="further-readings.html"><i class="fa fa-check"></i><b>9.5</b> Further readings</a></li>
<li class="chapter" data-level="9.6" data-path="sec:Contrasts2x2exercises.html"><a href="sec:Contrasts2x2exercises.html"><i class="fa fa-check"></i><b>9.6</b> Exercises</a></li>
</ul></li>
<li class="part"><span><b>III Advanced models with Stan</b></span></li>
<li class="chapter" data-level="10" data-path="ch:introstan.html"><a href="ch:introstan.html"><i class="fa fa-check"></i><b>10</b> Introduction to the probabilistic programming language Stan</a><ul>
<li class="chapter" data-level="10.1" data-path="stan-syntax.html"><a href="stan-syntax.html"><i class="fa fa-check"></i><b>10.1</b> Stan syntax</a></li>
<li class="chapter" data-level="10.2" data-path="sec:firststan.html"><a href="sec:firststan.html"><i class="fa fa-check"></i><b>10.2</b> A first simple example with Stan: Normal likelihood</a></li>
<li class="chapter" data-level="10.3" data-path="sec:clozestan.html"><a href="sec:clozestan.html"><i class="fa fa-check"></i><b>10.3</b> Another simple example: Cloze probability with Stan with the Binomial likelihood</a></li>
<li class="chapter" data-level="10.4" data-path="regression-models-in-stan.html"><a href="regression-models-in-stan.html"><i class="fa fa-check"></i><b>10.4</b> Regression models in Stan</a><ul>
<li class="chapter" data-level="10.4.1" data-path="regression-models-in-stan.html"><a href="regression-models-in-stan.html#sec:pupilstan"><i class="fa fa-check"></i><b>10.4.1</b> A first linear regression in Stan: Does attentional load affect pupil size?</a></li>
<li class="chapter" data-level="10.4.2" data-path="regression-models-in-stan.html"><a href="regression-models-in-stan.html#sec:interstan"><i class="fa fa-check"></i><b>10.4.2</b> Interactions in Stan: Does attentional load interact with trial number affecting pupil size?</a></li>
<li class="chapter" data-level="10.4.3" data-path="regression-models-in-stan.html"><a href="regression-models-in-stan.html#sec:logisticstan"><i class="fa fa-check"></i><b>10.4.3</b> Logistic regression in Stan: Does set size and trial affect free recall?</a></li>
</ul></li>
<li class="chapter" data-level="10.5" data-path="summary-9.html"><a href="summary-9.html"><i class="fa fa-check"></i><b>10.5</b> Summary</a></li>
<li class="chapter" data-level="10.6" data-path="further-reading-6.html"><a href="further-reading-6.html"><i class="fa fa-check"></i><b>10.6</b> Further reading</a></li>
<li class="chapter" data-level="10.7" data-path="exercises.html"><a href="exercises.html"><i class="fa fa-check"></i><b>10.7</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="ch:complexstan.html"><a href="ch:complexstan.html"><i class="fa fa-check"></i><b>11</b> Complex models and reparametrization</a><ul>
<li class="chapter" data-level="11.1" data-path="sec:hierstan.html"><a href="sec:hierstan.html"><i class="fa fa-check"></i><b>11.1</b> Hierarchical models with Stan</a><ul>
<li class="chapter" data-level="11.1.1" data-path="sec:hierstan.html"><a href="sec:hierstan.html#varying-intercept-model-with-stan"><i class="fa fa-check"></i><b>11.1.1</b> Varying intercept model with Stan</a></li>
<li class="chapter" data-level="11.1.2" data-path="sec:hierstan.html"><a href="sec:hierstan.html#sec:uncorrstan"><i class="fa fa-check"></i><b>11.1.2</b> Uncorrelated varying intercept and slopes model with Stan</a></li>
<li class="chapter" data-level="11.1.3" data-path="sec:hierstan.html"><a href="sec:hierstan.html#sec:corrstan"><i class="fa fa-check"></i><b>11.1.3</b> Correlated varying intercept varying slopes model</a></li>
<li class="chapter" data-level="11.1.4" data-path="sec:hierstan.html"><a href="sec:hierstan.html#sec:crosscorrstan"><i class="fa fa-check"></i><b>11.1.4</b> By-subject and by-items correlated varying intercept varying slopes model</a></li>
</ul></li>
<li class="chapter" data-level="11.2" data-path="summary-10.html"><a href="summary-10.html"><i class="fa fa-check"></i><b>11.2</b> Summary</a></li>
<li class="chapter" data-level="11.3" data-path="further-reading-7.html"><a href="further-reading-7.html"><i class="fa fa-check"></i><b>11.3</b> Further reading</a></li>
<li class="chapter" data-level="11.4" data-path="exercises-1.html"><a href="exercises-1.html"><i class="fa fa-check"></i><b>11.4</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="ch:custom.html"><a href="ch:custom.html"><i class="fa fa-check"></i><b>12</b> Custom distributions in Stan</a><ul>
<li class="chapter" data-level="12.1" data-path="a-change-of-variables-with-reciprocal-normal-distribution.html"><a href="a-change-of-variables-with-reciprocal-normal-distribution.html"><i class="fa fa-check"></i><b>12.1</b> A change of variables with reciprocal normal distribution</a><ul>
<li class="chapter" data-level="12.1.1" data-path="a-change-of-variables-with-reciprocal-normal-distribution.html"><a href="a-change-of-variables-with-reciprocal-normal-distribution.html#simulation-based-calibration"><i class="fa fa-check"></i><b>12.1.1</b> Simulation based calibration</a></li>
</ul></li>
<li class="chapter" data-level="12.2" data-path="further-reading-8.html"><a href="further-reading-8.html"><i class="fa fa-check"></i><b>12.2</b> Further reading</a></li>
</ul></li>
<li class="part"><span><b>IV Other useful models</b></span></li>
<li class="chapter" data-level="13" data-path="ch:remame.html"><a href="ch:remame.html"><i class="fa fa-check"></i><b>13</b> Meta-analysis and measurement error models</a><ul>
<li class="chapter" data-level="13.1" data-path="meta-analysis.html"><a href="meta-analysis.html"><i class="fa fa-check"></i><b>13.1</b> Meta-analysis</a><ul>
<li class="chapter" data-level="13.1.1" data-path="meta-analysis.html"><a href="meta-analysis.html#a-meta-analysis-of-similarity-based-interference-in-sentence-comprehension"><i class="fa fa-check"></i><b>13.1.1</b> A meta-analysis of similarity-based interference in sentence comprehension</a></li>
</ul></li>
<li class="chapter" data-level="13.2" data-path="measurement-error-models.html"><a href="measurement-error-models.html"><i class="fa fa-check"></i><b>13.2</b> Measurement-error models</a><ul>
<li class="chapter" data-level="13.2.1" data-path="measurement-error-models.html"><a href="measurement-error-models.html#accounting-for-measurement-error-in-a-voice-onset-time-model"><i class="fa fa-check"></i><b>13.2.1</b> Accounting for measurement error in a voice onset time model</a></li>
</ul></li>
<li class="chapter" data-level="13.3" data-path="summary-11.html"><a href="summary-11.html"><i class="fa fa-check"></i><b>13.3</b> Summary</a></li>
<li class="chapter" data-level="13.4" data-path="further-reading-9.html"><a href="further-reading-9.html"><i class="fa fa-check"></i><b>13.4</b> Further reading</a></li>
<li class="chapter" data-level="13.5" data-path="sec:REMAMEexercises.html"><a href="sec:REMAMEexercises.html"><i class="fa fa-check"></i><b>13.5</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="14" data-path="ch:sat.html"><a href="ch:sat.html"><i class="fa fa-check"></i><b>14</b> SAT</a></li>
<li class="part"><span><b>V Model comparison and hypothesis testing</b></span></li>
<li class="chapter" data-level="15" data-path="ch:comparison.html"><a href="ch:comparison.html"><i class="fa fa-check"></i><b>15</b> Introduction to model comparison</a><ul>
<li class="chapter" data-level="15.1" data-path="further-reading-10.html"><a href="further-reading-10.html"><i class="fa fa-check"></i><b>15.1</b> Further reading</a></li>
</ul></li>
<li class="chapter" data-level="16" data-path="ch:bf.html"><a href="ch:bf.html"><i class="fa fa-check"></i><b>16</b> Bayes factors</a><ul>
<li class="chapter" data-level="16.1" data-path="hypothesis-testing-using-the-bayes-factor.html"><a href="hypothesis-testing-using-the-bayes-factor.html"><i class="fa fa-check"></i><b>16.1</b> Hypothesis testing using the Bayes factor</a><ul>
<li class="chapter" data-level="16.1.1" data-path="hypothesis-testing-using-the-bayes-factor.html"><a href="hypothesis-testing-using-the-bayes-factor.html#marginal-likelihood"><i class="fa fa-check"></i><b>16.1.1</b> Marginal likelihood</a></li>
<li class="chapter" data-level="16.1.2" data-path="hypothesis-testing-using-the-bayes-factor.html"><a href="hypothesis-testing-using-the-bayes-factor.html#bayes-factor"><i class="fa fa-check"></i><b>16.1.2</b> Bayes factor</a></li>
</ul></li>
<li class="chapter" data-level="16.2" data-path="sec:N400BF.html"><a href="sec:N400BF.html"><i class="fa fa-check"></i><b>16.2</b> Examining the N400 effect with Bayes factor</a><ul>
<li class="chapter" data-level="16.2.1" data-path="sec:N400BF.html"><a href="sec:N400BF.html#sensitivity-analysis-1"><i class="fa fa-check"></i><b>16.2.1</b> Sensitivity analysis</a></li>
<li class="chapter" data-level="16.2.2" data-path="sec:N400BF.html"><a href="sec:N400BF.html#sec:BFnonnested"><i class="fa fa-check"></i><b>16.2.2</b> Non-nested models</a></li>
</ul></li>
<li class="chapter" data-level="16.3" data-path="the-influence-of-the-priors-on-bayes-factors-beyond-the-effect-of-interest.html"><a href="the-influence-of-the-priors-on-bayes-factors-beyond-the-effect-of-interest.html"><i class="fa fa-check"></i><b>16.3</b> The influence of the priors on Bayes factors: beyond the effect of interest</a></li>
<li class="chapter" data-level="16.4" data-path="bayes-factor-in-stan.html"><a href="bayes-factor-in-stan.html"><i class="fa fa-check"></i><b>16.4</b> Bayes factor in Stan</a></li>
<li class="chapter" data-level="16.5" data-path="bayes-factors-in-theory-and-in-practice.html"><a href="bayes-factors-in-theory-and-in-practice.html"><i class="fa fa-check"></i><b>16.5</b> Bayes factors in theory and in practice</a><ul>
<li class="chapter" data-level="16.5.1" data-path="bayes-factors-in-theory-and-in-practice.html"><a href="bayes-factors-in-theory-and-in-practice.html#bayes-factors-in-theory-stability-and-accuracy"><i class="fa fa-check"></i><b>16.5.1</b> Bayes factors in theory: Stability and accuracy</a></li>
<li class="chapter" data-level="16.5.2" data-path="bayes-factors-in-theory-and-in-practice.html"><a href="bayes-factors-in-theory-and-in-practice.html#bayes-factors-in-practice-variability-with-the-data"><i class="fa fa-check"></i><b>16.5.2</b> Bayes factors in practice: Variability with the data</a></li>
</ul></li>
<li class="chapter" data-level="16.6" data-path="summary-12.html"><a href="summary-12.html"><i class="fa fa-check"></i><b>16.6</b> Summary</a></li>
<li class="chapter" data-level="16.7" data-path="further-reading-11.html"><a href="further-reading-11.html"><i class="fa fa-check"></i><b>16.7</b> Further reading</a></li>
<li class="chapter" data-level="16.8" data-path="exercises-2.html"><a href="exercises-2.html"><i class="fa fa-check"></i><b>16.8</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="17" data-path="ch:cv.html"><a href="ch:cv.html"><i class="fa fa-check"></i><b>17</b> Cross-validation</a><ul>
<li class="chapter" data-level="17.1" data-path="expected-log-predictive-density-of-a-model.html"><a href="expected-log-predictive-density-of-a-model.html"><i class="fa fa-check"></i><b>17.1</b> Expected log predictive density of a model</a></li>
<li class="chapter" data-level="17.2" data-path="k-fold-and-leave-one-out-cross-validation.html"><a href="k-fold-and-leave-one-out-cross-validation.html"><i class="fa fa-check"></i><b>17.2</b> K-fold and leave-one-out cross-validation</a></li>
<li class="chapter" data-level="17.3" data-path="testing-the-n400-effect-using-cross-validation.html"><a href="testing-the-n400-effect-using-cross-validation.html"><i class="fa fa-check"></i><b>17.3</b> Testing the N400 effect using cross-validation</a><ul>
<li class="chapter" data-level="17.3.1" data-path="testing-the-n400-effect-using-cross-validation.html"><a href="testing-the-n400-effect-using-cross-validation.html#cross-validation-with-psis-loo"><i class="fa fa-check"></i><b>17.3.1</b> Cross-validation with PSIS-LOO</a></li>
<li class="chapter" data-level="17.3.2" data-path="testing-the-n400-effect-using-cross-validation.html"><a href="testing-the-n400-effect-using-cross-validation.html#cross-validation-with-k-fold"><i class="fa fa-check"></i><b>17.3.2</b> Cross-validation with K-fold</a></li>
<li class="chapter" data-level="17.3.3" data-path="testing-the-n400-effect-using-cross-validation.html"><a href="testing-the-n400-effect-using-cross-validation.html#leave-one-group-out-cross-validation"><i class="fa fa-check"></i><b>17.3.3</b> Leave-one-group-out cross-validation</a></li>
</ul></li>
<li class="chapter" data-level="17.4" data-path="sec:logcv.html"><a href="sec:logcv.html"><i class="fa fa-check"></i><b>17.4</b> Comparing different likelihoods with cross-validation</a></li>
<li class="chapter" data-level="17.5" data-path="issues-with-cross-validation.html"><a href="issues-with-cross-validation.html"><i class="fa fa-check"></i><b>17.5</b> Issues with cross-validation</a></li>
<li class="chapter" data-level="17.6" data-path="cross-validation-in-stan.html"><a href="cross-validation-in-stan.html"><i class="fa fa-check"></i><b>17.6</b> Cross-validation in Stan</a><ul>
<li class="chapter" data-level="17.6.1" data-path="cross-validation-in-stan.html"><a href="cross-validation-in-stan.html#psis-loo-cv-in-stan"><i class="fa fa-check"></i><b>17.6.1</b> PSIS-LOO-CV in Stan</a></li>
</ul></li>
<li class="chapter" data-level="17.7" data-path="summary-13.html"><a href="summary-13.html"><i class="fa fa-check"></i><b>17.7</b> Summary</a></li>
<li class="chapter" data-level="17.8" data-path="further-reading-12.html"><a href="further-reading-12.html"><i class="fa fa-check"></i><b>17.8</b> Further reading</a></li>
<li class="chapter" data-level="17.9" data-path="exercises-3.html"><a href="exercises-3.html"><i class="fa fa-check"></i><b>17.9</b> Exercises</a></li>
</ul></li>
<li class="part"><span><b>VI Computational cognitive modeling with Stan</b></span></li>
<li class="chapter" data-level="18" data-path="ch:cogmod.html"><a href="ch:cogmod.html"><i class="fa fa-check"></i><b>18</b> Introduction to computational cognitive modeling</a><ul>
<li class="chapter" data-level="18.1" data-path="further-reading-13.html"><a href="further-reading-13.html"><i class="fa fa-check"></i><b>18.1</b> Further reading</a></li>
</ul></li>
<li class="chapter" data-level="19" data-path="ch:MPT.html"><a href="ch:MPT.html"><i class="fa fa-check"></i><b>19</b> Multinomial processing trees</a><ul>
<li class="chapter" data-level="19.1" data-path="modeling-multiple-categorical-responses.html"><a href="modeling-multiple-categorical-responses.html"><i class="fa fa-check"></i><b>19.1</b> Modeling multiple categorical responses</a><ul>
<li class="chapter" data-level="19.1.1" data-path="modeling-multiple-categorical-responses.html"><a href="modeling-multiple-categorical-responses.html#sec:mult"><i class="fa fa-check"></i><b>19.1.1</b> A model for multiple responses using the multinomial likelihood</a></li>
<li class="chapter" data-level="19.1.2" data-path="modeling-multiple-categorical-responses.html"><a href="modeling-multiple-categorical-responses.html#sec:cat"><i class="fa fa-check"></i><b>19.1.2</b> A model for multiple responses using the categorical distribution</a></li>
</ul></li>
<li class="chapter" data-level="19.2" data-path="multinomial-processing-tree-mpt-models.html"><a href="multinomial-processing-tree-mpt-models.html"><i class="fa fa-check"></i><b>19.2</b> Multinomial processing tree (MPT) models</a><ul>
<li class="chapter" data-level="19.2.1" data-path="multinomial-processing-tree-mpt-models.html"><a href="multinomial-processing-tree-mpt-models.html#mpts-for-modeling-picture-naming-abilities-in-aphasia"><i class="fa fa-check"></i><b>19.2.1</b> MPTs for modeling picture naming abilities in aphasia</a></li>
</ul></li>
<li class="chapter" data-level="19.3" data-path="further-reading-14.html"><a href="further-reading-14.html"><i class="fa fa-check"></i><b>19.3</b> Further reading</a></li>
<li class="chapter" data-level="19.4" data-path="exercises-4.html"><a href="exercises-4.html"><i class="fa fa-check"></i><b>19.4</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="20" data-path="ch:mixture.html"><a href="ch:mixture.html"><i class="fa fa-check"></i><b>20</b> Mixture models</a><ul>
<li class="chapter" data-level="20.1" data-path="a-mixture-model-of-the-speed-accuracy-trade-off-the-fast-guess-model-account.html"><a href="a-mixture-model-of-the-speed-accuracy-trade-off-the-fast-guess-model-account.html"><i class="fa fa-check"></i><b>20.1</b> A mixture model of the speed-accuracy trade-off: The fast-guess model account</a><ul>
<li class="chapter" data-level="20.1.1" data-path="a-mixture-model-of-the-speed-accuracy-trade-off-the-fast-guess-model-account.html"><a href="a-mixture-model-of-the-speed-accuracy-trade-off-the-fast-guess-model-account.html#the-global-motion-detection-task"><i class="fa fa-check"></i><b>20.1.1</b> The global motion detection task</a></li>
<li class="chapter" data-level="20.1.2" data-path="a-mixture-model-of-the-speed-accuracy-trade-off-the-fast-guess-model-account.html"><a href="a-mixture-model-of-the-speed-accuracy-trade-off-the-fast-guess-model-account.html#a-very-simple-implementation-of-the-fast-guess-model"><i class="fa fa-check"></i><b>20.1.2</b> A very simple implementation of the fast-guess model</a></li>
<li class="chapter" data-level="20.1.3" data-path="a-mixture-model-of-the-speed-accuracy-trade-off-the-fast-guess-model-account.html"><a href="a-mixture-model-of-the-speed-accuracy-trade-off-the-fast-guess-model-account.html#sec:multmix"><i class="fa fa-check"></i><b>20.1.3</b> A multivariate implementation of the fast-guess model</a></li>
<li class="chapter" data-level="20.1.4" data-path="a-mixture-model-of-the-speed-accuracy-trade-off-the-fast-guess-model-account.html"><a href="a-mixture-model-of-the-speed-accuracy-trade-off-the-fast-guess-model-account.html#an-implementation-of-the-fast-guess-model-that-takes-instructions-into-account"><i class="fa fa-check"></i><b>20.1.4</b> An implementation of the fast-guess model that takes instructions into account</a></li>
<li class="chapter" data-level="20.1.5" data-path="a-mixture-model-of-the-speed-accuracy-trade-off-the-fast-guess-model-account.html"><a href="a-mixture-model-of-the-speed-accuracy-trade-off-the-fast-guess-model-account.html#sec:fastguessh"><i class="fa fa-check"></i><b>20.1.5</b> A hierarchical implementation of the fast-guess model</a></li>
</ul></li>
<li class="chapter" data-level="20.2" data-path="summary-14.html"><a href="summary-14.html"><i class="fa fa-check"></i><b>20.2</b> Summary</a></li>
<li class="chapter" data-level="20.3" data-path="further-reading-15.html"><a href="further-reading-15.html"><i class="fa fa-check"></i><b>20.3</b> Further reading</a></li>
<li class="chapter" data-level="20.4" data-path="exercises-5.html"><a href="exercises-5.html"><i class="fa fa-check"></i><b>20.4</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="21" data-path="ch:lognormalrace.html"><a href="ch:lognormalrace.html"><i class="fa fa-check"></i><b>21</b> A simple accumulator model to account for choice response time</a></li>
<li class="appendix"><span><b>Appendix</b></span></li>
<li class="chapter" data-level="A" data-path="ch:distr.html"><a href="ch:distr.html"><i class="fa fa-check"></i><b>A</b> Important distributions</a></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://bookdown.org" target="_blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">An Introduction to Bayesian Data Analysis for Cognitive Science</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="a-mixture-model-of-the-speed-accuracy-trade-off-the-fast-guess-model-account" class="section level2">
<h2><span class="header-section-number">20.1</span> A mixture model of the speed-accuracy trade-off: The fast-guess model account</h2>
<p>When we are faced with multiple choices that require an immediate decision, we can speed up the decision at the expense of accuracy and become more accurate at the expense of speed; this is called the speed-accuracy trade-off <span class="citation">(Wickelgren <a href="#ref-wickelgren1977speed">1977</a>)</span><!-- (Bogacz, Wagenmakers, Forstmann, & Nieuwenhuis, 2010; Schouten & Bekker, 1967; Wickelgren, 1977) -->. The most popular class of models that can incorporate both response times and accuracy, and give an account for the speed-accuracy trade-off is the class of sequential sampling models, which include the drift diffusion model <span class="citation">(Ratcliff <a href="#ref-Ratcliff1978">1978</a>)</span>, the linear ballistic accumulator <span class="citation">(Brown and Heathcote <a href="#ref-brownSimplestCompleteModel2008">2008</a>)</span>, and the log-normal race model <span class="citation">(Heathcote and Love <a href="#ref-HeathcoteLove2012">2012</a>; Rouder et al. <a href="#ref-RouderEtAl2015">2015</a>)</span>, which we discuss in chapter <a href="ch:lognormalrace.html#ch:lognormalrace">21</a>; for a review see <span class="citation">Ratcliff et al. (<a href="#ref-Ratcliff2016">2016</a>)</span>.</p>
<p>However, an alternative model that has been proposed in the past is Ollman’s simple fast-guess model <span class="citation">(Ollman <a href="#ref-Ollman1966">1966</a>; Yellott <a href="#ref-Yellott1967">1967</a>, <a href="#ref-Yellott1971">1971</a>)</span>.<a href="#fn42" class="footnote-ref" id="fnref42"><sup>42</sup></a> Although it has mostly fallen out of favor <span class="citation">(but see Dutilh et al. <a href="#ref-DutilhEtAl2011">2011</a> for a more modern variant of this model)</span>, it presents a very simple framework using finite mixture modeling that can also account for the speed-accuracy trade-off. In the next sections, we’ll use this model to exemplify the use of finite mixtures to represent different cognitive processes.</p>
<div id="the-global-motion-detection-task" class="section level3">
<h3><span class="header-section-number">20.1.1</span> The global motion detection task</h3>
<p>One way to examine the behavior of human and primate subjects when faced with two-alternative forced choices is the detection of the global motion of a random dot kinematogram <span class="citation">(Britten et al. <a href="#ref-britten_shadlen_newsome_movshon_1993">1993</a>)</span>. In this task, a subject sees a number of random dots on the screen from which a proportion of them move in a single direction (e.g., up) and the rest move in random directions. The subject’s goal is to estimate the overall direction of the movement. One of the reasons for the popularity of this task is that it permits the fine-tuning of the difficulty of trials <span class="citation">(Dutilh et al. <a href="#ref-Dutilh2019quality">2019</a>)</span>: The task is harder when the proportion of dots that move coherently (the level of <em>coherence</em>) is lower; see Figure <a href="a-mixture-model-of-the-speed-accuracy-trade-off-the-fast-guess-model-account.html#fig:globalmotionpng">20.1</a>.</p>

<div class="figure" style="text-align: center"><span style="display:block;" id="fig:globalmotionpng"></span>
<img src="cc_figure/globalmotion.PNG" alt="Three levels of difficulty of the global motion detection task. The figures show a consistent upward movement with three levels of coherence (10%, 50%, and 100%). The subjects see the dots moving in the direction indicated by the arrows. The subjects do not see the arrows and all the dots look identical in the actual task. Adapted from Han et al. (2018); licensed under CC BY 4.0." width="100%" />
<p class="caption">
FIGURE 20.1: Three levels of difficulty of the global motion detection task. The figures show a consistent upward movement with three levels of coherence (10%, 50%, and 100%). The subjects see the dots moving in the direction indicated by the arrows. The subjects do not see the arrows and all the dots look identical in the actual task. Adapted from <span class="citation">Han et al. (<a href="#ref-DingEtAl">2018</a>)</span>; licensed under CC BY 4.0.
</p>
</div>
<p>Ollman’s <span class="citation">(<a href="#ref-Ollman1966">1966</a>)</span> fast-guess model assumes that the behavior in this task (and in any other choice task) is governed by two distinct cognitive processes: (i) a guessing mode, and (ii) a task-engaged mode. In the guessing mode, responses are fast and accuracy is at chance level. In the task-engaged mode, responses are slower and accuracy approaches 100%. This means that intermediate values of response times and accuracy can only be achieved by mixing responses from the two modes. Further assumptions of this model are that response times depend on the difficulty of the choice, and that the probability of being on one of the two states depend on the speed incentives during the instructions. (To simplify matters, we ignore the possibility of the accuracy of the choice being also affected by the difficulty of the choice. Also, we ignore the possibility that subjects might be biased to one specific response in the guessing mode, but see exercise <a href="exercises-5.html#exr:mixbias">20.2</a>.)</p>
<div id="data-set" class="section level4">
<h4><span class="header-section-number">20.1.1.1</span> Data set</h4>
<p>We implement the assumptions behind Ollman’s fast-guess model and examine its fit to data of a global motion detection task from <span class="citation">Dutilh et al. (<a href="#ref-Dutilh2019quality">2019</a>)</span>.</p>
<p>The data set from <span class="citation">Dutilh et al. (<a href="#ref-Dutilh2019quality">2019</a>)</span> contains ~2800 trials of each of the 20 subjects participating in a global motion detection task and can be found as <code>df_dots</code> in the <code>bcogsci</code> package. There were two level of coherence yielding hard and easy trials (<code>diff</code>), and the trials where done under instructions that emphasized either accuracy or speed (<code>emphasis</code>). More information about the data set can be found by accessing the documentation for the data set (by typing <code>?df_dots</code> in the R console).</p>
<div class="sourceCode" id="cb1018"><pre class="sourceCode r fold-show"><code class="sourceCode r"><a class="sourceLine" id="cb1018-1" data-line-number="1"><span class="kw">data</span>(<span class="st">&quot;df_dots&quot;</span>) </a>
<a class="sourceLine" id="cb1018-2" data-line-number="2">df_dots</a></code></pre></div>
<pre><code>## # A tibble: 56,097 x 12
##    subj diff  emphasis    rt   acc fix_dur stim  resp  trial block
##   &lt;int&gt; &lt;chr&gt; &lt;chr&gt;    &lt;dbl&gt; &lt;int&gt;   &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt; &lt;int&gt; &lt;int&gt;
## 1     1 easy  speed      482     1   0.738 R     R         1     6
## 2     1 hard  speed      602     1   0.784 R     R         2     6
## 3     1 hard  speed      381     1   0.651 R     R         3     6
##   block_trial bias 
##         &lt;int&gt; &lt;chr&gt;
## 1           1 no   
## 2           2 no   
## 3           3 no   
## # … with 56,094 more rows</code></pre>
<p>We might think that if the fast-guess model were true, we would see a bimodal distribution, when we plot a histogram of the data. Unfortunately, when two similar distributions are mixed, we won’t see any apparent bimodality; see Figure <a href="a-mixture-model-of-the-speed-accuracy-trade-off-the-fast-guess-model-account.html#fig:dfdots">20.2</a></p>

<div class="sourceCode" id="cb1020"><pre class="sourceCode r fold-hide"><code class="sourceCode r"><a class="sourceLine" id="cb1020-1" data-line-number="1"></a>
<a class="sourceLine" id="cb1020-2" data-line-number="2"><span class="kw">ggplot</span>(df_dots, <span class="kw">aes</span>(rt)) <span class="op">+</span></a>
<a class="sourceLine" id="cb1020-3" data-line-number="3"><span class="st">  </span><span class="kw">geom_histogram</span>()</a></code></pre></div>
<div class="figure"><span style="display:block;" id="fig:dfdots"></span>
<img src="bookdown_files/figure-html/dfdots-1.svg" alt="Distribution of response times in the data of the global motion detection task in Dutilh et al. (2019)." width="672" />
<p class="caption">
FIGURE 20.2: Distribution of response times in the data of the global motion detection task in <span class="citation">Dutilh et al. (<a href="#ref-Dutilh2019quality">2019</a>)</span>.
</p>
</div>
<p>However, Figure <a href="a-mixture-model-of-the-speed-accuracy-trade-off-the-fast-guess-model-account.html#fig:dfaccrt">20.3</a> reveals that incorrect responses are generally faster, and this is especially true when the instructions emphasized accuracy.</p>

<div class="sourceCode" id="cb1021"><pre class="sourceCode r fold-hide"><code class="sourceCode r"><a class="sourceLine" id="cb1021-1" data-line-number="1"></a>
<a class="sourceLine" id="cb1021-2" data-line-number="2"><span class="kw">ggplot</span>(df_dots, <span class="kw">aes</span>(<span class="dt">x =</span> <span class="kw">factor</span>(acc), <span class="dt">y =</span> rt)) <span class="op">+</span></a>
<a class="sourceLine" id="cb1021-3" data-line-number="3"><span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">position =</span> <span class="kw">position_jitter</span>(<span class="dt">width =</span> <span class="fl">.4</span>, <span class="dt">height =</span> <span class="dv">0</span>),</a>
<a class="sourceLine" id="cb1021-4" data-line-number="4">             <span class="dt">alpha =</span> <span class="fl">.5</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb1021-5" data-line-number="5"><span class="st">  </span><span class="kw">facet_wrap</span>(diff <span class="op">~</span><span class="st"> </span>emphasis) <span class="op">+</span></a>
<a class="sourceLine" id="cb1021-6" data-line-number="6"><span class="st">  </span><span class="kw">xlab</span>(<span class="st">&quot;Accuracy&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb1021-7" data-line-number="7"><span class="st">  </span><span class="kw">ylab</span>(<span class="st">&quot;Response time&quot;</span>)</a></code></pre></div>
<div class="figure"><span style="display:block;" id="fig:dfaccrt"></span>
<img src="bookdown_files/figure-html/dfaccrt-1.svg" alt="Distribution of response times by accuracy in the data of the global motion detection task in Dutilh et al. (2019)." width="672" />
<p class="caption">
FIGURE 20.3: Distribution of response times by accuracy in the data of the global motion detection task in <span class="citation">Dutilh et al. (<a href="#ref-Dutilh2019quality">2019</a>)</span>.
</p>
</div>
<!-- using a plotting style -->
<!-- that has become important in RT research, -->
<!-- called a “latency-probability” plot (LP plot: -->
<!-- Audley & Pike, 1965). Latency probability -->
<!-- plots show mean RT as a function of the -->
<!-- probability of a response. Points on the left -->
<!-- of the graph represent the lower probability -->
<!-- (error) responses and complementary points -->
<!-- on the right of the graph represent the higher -->
<!-- probability (correct) responses from the same -->
<!-- experimental conditions. Sometimes, LP -->
<!-- plots are expanded to show more than just -->
<!-- the mean RT, by plotting several quantiles -->
<!-- of the RT distributions–these are called -->
<!-- “quantile-probability,” or QP, plots. chapter -->
</div>
</div>
<div id="a-very-simple-implementation-of-the-fast-guess-model" class="section level3">
<h3><span class="header-section-number">20.1.2</span> A very simple implementation of the fast-guess model</h3>
<p>The description of the model makes it clear that an ideal subject who never guesses has a response time that depends only on the difficulty of the trial. As we did in previous chapters, we assume that response times are log-normally distributed, and for simplicity we start by modeling the behavior of a single subject:</p>
<p><span class="math display">\[\begin{equation}
rt_n \sim \mathit{LogNormal}(\alpha + \beta \cdot x_n, \sigma)
\end{equation}\]</span></p>
<p>In the previous equation, <span class="math inline">\(x\)</span> is larger for difficult trials. If we center <span class="math inline">\(x\)</span>, <span class="math inline">\(\alpha\)</span> represents the average logarithmic transformed response times for a subject engaged in the task, and <span class="math inline">\(\beta\)</span> is the effect of trial difficulty on log-response time. We assume a non-deterministic process, with a noise parameter <span class="math inline">\(\sigma\)</span>. See also Box <a href="sec:trial.html#thm:lognormal">4.3</a> for more information about log-normally distributed response times.</p>
<p>Alternatively, a subject that guesses in every trial would show a response time distribution that is independent of the difficulty of the trial:</p>
<p><span class="math display">\[\begin{equation}
rt_n \sim \mathit{LogNormal}(\gamma, \sigma_2)
\end{equation}\]</span></p>
<p>Here <span class="math inline">\(\gamma\)</span> represents the the average logarithmic transformed response time when a subject only guesses. We assume that responses from the guessing mode might have a different noise component than from the task-engaged mode.</p>
<p>The fast-guess model makes the assumption that during a task, a single subject would behave in these two ways: They would be engaged in the task a proportion of the trials and would guess on the rest of the trials. This means that for a single subject, there is an underlying probability of being engaged in the task, <span class="math inline">\(p_{task}\)</span>, that determines whether they are actually choosing (<span class="math inline">\(z=1\)</span>) or guessing (<span class="math inline">\(z=0\)</span>):</p>
<p><span class="math display">\[\begin{equation}
z_n \sim \mathit{Bernoulli}(p_{task})
\end{equation}\]</span></p>
<p>The value of the parameter <span class="math inline">\(z\)</span> in every trial determines the behavior of the subject. This means that the distribution that we observe is a mixture of the two distributions presented before:</p>
<p><span class="math display" id="eq:dismix">\[\begin{equation}
rt_n \sim 
\begin{cases}
\mathit{LogNormal}(\alpha + \beta \cdot x_n, \sigma), &amp; \text{ if } z_n =1 \\
\mathit{LogNormal}(\gamma, \sigma_2), &amp; \text{ if } z_n=0
\end{cases}
\tag{20.2}
\end{equation}\]</span></p>
<p>In order to have a Bayesian implementation, we also need to define some priors. We use priors that encode what we know about reaction time experiments; see also section <a href="sec:trial.html#sec:trial">4.2</a>.</p>
<p><span class="math display">\[\begin{equation}
\begin{aligned}
\alpha &amp;\sim \mathit{Normal}(6, 1)\\
\beta &amp;\sim \mathit{Normal}(0, .1)\\
\sigma &amp;\sim \mathit{Normal}_+(.5, .2)
\end{aligned}
\end{equation}\]</span></p>
<p><span class="math display">\[\begin{equation}
\begin{aligned}
\gamma &amp;\sim \mathit{Normal}(6, 1)\\
\sigma_2 &amp;\sim \mathit{Normal}_+(.5, .2)
\end{aligned}
\end{equation}\]</span></p>
<p>For now, we allow all values for the probability of having an engaged response having equal likelihood; we achieve this by setting the following prior to <span class="math inline">\(p_{task}\)</span>:</p>
<p><span class="math display">\[\begin{equation}
p_{task} \sim \mathit{Beta}(1, 1)
\end{equation}\]</span></p>
<p>This represents a flat, uniformative prior over the probability parameter <span class="math inline">\(p_{task}\)</span>.</p>
<p>Before we fit our model to the real data, we generate synthetic data to make sure that our model is working as expected.</p>
<p>We first define the number of observations, predictors, and fixed point values for each of the parameters. We assume <span class="math inline">\(1000\)</span> observations and two levels of difficulty <span class="math inline">\(-0.5\)</span> and <span class="math inline">\(0.5\)</span>. The point values chosen for the parameters are relatively realistic (based on our previous experience on reaction time experiments). Although in the priors we try to encode the range of possible values for the parameters, in this simulation we assume only one instance of this possible range:</p>
<div class="sourceCode" id="cb1022"><pre class="sourceCode r fold-show"><code class="sourceCode r"><a class="sourceLine" id="cb1022-1" data-line-number="1">N &lt;-<span class="st"> </span><span class="dv">1000</span></a>
<a class="sourceLine" id="cb1022-2" data-line-number="2">x &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="kw">rep</span>(<span class="op">-</span>.<span class="dv">5</span>, N<span class="op">/</span><span class="dv">2</span>), <span class="kw">rep</span>(.<span class="dv">5</span>, N<span class="op">/</span><span class="dv">2</span>))</a>
<a class="sourceLine" id="cb1022-3" data-line-number="3"><span class="co"># Parameters true values</span></a>
<a class="sourceLine" id="cb1022-4" data-line-number="4">alpha &lt;-<span class="st"> </span><span class="fl">5.8</span></a>
<a class="sourceLine" id="cb1022-5" data-line-number="5">beta &lt;-<span class="st"> </span><span class="fl">0.05</span></a>
<a class="sourceLine" id="cb1022-6" data-line-number="6">sigma &lt;-<span class="st"> </span><span class="fl">.4</span></a>
<a class="sourceLine" id="cb1022-7" data-line-number="7">sigma2 &lt;-<span class="st"> </span><span class="fl">.5</span></a>
<a class="sourceLine" id="cb1022-8" data-line-number="8">gamma &lt;-<span class="st"> </span><span class="fl">5.2</span></a>
<a class="sourceLine" id="cb1022-9" data-line-number="9">p_task &lt;-<span class="st"> </span><span class="fl">.8</span></a>
<a class="sourceLine" id="cb1022-10" data-line-number="10"><span class="co"># Median time</span></a>
<a class="sourceLine" id="cb1022-11" data-line-number="11"><span class="kw">c</span>(<span class="st">&quot;engaged&quot;</span> =<span class="st"> </span><span class="kw">exp</span>(alpha), <span class="st">&quot;guessing&quot;</span> =<span class="st"> </span><span class="kw">exp</span>(gamma))</a></code></pre></div>
<pre><code>##  engaged guessing 
##      330      181</code></pre>
<p>For generate a mixture of response times, we use the indicator of a latent class, <code>z</code>.</p>
<div class="sourceCode" id="cb1024"><pre class="sourceCode r fold-show"><code class="sourceCode r"><a class="sourceLine" id="cb1024-1" data-line-number="1">z &lt;-<span class="st"> </span><span class="kw">rbern</span>(<span class="dt">n =</span> N, <span class="dt">prob =</span> p_task)</a>
<a class="sourceLine" id="cb1024-2" data-line-number="2">rt &lt;-<span class="st"> </span><span class="kw">if_else</span>(z <span class="op">==</span><span class="st"> </span><span class="dv">1</span>,</a>
<a class="sourceLine" id="cb1024-3" data-line-number="3">             <span class="kw">rlnorm</span>(N,</a>
<a class="sourceLine" id="cb1024-4" data-line-number="4">                    <span class="dt">meanlog =</span> alpha <span class="op">+</span><span class="st"> </span>beta <span class="op">*</span><span class="st"> </span>x,</a>
<a class="sourceLine" id="cb1024-5" data-line-number="5">                    <span class="dt">sdlog =</span> sigma),</a>
<a class="sourceLine" id="cb1024-6" data-line-number="6">             <span class="kw">rlnorm</span>(N, <span class="dt">meanlog =</span> gamma,</a>
<a class="sourceLine" id="cb1024-7" data-line-number="7">                    <span class="dt">sdlog =</span> sigma2))</a>
<a class="sourceLine" id="cb1024-8" data-line-number="8">df_dots_simdata1 &lt;-<span class="st"> </span><span class="kw">tibble</span>(<span class="dt">trial =</span> <span class="dv">1</span><span class="op">:</span>N, <span class="dt">x =</span> x, <span class="dt">rt =</span> rt)</a></code></pre></div>
<p>We verify that our simulated data is realistic, that is, it’s on the same range as the original data; see Figure <a href="a-mixture-model-of-the-speed-accuracy-trade-off-the-fast-guess-model-account.html#fig:simmix">20.4</a>.</p>

<div class="sourceCode" id="cb1025"><pre class="sourceCode r fold-show"><code class="sourceCode r"><a class="sourceLine" id="cb1025-1" data-line-number="1"><span class="kw">ggplot</span>(df_dots_simdata1, <span class="kw">aes</span>(rt)) <span class="op">+</span></a>
<a class="sourceLine" id="cb1025-2" data-line-number="2"><span class="st">  </span><span class="kw">geom_histogram</span>()</a></code></pre></div>
<div class="figure"><span style="display:block;" id="fig:simmix"></span>
<img src="bookdown_files/figure-html/simmix-1.svg" alt="Response times in the simulated data (df_dots_simdata1) that follows the fast-guess model." width="672" />
<p class="caption">
FIGURE 20.4: Response times in the simulated data (<code>df_dots_simdata1</code>) that follows the fast-guess model.
</p>
</div>
<p>To implement the mixture model defined in Equation <a href="sec:ppd.html#eq:logpriorsunif">(3.9)</a> in Stan, the discrete parameter <span class="math inline">\(z\)</span> needs to be marginalized:</p>
<p><span class="math display">\[\begin{equation}
\begin{aligned}
p(rt_n | \Theta) &amp;= p_{task} \cdot LogNormal(rt_n | \alpha + \beta \cdot x_n, \sigma) +\\ 
    &amp; (1 - p_{task}) \cdot LogNormal(rt_n | \gamma, \sigma_2)
\end{aligned}
\end{equation}\]</span></p>
<p>In addition, Stan requires the likelihood to be defined in log-space:</p>
<p><span class="math display">\[\begin{equation}
\begin{aligned}
\log(p(rt | \Theta)) &amp;= \log(p_{task} \cdot LogNormal(rt_n | \alpha + \beta \cdot x_n, \sigma) +\\ 
    &amp; (1 - p_{task}) \cdot LogNormal(rt_n | \gamma, \sigma_2)) 
\end{aligned}
\end{equation}\]</span></p>
<p>To implement this likelihood in Stan, we need to take into account that the density of the log-normal distribution (as well as any other distribution) is already logarithmically transformed. That is, we have <span class="math inline">\(\log(LogNormal(.))\)</span> rather than <span class="math inline">\(LogNormal()\)</span>. We use <code>log_sum_exp(x, y)</code> and <code>log1m(x)</code> since they are more computationally stable than <code>log(exp(x) + exp(y))</code> and <code>log(1-x)</code> respectively (i.e., they are less prone to numerical over/underflows). The likelihood looks like this:</p>
<pre><code>target += log_sum_exp(log(p_task) +
lognormal_lpdf(rt[n] | alpha + x[n] * beta, sigma),
log1m(p_task) + lognormal_lpdf(rt[n] | gamma, sigma2));</code></pre>
<p>The complete model is shown below:</p>
<pre class="stan fold-show"><code>data {
  int&lt;lower = 1&gt; N;
  vector[N] x;
  vector[N] rt;
}
parameters {
  real alpha;
  real beta;
  real&lt;lower = 0&gt; sigma;
  real gamma; //guessing
  real&lt;lower = 0&gt; sigma2;
  real&lt;lower = 0, upper = 1&gt; p_task;
}
model {
  // priors for the task component
  target += normal_lpdf(alpha | 6, 1);
  target += normal_lpdf(beta | 0, .1);
  target += normal_lpdf(sigma | .5, .2)
    - normal_lccdf(0 | .5, .2);
  // priors for the guessing component
  target += normal_lpdf(gamma | 6, 1);
  target += normal_lpdf(sigma2 | .5, .2)
    - normal_lccdf(0 | .5, .2);
  target += beta_lpdf(p_task | 1, 1);
  for(n in 1:N)
    target += log_sum_exp(log(p_task) +
                          lognormal_lpdf(rt[n] | alpha + x[n] * beta, sigma),
                          log1m(p_task) +
                          lognormal_lpdf(rt[n] | gamma, sigma2));
}</code></pre>
<p>Call the Stan model <code>mixture_rt.stan</code>, and fit it to the simulated data. First, we set up the simulated data as a list structure:</p>
<div class="sourceCode" id="cb1028"><pre class="sourceCode r fold-show"><code class="sourceCode r"><a class="sourceLine" id="cb1028-1" data-line-number="1">ls_dots_simdata &lt;-<span class="st"> </span><span class="kw">list</span>(<span class="dt">N =</span> N,</a>
<a class="sourceLine" id="cb1028-2" data-line-number="2">                        <span class="dt">rt =</span> rt,</a>
<a class="sourceLine" id="cb1028-3" data-line-number="3">                        <span class="dt">x =</span> x) </a></code></pre></div>
<p>Then fit the model:</p>
<div class="sourceCode" id="cb1029"><pre class="sourceCode r fold-show"><code class="sourceCode r"><a class="sourceLine" id="cb1029-1" data-line-number="1">mixture_rt &lt;-<span class="st"> </span><span class="kw">system.file</span>(<span class="st">&quot;stan_models&quot;</span>,</a>
<a class="sourceLine" id="cb1029-2" data-line-number="2">                        <span class="st">&quot;mixture_rt.stan&quot;</span>,</a>
<a class="sourceLine" id="cb1029-3" data-line-number="3">                        <span class="dt">package =</span> <span class="st">&quot;bcogsci&quot;</span>)</a>
<a class="sourceLine" id="cb1029-4" data-line-number="4">fit_mix_rt &lt;-<span class="st"> </span><span class="kw">stan</span>(<span class="dt">file =</span> mixture_rt,</a>
<a class="sourceLine" id="cb1029-5" data-line-number="5">               <span class="dt">data =</span> ls_dots_simdata)   </a></code></pre></div>
<pre><code>## Warning: The largest R-hat is 1.75, indicating chains have not mixed.
## Running the chains for more iterations may help. See
## http://mc-stan.org/misc/warnings.html#r-hat</code></pre>
<pre><code>## Warning: Bulk Effective Samples Size (ESS) is too low, indicating posterior means and medians may be unreliable.
## Running the chains for more iterations may help. See
## http://mc-stan.org/misc/warnings.html#bulk-ess</code></pre>
<pre><code>## Warning: Tail Effective Samples Size (ESS) is too low, indicating posterior variances and tail quantiles may be unreliable.
## Running the chains for more iterations may help. See
## http://mc-stan.org/misc/warnings.html#tail-ess</code></pre>
<p>There a lot of warnings, the Rhats are too large, and number of effective samples is too low:</p>
<div class="sourceCode" id="cb1033"><pre class="sourceCode r fold-show"><code class="sourceCode r"><a class="sourceLine" id="cb1033-1" data-line-number="1"><span class="kw">print</span>(fit_mix_rt) </a></code></pre></div>
<pre><code>##            mean     2.5%    97.5% n_eff Rhat
## alpha      5.55     4.88     5.91     3 2.09
## beta       0.01    -0.19     0.15     4 1.52
## sigma      0.45     0.33     0.62     3 1.61
## gamma      5.60     5.08     5.88     3 1.94
## sigma2     0.47     0.35     0.61     3 1.79
## p_task     0.45     0.06     0.90     3 1.62
## lp__   -6381.75 -6386.43 -6378.48     9 1.16</code></pre>
<p>A traceplot shows clearly that the chains aren’t mixing; see Figure <a href="a-mixture-model-of-the-speed-accuracy-trade-off-the-fast-guess-model-account.html#fig:traceplotsmix1">20.5</a>.</p>

<div class="sourceCode" id="cb1035"><pre class="sourceCode r fold-show"><code class="sourceCode r"><a class="sourceLine" id="cb1035-1" data-line-number="1"><span class="kw">traceplot</span>(fit_mix_rt) </a></code></pre></div>
<div class="figure"><span style="display:block;" id="fig:traceplotsmix1"></span>
<img src="bookdown_files/figure-html/traceplotsmix1-1.svg" alt="Traceplots from the model mixture_rt.stan fit to simulated data." width="672" />
<p class="caption">
FIGURE 20.5: Traceplots from the model <code>mixture_rt.stan</code> fit to simulated data.
</p>
</div>
<p>The problem with this model is that the mixture components (i.e., the fast-guesses and the engaged mode) are underlyingly exchangeable and thus not identifiable. Each chain doesn’t know how each component was identified by the rest of the chains. However, we do have information that can identify the components: According to the theoretical model, we know that the average response in the engaged mode, represented by <span class="math inline">\(\alpha\)</span>, should be slower than the average response in the guessing mode, <span class="math inline">\(\gamma\)</span>.</p>
<p>Even though the theoretical model assumes that guesses are faster than engaged responses, this is not explicit in our computational model. That is, our model lacks some of the theoretical information that we have, namely that the distribution of engaged response times should be slower than the distribution of guesses times. This can be encoded with a strong prior for <span class="math inline">\(\gamma\)</span>, where we assume that its prior distribution is truncated on an upper bound by the value of <span class="math inline">\(\alpha\)</span>:</p>
<p><span class="math display">\[\begin{equation}
\gamma \sim \mathit{Normal}(6, 1), \text{for } \gamma &lt; \alpha
\end{equation}\]</span></p>
<p>Another softer constraint that we could add to our implementation is the assumption that subjects are generally more likely to be trying to do the task than just guessing. The following prior has the probability density concentrated nearer to 1.</p>
<p><span class="math display">\[\begin{equation}
p_{task} \sim \mathit{Beta}(8, 2)
\end{equation}\]</span></p>
<p>Plotting this prior confirms where most of the probability mass lies; see Figure <a href="a-mixture-model-of-the-speed-accuracy-trade-off-the-fast-guess-model-account.html#fig:dbeta">20.6</a>.</p>

<div class="sourceCode" id="cb1036"><pre class="sourceCode r fold-hide"><code class="sourceCode r"><a class="sourceLine" id="cb1036-1" data-line-number="1"></a>
<a class="sourceLine" id="cb1036-2" data-line-number="2"><span class="kw">plot</span>(<span class="cf">function</span>(x) <span class="kw">dbeta</span>(x, <span class="dv">8</span>, <span class="dv">2</span>))</a></code></pre></div>
<div class="figure"><span style="display:block;" id="fig:dbeta"></span>
<img src="bookdown_files/figure-html/dbeta-1.svg" alt="Density plot for the prior of \(p_{task}\), \(Beta(8,2)\)" width="672" />
<p class="caption">
FIGURE 20.6: Density plot for the prior of <span class="math inline">\(p_{task}\)</span>, <span class="math inline">\(Beta(8,2)\)</span>
</p>
</div>
<p>The Stan code for this model is shown below:</p>
<pre class="stan fold-show"><code>data {
  int&lt;lower = 1&gt; N;
  vector[N] x;
  vector[N] rt;
}
parameters {
  real alpha;
  real beta;
  real&lt;lower = 0&gt; sigma;
  real&lt;upper = alpha&gt; gamma; //guessing
  real&lt;lower = 0&gt; sigma2;
  real&lt;lower = 0, upper = 1&gt; p_task;
}
model {
  // priors for the task component
  target += normal_lpdf(alpha | 6, 1);
  target += normal_lpdf(beta | 0, .3);
  target += normal_lpdf(sigma | .5, .2)
    - normal_lccdf(0 | .5, .2);
  // priors for the guessing component
  target += normal_lpdf(gamma | 6, 1) -
    normal_lcdf(alpha | 6, 1);
  target += normal_lpdf(sigma2 | .5, .2)
    - normal_lccdf(0 | .5, .2);
  target += beta_lpdf(p_task | 8, 2);
  for(n in 1:N)
    target += log_sum_exp(log(p_task) +
                          lognormal_lpdf(rt[n] | alpha + x[n] * beta, sigma),
                          log1m(p_task) +
                          lognormal_lpdf(rt[n] | gamma, sigma2)) ;
}</code></pre>
<p>Once we change the higher boundary of <code>gamma</code> in the <code>parameters</code> block, we also need to truncate the distribution in the <code>model</code> block by correcting the PDF with its CDF. This correction is carried out using the CDF because we are truncating the distribution at the right-hand side; recall that earlier we used the complement of the CDF when we truncate a distribution at the left-hand side); also see Box <a href="sec:pupil.html#thm:truncation">4.1</a>.</p>
<pre><code>  target += normal_lpdf(gamma | 6, 1) -
    normal_lcdf(alpha | 6, 1);</code></pre>
<p>Fit this model (call it <code>mixture_rt2.stan</code>) to the same simulated data set that we used before:</p>
<div class="sourceCode" id="cb1039"><pre class="sourceCode r fold-show"><code class="sourceCode r"><a class="sourceLine" id="cb1039-1" data-line-number="1">mixture_rt2 &lt;-<span class="st"> </span><span class="kw">system.file</span>(<span class="st">&quot;stan_models&quot;</span>,</a>
<a class="sourceLine" id="cb1039-2" data-line-number="2">                        <span class="st">&quot;mixture_rt2.stan&quot;</span>,</a>
<a class="sourceLine" id="cb1039-3" data-line-number="3">                        <span class="dt">package =</span> <span class="st">&quot;bcogsci&quot;</span>)</a>
<a class="sourceLine" id="cb1039-4" data-line-number="4">fit_mix_rt2 &lt;-<span class="st"> </span><span class="kw">stan</span>(<span class="dt">file =</span> mixture_rt2, </a>
<a class="sourceLine" id="cb1039-5" data-line-number="5">               <span class="dt">data =</span> ls_dots_simdata)  </a></code></pre></div>
<p>Now the summaries and traceplots look fine; see Figure <a href="a-mixture-model-of-the-speed-accuracy-trade-off-the-fast-guess-model-account.html#fig:traceplotsmix2">20.7</a>.</p>

<div class="sourceCode" id="cb1040"><pre class="sourceCode r fold-show"><code class="sourceCode r"><a class="sourceLine" id="cb1040-1" data-line-number="1"><span class="kw">print</span>(fit_mix_rt2) </a></code></pre></div>
<pre><code>##            mean     2.5%    97.5% n_eff Rhat
## alpha      5.78     5.72     5.85   994 1.01
## beta       0.02    -0.04     0.08  2452 1.00
## sigma      0.38     0.34     0.42  1037 1.01
## gamma      5.07     4.61     5.48   729 1.01
## sigma2     0.45     0.25     0.61   790 1.00
## p_task     0.81     0.57     0.95   789 1.01
## lp__   -6331.84 -6335.92 -6329.39  1405 1.00</code></pre>
<div class="sourceCode" id="cb1042"><pre class="sourceCode r fold-show"><code class="sourceCode r"><a class="sourceLine" id="cb1042-1" data-line-number="1"><span class="kw">traceplot</span>(fit_mix_rt2) </a></code></pre></div>
<div class="figure"><span style="display:block;" id="fig:traceplotsmix2"></span>
<img src="bookdown_files/figure-html/traceplotsmix2-1.svg" alt="Traceplots from the model mixture_rt2.stan fit to simulated data." width="672" />
<p class="caption">
FIGURE 20.7: Traceplots from the model <code>mixture_rt2.stan</code> fit to simulated data.
</p>
</div>
</div>
<div id="sec:multmix" class="section level3">
<h3><span class="header-section-number">20.1.3</span> A multivariate implementation of the fast-guess model</h3>
<p>A problem with the previous implementation of the fast-guess model is that we ignore the accuracy information in the data. We can implement a closer version of the verbal description of the model:
In particular, we also want to model the fact that accuracy is at chance level in the fast-guessing mode and that accuracy approaches 100% during the task-engaged mode.</p>
<p>This means that the mixture affects two pairs of distributions:</p>
<p><span class="math display">\[\begin{equation}
z_n \sim \mathit{Bernoulli}(p_{task})
\end{equation}\]</span></p>
<p>A response time distribution</p>
<p><span class="math display" id="eq:dismix2">\[\begin{equation}
rt_n \sim 
\begin{cases}
\mathit{LogNormal}(\alpha + \beta \cdot x_n, \sigma), &amp; \text{ if } z_n =1 \\
\mathit{LogNormal}(\gamma, \sigma_2), &amp; \text{ if } z_n=0
\end{cases}
\tag{20.3}
\end{equation}\]</span></p>
<p>and an accuracy distribution</p>
<p><span class="math display" id="eq:dismix3">\[\begin{equation}
acc_n \sim 
\begin{cases}
\mathit{Bernoulli}(p_{correct}), &amp; \text{ if } z_n =1 \\
\mathit{Bernoulli}(.5), &amp; \text{ if } z_n=0
\end{cases}
\tag{20.4}
\end{equation}\]</span></p>
<p>We have a new parameter <span class="math inline">\(p_{correct}\)</span>, which represent the probability of making a correct answer in the engaged mode. The verbal description says that it is closer to 100%, and here we have the freedom to choose whatever prior we believe represents for us values that are close to 100% accuracy. We translate this belief into a prior as follows; our prior choice is relatively informative but does not impose a hard constraint; if a subject consistently shows relatively low (or high) accuracy, <span class="math inline">\(p_{correct}\)</span> will change accordingly:</p>
<p><span class="math display">\[\begin{equation}
p_{correct} \sim \mathit{Beta}(995, 5)
\end{equation}\]</span></p>
<p>In our simulated data, we assume that the global motion detection task is done by a very accurate subject, with an accuracy of 99.9%.</p>
<div class="sourceCode" id="cb1043"><pre class="sourceCode r fold-show"><code class="sourceCode r"><a class="sourceLine" id="cb1043-1" data-line-number="1">p_correct &lt;-<span class="st"> </span><span class="fl">.999</span></a>
<a class="sourceLine" id="cb1043-2" data-line-number="2">acc &lt;-<span class="st"> </span><span class="kw">ifelse</span>(z, <span class="kw">rbern</span>(<span class="dt">n =</span> N, p_correct),</a>
<a class="sourceLine" id="cb1043-3" data-line-number="3">                  <span class="kw">rbern</span>(<span class="dt">n =</span> N, <span class="fl">.5</span>))</a>
<a class="sourceLine" id="cb1043-4" data-line-number="4">df_dots_simdata3 &lt;-<span class="st"> </span><span class="kw">tibble</span>(<span class="dt">trial =</span> <span class="dv">1</span><span class="op">:</span>N,</a>
<a class="sourceLine" id="cb1043-5" data-line-number="5">                           <span class="dt">x =</span> x,</a>
<a class="sourceLine" id="cb1043-6" data-line-number="6">                           <span class="dt">rt =</span> rt,</a>
<a class="sourceLine" id="cb1043-7" data-line-number="7">                           <span class="dt">acc =</span> acc) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb1043-8" data-line-number="8"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">diff =</span> <span class="kw">if_else</span>(x <span class="op">==</span><span class="st"> </span><span class="fl">.5</span>, <span class="st">&quot;hard&quot;</span>, <span class="st">&quot;easy&quot;</span>))</a></code></pre></div>
<p>Plot the simulated data in Figure <a href="a-mixture-model-of-the-speed-accuracy-trade-off-the-fast-guess-model-account.html#fig:simdata3">20.8</a>, and this time we can see the effect of task difficulty on the simulated response times and accuracy:</p>

<div class="sourceCode" id="cb1044"><pre class="sourceCode r fold-show"><code class="sourceCode r"><a class="sourceLine" id="cb1044-1" data-line-number="1"><span class="kw">ggplot</span>(df_dots_simdata3, <span class="kw">aes</span>(<span class="dt">x =</span> <span class="kw">factor</span>(acc), <span class="dt">y =</span> rt)) <span class="op">+</span></a>
<a class="sourceLine" id="cb1044-2" data-line-number="2"><span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">position =</span> <span class="kw">position_jitter</span>(<span class="dt">width =</span> <span class="fl">.4</span>, <span class="dt">height =</span> <span class="dv">0</span>),</a>
<a class="sourceLine" id="cb1044-3" data-line-number="3">             <span class="dt">alpha =</span> <span class="fl">.5</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb1044-4" data-line-number="4"><span class="st">  </span><span class="kw">facet_wrap</span>(diff <span class="op">~</span><span class="st"> </span>.) <span class="op">+</span></a>
<a class="sourceLine" id="cb1044-5" data-line-number="5"><span class="st">  </span><span class="kw">xlab</span>(<span class="st">&quot;Accuracy&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb1044-6" data-line-number="6"><span class="st">  </span><span class="kw">ylab</span>(<span class="st">&quot;Response time&quot;</span>)</a></code></pre></div>
<div class="figure"><span style="display:block;" id="fig:simdata3"></span>
<img src="bookdown_files/figure-html/simdata3-1.svg" alt="Response times by accuracy accounting for task difficulty in the simulated data (df_dots_simdata3) that follows the fast-guess model." width="672" />
<p class="caption">
FIGURE 20.8: Response times by accuracy accounting for task difficulty in the simulated data (<code>df_dots_simdata3</code>) that follows the fast-guess model.
</p>
</div>
<p>Next, we need to marginalize out the discrete parameters from both pairs of distributions.</p>
<p><span class="math display">\[\begin{equation}
\begin{aligned}
p(rt, acc | \Theta) = &amp; p_{task} \cdot \\
&amp; LogNormal(rt_n | \alpha + \beta \cdot x_n, \sigma) \cdot \\
&amp; Bernoulli(acc_n | p_{correct}) \\
&amp; +\\ 
&amp; (1 - p_{task}) \cdot \\
&amp; LogNormal(rt_n | \gamma, \sigma_2) \cdot\\
&amp; Bernoulli(acc_n | .5)
\end{aligned}
\end{equation}\]</span></p>
<p>In log-space:</p>
<p><span class="math display">\[\begin{equation}
\begin{aligned}
\log(p(rt, acc | \Theta)) =  \log(\exp(&amp;\\
&amp; \log(p_{task}) +\\
  &amp;\log(LogNormal(rt_n | \alpha + \beta * x_n, \sigma)) + \\
  &amp;\log(Bernoulli(acc_n | p_{correct})))\\
  +&amp;\\ 
 \exp(&amp;\\
 &amp; \log(1 - p_{task}) + \\
 &amp; \log(LogNormal(rt_n |\gamma, \sigma_2)) + \\
 &amp; \log(Bernoulli(acc_n | .5)))\\
    )&amp; \\
\end{aligned}
\end{equation}\]</span></p>
<p>Our model translates into the following Stan code:</p>
<pre class="stan fold-show"><code>data {
  int&lt;lower = 1&gt; N;
  vector[N] x;
  vector[N] rt;
  int acc[N];
}
parameters {
  real alpha;
  real beta;
  real&lt;lower = 0&gt; sigma;
  real&lt;upper = alpha&gt; gamma; //guessing
  real&lt;lower = 0&gt; sigma2;
  real&lt;lower = 0, upper = 1&gt; p_correct;
  real&lt;lower = 0, upper = 1&gt; p_task;
}
model {
  // priors for the task component
  target += normal_lpdf(alpha | 6, 1);
  target += normal_lpdf(beta | 0, .3);
  target += normal_lpdf(sigma | .5, .2)
    - normal_lccdf(0 | .5, .2);
  // priors for the guessing component
  target += normal_lpdf(gamma | 6, 1) -
    normal_lcdf(alpha | 6, 1);
  target += normal_lpdf(sigma2 | .5, .2)
    - normal_lccdf(0 | .5, .2);
  target += beta_lpdf(p_correct | 995, 5);
  target += beta_lpdf(p_task | 8, 2);
  for(n in 1:N)
    target += log_sum_exp(log(p_task) +
                          lognormal_lpdf(rt[n] | alpha + x[n] * beta, sigma) +
                          bernoulli_lpmf(acc[n] | p_correct),
                          log1m(p_task) +
                          lognormal_lpdf(rt[n] | gamma, sigma2) +
                          bernoulli_lpmf(acc[n] | .5));
}</code></pre>
<p>Next, we set up the data in list format:</p>
<div class="sourceCode" id="cb1046"><pre class="sourceCode r fold-show"><code class="sourceCode r"><a class="sourceLine" id="cb1046-1" data-line-number="1">ls_dots_simdata &lt;-<span class="st"> </span><span class="kw">list</span>(<span class="dt">N =</span> N,</a>
<a class="sourceLine" id="cb1046-2" data-line-number="2">                        <span class="dt">rt =</span> rt,</a>
<a class="sourceLine" id="cb1046-3" data-line-number="3">                        <span class="dt">x =</span> x,</a>
<a class="sourceLine" id="cb1046-4" data-line-number="4">                        <span class="dt">acc =</span> acc)</a></code></pre></div>
<p>Then we fit the model (call it <code>mixture_rtacc.stan</code>):</p>
<div class="sourceCode" id="cb1047"><pre class="sourceCode r fold-show"><code class="sourceCode r"><a class="sourceLine" id="cb1047-1" data-line-number="1">mixture_rtacc &lt;-<span class="st"> </span><span class="kw">system.file</span>(<span class="st">&quot;stan_models&quot;</span>,</a>
<a class="sourceLine" id="cb1047-2" data-line-number="2">                        <span class="st">&quot;mixture_rtacc.stan&quot;</span>,</a>
<a class="sourceLine" id="cb1047-3" data-line-number="3">                        <span class="dt">package =</span> <span class="st">&quot;bcogsci&quot;</span>)</a>
<a class="sourceLine" id="cb1047-4" data-line-number="4">fit_mix_rtacc &lt;-<span class="st"> </span><span class="kw">stan</span>(<span class="dt">file =</span> mixture_rtacc,</a>
<a class="sourceLine" id="cb1047-5" data-line-number="5">               <span class="dt">data =</span> ls_dots_simdata)  </a></code></pre></div>
<p>We see that our model can be fit to both response times and accuracy, and its parameters estimates have sensible values (given the fixed parameters we used to generate our simulated data).</p>
<div class="sourceCode" id="cb1048"><pre class="sourceCode r fold-show"><code class="sourceCode r"><a class="sourceLine" id="cb1048-1" data-line-number="1"><span class="kw">print</span>(fit_mix_rtacc) </a></code></pre></div>
<pre><code>##               mean     2.5%    97.5% n_eff Rhat
## alpha         5.79     5.76     5.82  4238    1
## beta          0.02    -0.04     0.08  5445    1
## sigma         0.38     0.36     0.41  5539    1
## gamma         5.17     5.07     5.27  3742    1
## sigma2        0.50     0.43     0.57  3999    1
## p_correct     0.99     0.99     1.00  4608    1
## p_task        0.80     0.76     0.84  5089    1
## lp__      -6607.59 -6612.33 -6604.88  1864    1</code></pre>
<p>We will evaluate the recovery of the parameters more carefully when we deal with the hierarchical version of the fast-guess model in section <a href="a-mixture-model-of-the-speed-accuracy-trade-off-the-fast-guess-model-account.html#sec:fastguessh">20.1.5</a>. Before we extend this model hierarchically, let us also take into account the instructions given to the subjects.</p>
</div>
<div id="an-implementation-of-the-fast-guess-model-that-takes-instructions-into-account" class="section level3">
<h3><span class="header-section-number">20.1.4</span> An implementation of the fast-guess model that takes instructions into account</h3>
<p>The actual global motion detection experiment that we started with has another manipulation that can help us to evaluate better the fast-guess model. In some trials, the instructions emphasized accuracy (e.g., “Be as accurate as possible.”) and in others speed (e.g., “Be as fast as possible.”). The fast-guess model also assumes that the probability of being in one of the two states depends on the speed incentives given during the instructions. This entails that now <span class="math inline">\(p_{task}\)</span> depends on the instructions <span class="math inline">\(x_2\)</span>, where we encode a speed incentive with <span class="math inline">\(-0.5\)</span> and an accuracy incentive with <span class="math inline">\(0.5\)</span>. Essentially, we need to fit the following regression:</p>
<p><span class="math display">\[\begin{equation}
\alpha_{task} + x_2 \cdot \beta_{task}
\end{equation}\]</span></p>
<p>As we did with MPT models in the previous chapter (in section <a href="multinomial-processing-tree-mpt-models.html#sec:MPT-reg">19.2.1.4</a>), we need to bound the previous regression between 0 and 1; we achieve this using the logistic or inverse logit function:</p>
<p><span class="math display">\[\begin{equation}
p_{task} = logit^{-1}(\alpha_{task} + x_2 \cdot \beta_{task})
\end{equation}\]</span></p>
<p>This means that we need to interpret <span class="math inline">\(\alpha_{task} + x_2 \cdot \beta_{task}\)</span> in log-odds, which is bounded by <span class="math inline">\((-\infty, \infty)\)</span> rather than as a probability; see also section <a href="multinomial-processing-tree-mpt-models.html#sec:MPT-reg">19.2.1.4</a> in the previous chapter.</p>
<p>The likelihood (defined before in section <a href="a-mixture-model-of-the-speed-accuracy-trade-off-the-fast-guess-model-account.html#sec:multmix">20.1.3</a>) remains the same:</p>
<p><span class="math display">\[\begin{equation}
z_n \sim \mathit{Bernoulli}(p_{task})
\end{equation}\]</span></p>
<p>A response time distribution is defined:</p>
<p><span class="math display">\[\begin{equation}
rt_n \sim 
\begin{cases}
\mathit{LogNormal}(\alpha + \beta \cdot x_n, \sigma), &amp; \text{ if } z_n =1 \\
\mathit{LogNormal}(\gamma, \sigma_2), &amp; \text{ if } z_n=0
\end{cases}
\end{equation}\]</span></p>
<p>and an accuracy distribution is defined as well:</p>
<p><span class="math display">\[\begin{equation}
acc_n \sim 
\begin{cases}
\mathit{Bernoulli}(p_{correct}), &amp; \text{ if } z_n =1 \\
\mathit{Bernoulli}(.5), &amp; \text{ if } z_n=0
\end{cases}
\end{equation}\]</span></p>
<p>The only further change in our model is that rather than a prior on <span class="math inline">\(p_{task}\)</span>, we now need priors for <span class="math inline">\(\alpha_{task}\)</span> and <span class="math inline">\(\beta_{task}\)</span>, which are on the log-odds scale.</p>
<p>For <span class="math inline">\(\beta_{task}\)</span>, we assume an effect that can rather large and we won’t assume a direction a priori (for now):</p>
<p><span class="math display">\[\begin{equation}
\beta_{task} \sim \mathit{Normal}(0, 1)
\end{equation}\]</span></p>
<p>This means that the subject could be affected by the instructions in the expected way with an increased probability to be task-engaged (leading to better accuracy) when the instructions emphasize accuracy (<span class="math inline">\(\beta_{task} &gt;0\)</span>), or the subject might be behaving in an unexpected way with a decreased probability to be task-engaged (leading to worse accuracy) when the instructions emphasize accuracy (<span class="math inline">\(\beta_{task} &lt;0\)</span>). The latter situation, <span class="math inline">\(\beta_{task} &lt;0\)</span>, could represent the instructions being misunderstood. It’s certainly possible to include priors that encode the expected direction of the effect instead: <span class="math inline">\(\mathit{Normal}_{+}(0,1)\)</span>. Unless there is a compelling reason to constrain the prior in this way, in general we will, following Cromwell’s rule, leave open the possibility of the <span class="math inline">\(\beta\)</span> parameter having negative values.</p>
<p>How can we choose a prior for <span class="math inline">\(\alpha_{task}\)</span> that encodes the same information that we had in the previous model in <span class="math inline">\(p_{task}\)</span>? One possibility is to create an auxiliary parameter <span class="math inline">\(p_{btask}\)</span>, that represents the baseline probability of being engaged in the task, with the same prior that we use in the previous section, and then transform it to an unconstrained space for our regression with the logit function:</p>
<p><span class="math display">\[\begin{equation}
\begin{aligned}
&amp;p_{btask} \sim \mathit{\mathit{Beta}}(8, 2)\\
&amp;\alpha_{task} = logit(p_{btask})
\end{aligned}
\end{equation}\]</span></p>
<p>To verify that our priors make sense, we plot the difference in prior predicted probability of being engaged in the task under the two emphasis conditions in Figure <a href="a-mixture-model-of-the-speed-accuracy-trade-off-the-fast-guess-model-account.html#fig:emphasis">20.9</a>.</p>
<div class="sourceCode" id="cb1050"><pre class="sourceCode r fold-show"><code class="sourceCode r"><a class="sourceLine" id="cb1050-1" data-line-number="1">Ns &lt;-<span class="st"> </span><span class="dv">1000</span> <span class="co"># number of samples for the plot</span></a>
<a class="sourceLine" id="cb1050-2" data-line-number="2"><span class="co"># Priors</span></a>
<a class="sourceLine" id="cb1050-3" data-line-number="3">p_btask &lt;-<span class="st"> </span><span class="kw">rbeta</span>(<span class="dt">n =</span> Ns, <span class="dt">shape1 =</span> <span class="dv">8</span>, <span class="dt">shape2 =</span> <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb1050-4" data-line-number="4">beta_task &lt;-<span class="st"> </span><span class="kw">rnorm</span>(<span class="dt">n =</span> Ns, <span class="dt">mean =</span> <span class="dv">0</span>, <span class="dt">sd =</span> <span class="dv">1</span>)</a>
<a class="sourceLine" id="cb1050-5" data-line-number="5"><span class="co"># Predicted probability of being engaged</span></a>
<a class="sourceLine" id="cb1050-6" data-line-number="6">p_task_easy &lt;-<span class="st"> </span><span class="kw">plogis</span>(<span class="kw">qlogis</span>(p_btask) <span class="op">+</span><span class="st"> </span><span class="fl">.5</span> <span class="op">*</span><span class="st"> </span>beta_task)</a>
<a class="sourceLine" id="cb1050-7" data-line-number="7">p_task_hard &lt;-<span class="st"> </span><span class="kw">plogis</span>(<span class="kw">qlogis</span>(p_btask) <span class="op">+</span><span class="st"> </span><span class="fl">-.5</span> <span class="op">*</span><span class="st"> </span>beta_task)</a>
<a class="sourceLine" id="cb1050-8" data-line-number="8"><span class="co"># Predicted difference</span></a>
<a class="sourceLine" id="cb1050-9" data-line-number="9">diff_p_pred &lt;-<span class="st"> </span><span class="kw">tibble</span>(<span class="dt">diff =</span> p_task_easy <span class="op">-</span><span class="st"> </span>p_task_hard)</a></code></pre></div>

<div class="sourceCode" id="cb1051"><pre class="sourceCode r fold-show"><code class="sourceCode r"><a class="sourceLine" id="cb1051-1" data-line-number="1">diff_p_pred <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb1051-2" data-line-number="2"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(diff)) <span class="op">+</span></a>
<a class="sourceLine" id="cb1051-3" data-line-number="3"><span class="st">  </span><span class="kw">geom_histogram</span>()</a></code></pre></div>
<div class="figure"><span style="display:block;" id="fig:emphasis"></span>
<img src="bookdown_files/figure-html/emphasis-1.svg" alt="Difference in prior predicted probability of being engaged in the task under the two emphasis conditions for the simulated data (diff_p_pred) that follows the fast-guess model." width="672" />
<p class="caption">
FIGURE 20.9: Difference in prior predicted probability of being engaged in the task under the two emphasis conditions for the simulated data (<code>diff_p_pred</code>) that follows the fast-guess model.
</p>
</div>
<p>Figure <a href="a-mixture-model-of-the-speed-accuracy-trade-off-the-fast-guess-model-account.html#fig:emphasis">20.9</a> shows that we are predicting a priori that the difference in <span class="math inline">\(p_{task}\)</span> will be mostly smaller than <span class="math inline">\(\pm 0.3\)</span>, which seems to make sense intuitively. If we had more information about the likely range of variation, we could of course have adapted the prior to reflect that belief.</p>
<p>We are ready to generate a new data set, by deciding on some fixed values for <span class="math inline">\(\beta_{task}\)</span> and <span class="math inline">\(p_{btask}\)</span>.</p>
<div class="sourceCode" id="cb1052"><pre class="sourceCode r fold-show"><code class="sourceCode r"><a class="sourceLine" id="cb1052-1" data-line-number="1"><span class="co"># New predictor</span></a>
<a class="sourceLine" id="cb1052-2" data-line-number="2">x2 &lt;-<span class="st"> </span><span class="kw">rep</span>(<span class="kw">c</span>(<span class="op">-</span>.<span class="dv">5</span>, <span class="fl">.5</span>), N<span class="op">/</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb1052-3" data-line-number="3"><span class="co"># Verify that the predictors are crossed:</span></a>
<a class="sourceLine" id="cb1052-4" data-line-number="4">predictors &lt;-<span class="st"> </span><span class="kw">tibble</span>(x, x2)</a>
<a class="sourceLine" id="cb1052-5" data-line-number="5"><span class="kw">xtabs</span>(<span class="op">~</span><span class="st"> </span>x <span class="op">+</span><span class="st"> </span>x2, predictors)</a></code></pre></div>
<pre><code>##       x2
## x      -0.5 0.5
##   -0.5  250 250
##   0.5   250 250</code></pre>
<div class="sourceCode" id="cb1054"><pre class="sourceCode r fold-show"><code class="sourceCode r"><a class="sourceLine" id="cb1054-1" data-line-number="1"><span class="co"># New true values</span></a>
<a class="sourceLine" id="cb1054-2" data-line-number="2">beta_task &lt;-<span class="st"> </span><span class="fl">0.5</span></a>
<a class="sourceLine" id="cb1054-3" data-line-number="3">p_btask &lt;-<span class="st"> </span><span class="fl">.85</span></a>
<a class="sourceLine" id="cb1054-4" data-line-number="4"><span class="co"># Generate data:</span></a>
<a class="sourceLine" id="cb1054-5" data-line-number="5">alpha_task &lt;-<span class="st"> </span><span class="kw">qlogis</span>(p_btask)</a>
<a class="sourceLine" id="cb1054-6" data-line-number="6">p_task &lt;-<span class="st"> </span><span class="kw">plogis</span>(alpha_task <span class="op">+</span><span class="st"> </span>x2 <span class="op">*</span><span class="st"> </span>beta_task)</a>
<a class="sourceLine" id="cb1054-7" data-line-number="7">z &lt;-<span class="st"> </span><span class="kw">rbern</span>(<span class="dt">n =</span> N, <span class="dt">prob =</span> p_task)</a>
<a class="sourceLine" id="cb1054-8" data-line-number="8">rt &lt;-<span class="st"> </span><span class="kw">ifelse</span>(z,</a>
<a class="sourceLine" id="cb1054-9" data-line-number="9">             <span class="kw">rlnorm</span>(<span class="dt">n =</span> N, <span class="dt">meanlog =</span> alpha <span class="op">+</span><span class="st"> </span>beta <span class="op">*</span><span class="st"> </span>x, <span class="dt">sdlog =</span> sigma),</a>
<a class="sourceLine" id="cb1054-10" data-line-number="10">             <span class="kw">rlnorm</span>(<span class="dt">n =</span> N, <span class="dt">meanlog =</span> gamma, <span class="dt">sdlog =</span> sigma2))</a>
<a class="sourceLine" id="cb1054-11" data-line-number="11">acc &lt;-<span class="st"> </span><span class="kw">ifelse</span>(z, <span class="kw">rbern</span>(<span class="dt">n =</span> N, p_correct),</a>
<a class="sourceLine" id="cb1054-12" data-line-number="12">                  <span class="kw">rbern</span>(<span class="dt">n =</span> N, <span class="fl">.5</span>))</a>
<a class="sourceLine" id="cb1054-13" data-line-number="13"></a>
<a class="sourceLine" id="cb1054-14" data-line-number="14">df_dots_simdata4 &lt;-<span class="st"> </span><span class="kw">tibble</span>(<span class="dt">trial =</span> <span class="dv">1</span><span class="op">:</span>N,</a>
<a class="sourceLine" id="cb1054-15" data-line-number="15">                           <span class="dt">x =</span> x,</a>
<a class="sourceLine" id="cb1054-16" data-line-number="16">                           <span class="dt">rt =</span> rt,</a>
<a class="sourceLine" id="cb1054-17" data-line-number="17">                           <span class="dt">acc =</span> acc,</a>
<a class="sourceLine" id="cb1054-18" data-line-number="18">                           <span class="dt">x2 =</span> x2) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb1054-19" data-line-number="19"><span class="st">  </span></a>
<a class="sourceLine" id="cb1054-20" data-line-number="20"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">diff =</span> <span class="kw">if_else</span>(x <span class="op">==</span><span class="st"> </span><span class="fl">.5</span>, <span class="st">&quot;hard&quot;</span>, <span class="st">&quot;easy&quot;</span>),</a>
<a class="sourceLine" id="cb1054-21" data-line-number="21">         <span class="dt">emphasis =</span> <span class="kw">ifelse</span>(x2 <span class="op">==</span><span class="st"> </span><span class="fl">.5</span>, <span class="st">&quot;accuracy&quot;</span>, <span class="st">&quot;speed&quot;</span>))</a></code></pre></div>
<p>We can generate a plot now where both the difficulty of the task and the instructions are manipulated; see Figure <a href="a-mixture-model-of-the-speed-accuracy-trade-off-the-fast-guess-model-account.html#fig:taskinstr">20.10</a>.</p>

<div class="sourceCode" id="cb1055"><pre class="sourceCode r fold-show"><code class="sourceCode r"><a class="sourceLine" id="cb1055-1" data-line-number="1"><span class="kw">ggplot</span>(df_dots_simdata4, <span class="kw">aes</span>(<span class="dt">x =</span> <span class="kw">factor</span>(acc), <span class="dt">y =</span> rt)) <span class="op">+</span></a>
<a class="sourceLine" id="cb1055-2" data-line-number="2"><span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">position =</span> <span class="kw">position_jitter</span>(<span class="dt">width =</span> <span class="fl">.4</span>, <span class="dt">height =</span> <span class="dv">0</span>),</a>
<a class="sourceLine" id="cb1055-3" data-line-number="3">             <span class="dt">alpha =</span> <span class="fl">.5</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb1055-4" data-line-number="4"><span class="st">  </span><span class="kw">facet_wrap</span>(diff <span class="op">~</span><span class="st"> </span>emphasis) <span class="op">+</span></a>
<a class="sourceLine" id="cb1055-5" data-line-number="5"><span class="st">  </span><span class="kw">xlab</span>(<span class="st">&quot;Accuracy&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb1055-6" data-line-number="6"><span class="st">  </span><span class="kw">ylab</span>(<span class="st">&quot;Response time&quot;</span>)</a></code></pre></div>
<div class="figure"><span style="display:block;" id="fig:taskinstr"></span>
<img src="bookdown_files/figure-html/taskinstr-1.svg" alt="Response times and accuracy by the difficulty of the task and the instructions type for the simulated data (df_dots_simdata4) that follows the fast-guess model." width="672" />
<p class="caption">
FIGURE 20.10: Response times and accuracy by the difficulty of the task and the instructions type for the simulated data (<code>df_dots_simdata4</code>) that follows the fast-guess model.
</p>
</div>
<p>For the Stan implementation, <code>log_inv_logit(x)</code> is applying the logistic (or inverse logit) function to <code>x</code> to transform it into a probability and then applying the logarithm; <code>log1m_inv_logit(x)</code> is applying the logistic function to <code>x</code>, and then applying the logarithm to its complement <span class="math inline">\((1 - p)\)</span>. We do this because rather than <code>p_task</code> in probability space, we have <code>lodds_task</code> in log-odds space:</p>
<pre><code>real lodds_task = logit(p_btask) + x2[n] * beta_task;</code></pre>
<p>The parameter <code>lodds_task</code> estimates the mixing probabilities in log-odds:</p>
<pre><code>target += log_sum_exp(log_inv_logit(lodds_task) + ..., 
          log1m_inv_logit(lodds_task) + ...)</code></pre>
<p>We also add a <code>generated quantities</code> block that can be used for further (prior or posterior) predictive checks. In this block we do use <code>z</code> as an indicator of the latent class (task-engaged mode or fast-guessing mode), since we do not estimate <code>z</code>, but rather generate it based on the parameter’s posteriors.</p>
<p>We use the dummy variable <code>onlyprior</code> to indicate whether we use the data or we only sample from the priors. One can always do the predictive checks in R, transforming the code that we wrote for the simulation into a function, and writing the priors in R. However, it can be simpler to take advantage of Stan output format and rewrite the code in Stan. One downside of this is that the <code>stanfit</code> object that stores the model output can become too large for the memory of the computer.</p>
<pre class="stan fold-show"><code>data {
  int&lt;lower = 1&gt; N;
  vector[N] x;
  vector[N] rt;
  int acc[N];
  vector[N] x2; //speed or accuracy emphasis
  int&lt;lower = 0, upper = 1&gt; onlyprior;
}
parameters {
  real alpha;
  real beta;
  real&lt;lower = 0&gt; sigma;
  real&lt;upper = alpha&gt; gamma; //guessing
  real&lt;lower = 0&gt; sigma2;
  real&lt;lower = 0, upper = 1&gt; p_correct;
  real&lt;lower = 0, upper = 1&gt; p_btask;
  real beta_task;
}
model {
  // priors for the task component
  target += normal_lpdf(alpha | 6, 1);
  target += normal_lpdf(beta | 0, .1);
  target += normal_lpdf(sigma | .5, .2)
    - normal_lccdf(0 | .5, .2);
  // priors for the guessing component
  target += normal_lpdf(gamma | 6, 1)-
  normal_lcdf(alpha | 6, 1);
  target += normal_lpdf(sigma2 | .5, .2)
    - normal_lccdf(0 | .5, .2);
  target += normal_lpdf(beta_task | 0, 1);
  target += beta_lpdf(p_correct | 995, 5);
  target += beta_lpdf(p_btask | 8, 2);
  if(onlyprior != 1)
    for(n in 1:N){
      real lodds_task = logit(p_btask) + x2[n] * beta_task;
      target += log_sum_exp(log_inv_logit(lodds_task)+
                            lognormal_lpdf(rt[n] | alpha + x[n] * beta, sigma) +
                            bernoulli_lpmf(acc[n] | p_correct),
                            log1m_inv_logit(lodds_task) +
                            lognormal_lpdf(rt[n] | gamma, sigma2) +
                            bernoulli_lpmf(acc[n] | .5));
    }
}
generated quantities {
  real rt_pred[N];
  real acc_pred[N];
  int z[N]; 
  for(n in 1:N){
    real lodds_task = logit(p_btask) + x2[n] * beta_task;
    z[n] = bernoulli_rng(inv_logit(lodds_task));
    if(z[n]==1){
      rt_pred[n] = lognormal_rng(alpha + x[n] * beta, sigma);
      acc_pred[n] = bernoulli_rng(p_correct);
    } else{
      rt_pred[n] = lognormal_rng(gamma, sigma2);
      acc_pred[n] = bernoulli_rng(.5);
    }
  }
}
</code></pre>
<p>We save the code as <code>mixture_rtacc2.stan</code>, and before fitting it to the simulated data, we perform prior predictive checks.</p>
<div id="prior-predictive-checks-1" class="section level4">
<h4><span class="header-section-number">20.1.4.1</span> Prior predictive checks</h4>
<p>Generate prior predictive distributions, by setting <code>onlyprior</code> to <code>1</code>.</p>
<div class="sourceCode" id="cb1059"><pre class="sourceCode r fold-show"><code class="sourceCode r"><a class="sourceLine" id="cb1059-1" data-line-number="1">ls_dots_simdata &lt;-<span class="st"> </span><span class="kw">list</span>(<span class="dt">N =</span> N,</a>
<a class="sourceLine" id="cb1059-2" data-line-number="2">                        <span class="dt">rt =</span> rt,</a>
<a class="sourceLine" id="cb1059-3" data-line-number="3">                        <span class="dt">x =</span> x,</a>
<a class="sourceLine" id="cb1059-4" data-line-number="4">                        <span class="dt">x2 =</span> x2,</a>
<a class="sourceLine" id="cb1059-5" data-line-number="5">                        <span class="dt">acc =</span> acc,</a>
<a class="sourceLine" id="cb1059-6" data-line-number="6">                        <span class="dt">onlyprior =</span> <span class="dv">1</span>) </a>
<a class="sourceLine" id="cb1059-7" data-line-number="7">mixture_rtacc2 &lt;-<span class="st"> </span><span class="kw">system.file</span>(<span class="st">&quot;stan_models&quot;</span>, </a>
<a class="sourceLine" id="cb1059-8" data-line-number="8">                        <span class="st">&quot;mixture_rtacc2.stan&quot;</span>, </a>
<a class="sourceLine" id="cb1059-9" data-line-number="9">                        <span class="dt">package =</span> <span class="st">&quot;bcogsci&quot;</span>)</a>
<a class="sourceLine" id="cb1059-10" data-line-number="10">fit_mix_rtacc2_priors &lt;-<span class="st"> </span><span class="kw">stan</span>(<span class="dt">file =</span> mixture_rtacc2,</a>
<a class="sourceLine" id="cb1059-11" data-line-number="11">                         <span class="dt">data =</span> ls_dots_simdata,</a>
<a class="sourceLine" id="cb1059-12" data-line-number="12">                         <span class="dt">chains =</span> <span class="dv">1</span>, <span class="dt">iter =</span> <span class="dv">2000</span>)   </a></code></pre></div>
<p>We plot prior predictive distributions of response times as follows. We are plotting them against our simulated data in Figure <a href="a-mixture-model-of-the-speed-accuracy-trade-off-the-fast-guess-model-account.html#fig:ppcmix4">20.11</a>, by setting <code>y = rt</code> in <code>ppc_dens_overlay</code>; this distribution can be thought as a hand-picked instance of the prior predictive distribution.</p>

<div class="sourceCode" id="cb1060"><pre class="sourceCode r fold-show"><code class="sourceCode r"><a class="sourceLine" id="cb1060-1" data-line-number="1">rt_pred &lt;-<span class="st"> </span><span class="kw">extract</span>(fit_mix_rtacc2_priors)<span class="op">$</span>rt_pred</a>
<a class="sourceLine" id="cb1060-2" data-line-number="2"><span class="kw">ppc_dens_overlay</span>(<span class="dt">y =</span> rt, <span class="dt">yrep =</span> rt_pred[<span class="dv">1</span><span class="op">:</span><span class="dv">100</span>,]) <span class="op">+</span></a>
<a class="sourceLine" id="cb1060-3" data-line-number="3"><span class="st">  </span><span class="kw">coord_cartesian</span>(<span class="dt">xlim =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">10000</span>)) </a></code></pre></div>
<div class="figure"><span style="display:block;" id="fig:ppcmix4"></span>
<img src="bookdown_files/figure-html/ppcmix4-1.svg" alt="Prior predictive distributions of response times against the simulated data (using mixture_rtacc2.stan) that follows the fast-guess model." width="672" />
<p class="caption">
FIGURE 20.11: Prior predictive distributions of response times against the simulated data (using <code>mixture_rtacc2.stan</code>) that follows the fast-guess model.
</p>
</div>
<p>Some of the predictive data sets contain responses that are too large, and some of the have too much probability mass close to zero, but there is nothing clearly wrong in the prior predictive distributions (considering that the model hasn’t “seen” the data).</p>
<p>If we want to plot the prior predicted distribution of differences in response time conditioning on task difficulty, we need to define a new function. Then we use the <code>bayesplot</code> function <code>ppc_stat()</code> that takes as an argument of <code>stat</code> any summary function; see Figure <a href="a-mixture-model-of-the-speed-accuracy-trade-off-the-fast-guess-model-account.html#fig:ppdiff">20.12</a>.</p>

<div class="sourceCode" id="cb1061"><pre class="sourceCode r fold-show"><code class="sourceCode r"><a class="sourceLine" id="cb1061-1" data-line-number="1">meanrt_diff &lt;-<span class="st"> </span><span class="cf">function</span>(rt){</a>
<a class="sourceLine" id="cb1061-2" data-line-number="2">  <span class="kw">mean</span>(rt[x <span class="op">==</span><span class="st"> </span><span class="fl">.5</span>]) <span class="op">-</span></a>
<a class="sourceLine" id="cb1061-3" data-line-number="3"><span class="st">    </span><span class="kw">mean</span>(rt[x <span class="op">==</span><span class="st"> </span><span class="fl">-.5</span>])</a>
<a class="sourceLine" id="cb1061-4" data-line-number="4">} </a>
<a class="sourceLine" id="cb1061-5" data-line-number="5"><span class="kw">ppc_stat</span>(rt,</a>
<a class="sourceLine" id="cb1061-6" data-line-number="6">         <span class="dt">yrep =</span> rt_pred,</a>
<a class="sourceLine" id="cb1061-7" data-line-number="7">         <span class="dt">stat =</span> meanrt_diff) </a></code></pre></div>
<div class="figure"><span style="display:block;" id="fig:ppdiff"></span>
<img src="bookdown_files/figure-html/ppdiff-1.svg" alt="Prior predicted distribution (using mixture_rtacc2.stan) of differences in response time conditioning on task difficulty." width="672" />
<p class="caption">
FIGURE 20.12: Prior predicted distribution (using <code>mixture_rtacc2.stan</code>) of differences in response time conditioning on task difficulty.
</p>
</div>
<!-- We can inspect the prior predictive distribution of accuracy by grouping accuracy by emphasis: -->
<p>We find that the range of response times look reasonable. There are, however, always more checks that can be done, for example, plotting other summary statistics, or predictions conditioned on other aspects of the data.</p>
</div>
<div id="fit-to-simulated-data" class="section level4">
<h4><span class="header-section-number">20.1.4.2</span> Fit to simulated data</h4>
<p>Fit it to data, by setting <code>onlyprior = 0</code>:</p>
<div class="sourceCode" id="cb1062"><pre class="sourceCode r fold-show"><code class="sourceCode r"><a class="sourceLine" id="cb1062-1" data-line-number="1">ls_dots_simdata &lt;-<span class="st"> </span><span class="kw">list</span>(<span class="dt">N =</span> N,</a>
<a class="sourceLine" id="cb1062-2" data-line-number="2">                        <span class="dt">rt =</span> rt,</a>
<a class="sourceLine" id="cb1062-3" data-line-number="3">                        <span class="dt">x =</span> x,</a>
<a class="sourceLine" id="cb1062-4" data-line-number="4">                        <span class="dt">x2 =</span> x2,</a>
<a class="sourceLine" id="cb1062-5" data-line-number="5">                        <span class="dt">acc =</span> acc,</a>
<a class="sourceLine" id="cb1062-6" data-line-number="6">                        <span class="dt">onlyprior =</span> <span class="dv">0</span>) </a></code></pre></div>
<div class="sourceCode" id="cb1063"><pre class="sourceCode r fold-show"><code class="sourceCode r"><a class="sourceLine" id="cb1063-1" data-line-number="1">fit_mix_rtacc2 &lt;-<span class="st"> </span><span class="kw">stan</span>(<span class="dt">file =</span> mixture_rtacc2,</a>
<a class="sourceLine" id="cb1063-2" data-line-number="2">                  <span class="dt">data =</span> ls_dots_simdata)</a></code></pre></div>
<div class="sourceCode" id="cb1064"><pre class="sourceCode r fold-show"><code class="sourceCode r"><a class="sourceLine" id="cb1064-1" data-line-number="1"><span class="kw">print</span>(fit_mix_rtacc2,</a>
<a class="sourceLine" id="cb1064-2" data-line-number="2">      <span class="dt">pars =</span> <span class="kw">c</span>(<span class="st">&quot;alpha&quot;</span>, <span class="st">&quot;beta&quot;</span>, <span class="st">&quot;sigma&quot;</span>, <span class="st">&quot;gamma&quot;</span>, <span class="st">&quot;sigma2&quot;</span>,</a>
<a class="sourceLine" id="cb1064-3" data-line-number="3">               <span class="st">&quot;p_correct&quot;</span>, <span class="st">&quot;p_btask&quot;</span>, <span class="st">&quot;beta_task&quot;</span>)) </a></code></pre></div>
<pre><code>##           mean 2.5% 97.5% n_eff Rhat
## alpha     5.80 5.77  5.83  5889    1
## beta      0.06 0.00  0.12  7200    1
## sigma     0.39 0.37  0.41  5873    1
## gamma     5.21 5.09  5.32  4366    1
## sigma2    0.53 0.46  0.61  4721    1
## p_correct 0.99 0.99  1.00  4756    1
## p_btask   0.85 0.82  0.88  4521    1
## beta_task 1.12 0.64  1.63  5780    1</code></pre>
<p>We see that we fit the model without problems. Before we evaluate the recovery of the parameters more carefully, we implement a hierarchical version of the fast-guess model.</p>
</div>
</div>
<div id="sec:fastguessh" class="section level3">
<h3><span class="header-section-number">20.1.5</span> A hierarchical implementation of the fast-guess model</h3>
<p>So far we have evaluated the behavior of one simulated subject.
We discussed before (in the context of distributional regression models, in section <a href="sec:N400hierarchical.html#sec:distrmodel">5.1.6</a>, and in the MPT modeling chapter, <a href="ch:MPT.html#ch:MPT">19</a>) that every parameter in a model can, in principle, be made hierarchical. This doesn’t guarantee, however, that we’ll learn anything from the data for those parameters or that our model will converge! The best advice here is to start simple with simulated data. Despite the fact that convergence with simulated data does not guarantee the convergence of the same model with real data, the reverse is in general true.</p>
<p>For our hierarchical version, we assume that both response times and the effect of task difficulty vary by subject, and that different subjects have different guessing times. This entails the following change to the response time distribution:</p>
<p><span class="math display">\[\begin{equation}
rt_n \sim 
\begin{cases}
\mathit{LogNormal}(\alpha + u_{subj[n],1} +  x_n \cdot  (\beta +  u_{subj[n], 2}), \sigma), &amp; \text{ if } z_n =1 \\
\mathit{LogNormal}(\gamma + u_{subj[n], 3}, \sigma_2), &amp; \text{ if } z_n=0
\end{cases}
\end{equation}\]</span></p>
<p>We assume that the three vectors of <span class="math inline">\(u\)</span> (adjustment to the intercept and slope of the task-engaged distribution, and the adjustment to the guessing time distribution) follow a multivariate normal distribution centered on zero. For simplicity and lack of any prior knowledge about this experiment design and method, we assume the same (mildly informative) prior distribution for the three variance components and the same regularizing LKJ prior for the three correlations between the adjustments (<span class="math inline">\(\rho_{u_{1,2}}, \rho_{u_{1,3}}, \rho_{u_{2,3}}\)</span>):</p>
<p><span class="math display">\[\begin{equation}
\begin{aligned}
u &amp;\sim\mathcal{N}(0, \Sigma_u)\\
tau_{u_{1..3}} &amp; \sim \mathit{ \mathit{Normal}}_+(0, .5)\\
\rho_u &amp;\sim \mathit{LKJcorr}(2) 
\end{aligned}
\end{equation}\]</span></p>
<p>Before we fit the model to the real data set, we simulate data again; this time we simulate 100 trials of each of 20 subjects.</p>
<div class="sourceCode" id="cb1066"><pre class="sourceCode r fold-show"><code class="sourceCode r"><a class="sourceLine" id="cb1066-1" data-line-number="1"><span class="co"># Build the fake stimuli</span></a>
<a class="sourceLine" id="cb1066-2" data-line-number="2">N_subj &lt;-<span class="st"> </span><span class="dv">20</span></a>
<a class="sourceLine" id="cb1066-3" data-line-number="3">N_trials &lt;-<span class="st"> </span><span class="dv">100</span></a>
<a class="sourceLine" id="cb1066-4" data-line-number="4"><span class="co"># Parameters true values</span></a>
<a class="sourceLine" id="cb1066-5" data-line-number="5">alpha &lt;-<span class="st"> </span><span class="fl">5.8</span></a>
<a class="sourceLine" id="cb1066-6" data-line-number="6">beta &lt;-<span class="st"> </span><span class="fl">0.05</span></a>
<a class="sourceLine" id="cb1066-7" data-line-number="7">sigma &lt;-<span class="st"> </span><span class="fl">.4</span></a>
<a class="sourceLine" id="cb1066-8" data-line-number="8">sigma2 &lt;-<span class="st"> </span><span class="fl">.5</span></a>
<a class="sourceLine" id="cb1066-9" data-line-number="9">gamma &lt;-<span class="st"> </span><span class="fl">5.2</span></a>
<a class="sourceLine" id="cb1066-10" data-line-number="10">beta_task &lt;-<span class="st"> </span><span class="fl">0.1</span></a>
<a class="sourceLine" id="cb1066-11" data-line-number="11">p_btask &lt;-<span class="st"> </span><span class="fl">.85</span></a>
<a class="sourceLine" id="cb1066-12" data-line-number="12">alpha_task &lt;-<span class="st"> </span><span class="kw">qlogis</span>(p_btask)</a>
<a class="sourceLine" id="cb1066-13" data-line-number="13">p_correct &lt;-<span class="st"> </span><span class="fl">.999</span></a>
<a class="sourceLine" id="cb1066-14" data-line-number="14">tau_u &lt;-<span class="st"> </span><span class="kw">c</span>(.<span class="dv">2</span>, <span class="fl">.005</span>, <span class="fl">.3</span>)</a>
<a class="sourceLine" id="cb1066-15" data-line-number="15">rho &lt;-<span class="st"> </span><span class="fl">.3</span></a></code></pre></div>
<div class="sourceCode" id="cb1067"><pre class="sourceCode r fold-show"><code class="sourceCode r"><a class="sourceLine" id="cb1067-1" data-line-number="1"><span class="co">## Build the data set here:</span></a>
<a class="sourceLine" id="cb1067-2" data-line-number="2">N &lt;-<span class="st"> </span>N_subj <span class="op">*</span><span class="st"> </span>N_trials</a>
<a class="sourceLine" id="cb1067-3" data-line-number="3">stimuli &lt;-<span class="st"> </span><span class="kw">tibble</span>(<span class="dt">x =</span> <span class="kw">rep</span>(<span class="kw">c</span>(<span class="kw">rep</span>(<span class="op">-</span>.<span class="dv">5</span>,N_trials<span class="op">/</span><span class="dv">2</span>),</a>
<a class="sourceLine" id="cb1067-4" data-line-number="4">                            <span class="kw">rep</span>(.<span class="dv">5</span>, N_trials<span class="op">/</span><span class="dv">2</span>)), N_subj),</a>
<a class="sourceLine" id="cb1067-5" data-line-number="5">                  <span class="dt">x2 =</span> <span class="kw">rep</span>(<span class="kw">rep</span>(<span class="kw">c</span>(<span class="op">-</span>.<span class="dv">5</span>,.<span class="dv">5</span>), N_trials<span class="op">/</span><span class="dv">2</span>), N_subj),</a>
<a class="sourceLine" id="cb1067-6" data-line-number="6">                  <span class="dt">subj =</span> <span class="kw">rep</span>(<span class="dv">1</span><span class="op">:</span>N_subj, <span class="dt">each =</span> N_trials),</a>
<a class="sourceLine" id="cb1067-7" data-line-number="7">                  <span class="dt">trial =</span> <span class="kw">rep</span>(<span class="dv">1</span><span class="op">:</span>N_trials, N_subj)</a>
<a class="sourceLine" id="cb1067-8" data-line-number="8">                  )</a>
<a class="sourceLine" id="cb1067-9" data-line-number="9">stimuli</a></code></pre></div>
<pre><code>## # A tibble: 2,000 x 4
##       x    x2  subj trial
##   &lt;dbl&gt; &lt;dbl&gt; &lt;int&gt; &lt;int&gt;
## 1  -0.5  -0.5     1     1
## 2  -0.5   0.5     1     2
## 3  -0.5  -0.5     1     3
## # … with 1,997 more rows</code></pre>
<div class="sourceCode" id="cb1069"><pre class="sourceCode r fold-show"><code class="sourceCode r"><a class="sourceLine" id="cb1069-1" data-line-number="1">Cor_u &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">rep</span>(rho, <span class="dv">9</span>), <span class="dt">nrow =</span> <span class="dv">3</span>)</a>
<a class="sourceLine" id="cb1069-2" data-line-number="2"><span class="kw">diag</span>(Cor_u) &lt;-<span class="st"> </span><span class="dv">1</span></a>
<a class="sourceLine" id="cb1069-3" data-line-number="3">Cor_u</a></code></pre></div>
<pre><code>##      [,1] [,2] [,3]
## [1,]  1.0  0.3  0.3
## [2,]  0.3  1.0  0.3
## [3,]  0.3  0.3  1.0</code></pre>
<div class="sourceCode" id="cb1071"><pre class="sourceCode r fold-show"><code class="sourceCode r"><a class="sourceLine" id="cb1071-1" data-line-number="1"><span class="co"># Variance covariance matrix for subjects:</span></a>
<a class="sourceLine" id="cb1071-2" data-line-number="2">Sigma_u &lt;-<span class="st"> </span><span class="kw">diag</span>(tau_u, <span class="dv">3</span>, <span class="dv">3</span>) <span class="op">%*%</span><span class="st"> </span>Cor_u <span class="op">%*%</span><span class="st"> </span><span class="kw">diag</span>(tau_u, <span class="dv">3</span>, <span class="dv">3</span>)</a>
<a class="sourceLine" id="cb1071-3" data-line-number="3"><span class="co"># Create the correlated adjustments </span></a>
<a class="sourceLine" id="cb1071-4" data-line-number="4">u &lt;-<span class="st"> </span><span class="kw">mvrnorm</span>(<span class="dt">n =</span> N_subj, <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>), Sigma_u)</a>
<a class="sourceLine" id="cb1071-5" data-line-number="5"><span class="co"># Check whether they are correctly correlated</span></a>
<a class="sourceLine" id="cb1071-6" data-line-number="6"><span class="co"># (There will be some random variation,</span></a>
<a class="sourceLine" id="cb1071-7" data-line-number="7"><span class="co"># but if you increase the number of observations and</span></a>
<a class="sourceLine" id="cb1071-8" data-line-number="8"><span class="co"># the value of the correlation, you&#39;ll be able to obtain</span></a>
<a class="sourceLine" id="cb1071-9" data-line-number="9"><span class="co"># a more exact value below)</span></a>
<a class="sourceLine" id="cb1071-10" data-line-number="10"><span class="kw">cor</span>(u)</a></code></pre></div>
<pre><code>##        [,1]     [,2]     [,3]
## [1,]  1.000  0.18155 -0.32225
## [2,]  0.182  1.00000 -0.00358
## [3,] -0.322 -0.00358  1.00000</code></pre>
<div class="sourceCode" id="cb1073"><pre class="sourceCode r fold-show"><code class="sourceCode r"><a class="sourceLine" id="cb1073-1" data-line-number="1"><span class="co"># Check the SDs</span></a>
<a class="sourceLine" id="cb1073-2" data-line-number="2"><span class="kw">sd</span>(u[, <span class="dv">1</span>]); <span class="kw">sd</span>(u[, <span class="dv">2</span>]); <span class="kw">sd</span>(u[, <span class="dv">3</span>])</a></code></pre></div>
<pre><code>## [1] 0.205</code></pre>
<pre><code>## [1] 0.00517</code></pre>
<pre><code>## [1] 0.208</code></pre>
<div class="sourceCode" id="cb1077"><pre class="sourceCode r fold-show"><code class="sourceCode r"><a class="sourceLine" id="cb1077-1" data-line-number="1"><span class="co"># Create the simulated data</span></a>
<a class="sourceLine" id="cb1077-2" data-line-number="2">df_dots_simdata &lt;-<span class="st"> </span>stimuli <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb1077-3" data-line-number="3"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">z =</span> <span class="kw">rbern</span>(N, <span class="dt">prob =</span> <span class="kw">plogis</span>(alpha_task <span class="op">+</span><span class="st"> </span>x2 <span class="op">*</span><span class="st"> </span>beta_task)),</a>
<a class="sourceLine" id="cb1077-4" data-line-number="4">         <span class="dt">rt =</span> <span class="kw">ifelse</span>(z,</a>
<a class="sourceLine" id="cb1077-5" data-line-number="5">             <span class="kw">rlnorm</span>(N, <span class="dt">meanlog =</span> alpha <span class="op">+</span><span class="st"> </span>u[subj, <span class="dv">1</span>] <span class="op">+</span></a>
<a class="sourceLine" id="cb1077-6" data-line-number="6"><span class="st">                             </span>(beta <span class="op">+</span><span class="st"> </span>u[subj, <span class="dv">2</span>]) <span class="op">*</span><span class="st"> </span>x,</a>
<a class="sourceLine" id="cb1077-7" data-line-number="7">                    <span class="dt">sdlog =</span> sigma),</a>
<a class="sourceLine" id="cb1077-8" data-line-number="8">             <span class="kw">rlnorm</span>(N, <span class="dt">meanlog =</span> gamma <span class="op">+</span><span class="st"> </span>u[subj, <span class="dv">3</span>],</a>
<a class="sourceLine" id="cb1077-9" data-line-number="9">                    <span class="dt">sdlog =</span> sigma2)),</a>
<a class="sourceLine" id="cb1077-10" data-line-number="10">         <span class="dt">acc =</span> <span class="kw">ifelse</span>(z, <span class="kw">rbern</span>(<span class="dt">n =</span> N, p_correct),</a>
<a class="sourceLine" id="cb1077-11" data-line-number="11">              <span class="kw">rbern</span>(<span class="dt">n =</span> N, <span class="fl">.5</span>)),</a>
<a class="sourceLine" id="cb1077-12" data-line-number="12">         <span class="dt">diff =</span> <span class="kw">if_else</span>(x <span class="op">==</span><span class="st"> </span><span class="fl">.5</span>, <span class="st">&quot;hard&quot;</span>, <span class="st">&quot;easy&quot;</span>),</a>
<a class="sourceLine" id="cb1077-13" data-line-number="13">         <span class="dt">emphasis =</span> <span class="kw">ifelse</span>(x2 <span class="op">==</span><span class="st"> </span><span class="fl">.5</span>, <span class="st">&quot;accuracy&quot;</span>, <span class="st">&quot;speed&quot;</span>))</a></code></pre></div>
<p>Verify that the distribution of the simulated response times conditional on the simulated accuracy and the experimental manipulations make sense with the following plot shown in Figure <a href="a-mixture-model-of-the-speed-accuracy-trade-off-the-fast-guess-model-account.html#fig:simdatartacc">20.13</a>.</p>

<div class="sourceCode" id="cb1078"><pre class="sourceCode r fold-show"><code class="sourceCode r"><a class="sourceLine" id="cb1078-1" data-line-number="1"><span class="kw">ggplot</span>(df_dots_simdata, <span class="kw">aes</span>(<span class="dt">x =</span> <span class="kw">factor</span>(acc), <span class="dt">y =</span> rt)) <span class="op">+</span></a>
<a class="sourceLine" id="cb1078-2" data-line-number="2"><span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">position =</span> <span class="kw">position_jitter</span>(<span class="dt">width =</span> <span class="fl">.4</span>, </a>
<a class="sourceLine" id="cb1078-3" data-line-number="3">                                        <span class="dt">height =</span> <span class="dv">0</span>), <span class="dt">alpha =</span> <span class="fl">.5</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb1078-4" data-line-number="4"><span class="st">  </span><span class="kw">facet_wrap</span>(diff <span class="op">~</span><span class="st"> </span>emphasis) <span class="op">+</span></a>
<a class="sourceLine" id="cb1078-5" data-line-number="5"><span class="st">  </span><span class="kw">xlab</span>(<span class="st">&quot;Accuracy&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb1078-6" data-line-number="6"><span class="st">  </span><span class="kw">ylab</span>(<span class="st">&quot;Response time&quot;</span>)</a></code></pre></div>
<div class="figure"><span style="display:block;" id="fig:simdatartacc"></span>
<img src="bookdown_files/figure-html/simdatartacc-1.svg" alt="Distribution of response times conditional on the simulated accuracy and the experimental manipulations for the simulated hierarchical data (df_dots_simdata) that follows the fast-guess model." width="672" />
<p class="caption">
FIGURE 20.13: Distribution of response times conditional on the simulated accuracy and the experimental manipulations for the simulated hierarchical data (<code>df_dots_simdata</code>) that follows the fast-guess model.
</p>
</div>
<p>We implement the model in Stan as follows. The hierarchical extension uses the Cholesky factorization for the group-level effects (as we did in <a href="sec:hierstan.html#sec:corrstan">11.1.3</a>).</p>
<pre class="stan fold-show"><code>data {
  int&lt;lower = 1&gt; N;
  vector[N] x;
  vector[N] rt;
  int acc[N];
  vector[N] x2; //speed or accuracy emphasis
  int&lt;lower = 1&gt; N_subj;
  int&lt;lower = 1, upper = N_subj&gt; subj[N];
}
parameters {
  real alpha;
  real beta;
  real&lt;lower = 0&gt; sigma;
  real&lt;upper = alpha&gt; gamma; //guessing
  real&lt;lower = 0&gt; sigma2;
  real&lt;lower = 0, upper = 1&gt; p_correct;
  real&lt;lower = 0, upper = 1&gt; p_btask;
  real beta_task;
  vector&lt;lower = 0&gt;[3]  tau_u;   
  matrix[3, N_subj] z_u;
  cholesky_factor_corr[3] L_u;
}
transformed parameters {
  matrix[N_subj, 3] u;
  u = (diag_pre_multiply(tau_u, L_u) * z_u)&#39;;
}
model {
  // priors for the task component
  target += normal_lpdf(alpha | 6, 1);
  target += normal_lpdf(beta | 0, .1);
  target += normal_lpdf(sigma | .5, .2)
    - normal_lccdf(0 | .5, .2);
  // priors for the guessing component
  target += normal_lpdf(gamma | 6, 1) - 
    normal_lcdf(alpha | 6, 1);
  target += normal_lpdf(sigma2 | .5, .2)
    - normal_lccdf(0 | .5, .2);
  target += normal_lpdf(tau_u | 0, .5)
    - 3* normal_lccdf(0 | 0, .5);
  target += normal_lpdf(beta_task | 0, 1);
  target += beta_lpdf(p_correct | 995, 5);
  target += beta_lpdf(p_btask | 8, 2);
  target += lkj_corr_cholesky_lpdf(L_u | 2);
  target += std_normal_lpdf(to_vector(z_u));

  for(n in 1:N){
    real lodds_task = logit(p_btask) + x2[n] * beta_task;
    target += log_sum_exp(log_inv_logit(lodds_task) +
                          lognormal_lpdf(rt[n] | alpha + u[subj[n], 1] +
                                         x[n] * (beta + u[subj[n], 2]), sigma) +
                          bernoulli_lpmf(acc[n] | p_correct),
                          log1m_inv_logit(lodds_task) +
                          lognormal_lpdf(rt[n] | gamma + u[subj[n], 3], sigma2) +
                          bernoulli_lpmf(acc[n] |.5));
  }
}
generated quantities {
  corr_matrix[3] rho_u = L_u * L_u&#39;;
}</code></pre>
<p>Save the model code as <code>mixture_h.stan</code> and fit it to the simulated data:</p>
<div class="sourceCode" id="cb1080"><pre class="sourceCode r fold-show"><code class="sourceCode r"><a class="sourceLine" id="cb1080-1" data-line-number="1">ls_dots_simdata &lt;-<span class="st"> </span><span class="kw">list</span>(<span class="dt">N =</span> N,</a>
<a class="sourceLine" id="cb1080-2" data-line-number="2">                        <span class="dt">rt =</span> df_dots_simdata<span class="op">$</span>rt,</a>
<a class="sourceLine" id="cb1080-3" data-line-number="3">                        <span class="dt">x =</span> df_dots_simdata<span class="op">$</span>x,</a>
<a class="sourceLine" id="cb1080-4" data-line-number="4">                        <span class="dt">x2 =</span> df_dots_simdata<span class="op">$</span>x2,</a>
<a class="sourceLine" id="cb1080-5" data-line-number="5">                        <span class="dt">acc =</span> df_dots_simdata<span class="op">$</span>acc,</a>
<a class="sourceLine" id="cb1080-6" data-line-number="6">                        <span class="dt">subj =</span> df_dots_simdata<span class="op">$</span>subj,</a>
<a class="sourceLine" id="cb1080-7" data-line-number="7">                          <span class="dt">N_subj =</span> N_subj)</a>
<a class="sourceLine" id="cb1080-8" data-line-number="8">mixture_h &lt;-<span class="st"> </span><span class="kw">system.file</span>(<span class="st">&quot;stan_models&quot;</span>,</a>
<a class="sourceLine" id="cb1080-9" data-line-number="9">                        <span class="st">&quot;mixture_h.stan&quot;</span>,</a>
<a class="sourceLine" id="cb1080-10" data-line-number="10">                        <span class="dt">package =</span> <span class="st">&quot;bcogsci&quot;</span>)</a>
<a class="sourceLine" id="cb1080-11" data-line-number="11">fit_mix_h &lt;-<span class="st"> </span><span class="kw">stan</span>(<span class="dt">file =</span> mixture_h,</a>
<a class="sourceLine" id="cb1080-12" data-line-number="12">                  <span class="dt">data =</span> ls_dots_simdata,</a>
<a class="sourceLine" id="cb1080-13" data-line-number="13">                  <span class="dt">iter =</span> <span class="dv">3000</span>,</a>
<a class="sourceLine" id="cb1080-14" data-line-number="14">                  <span class="dt">control =</span> <span class="kw">list</span>(<span class="dt">adapt_delta =</span> <span class="fl">.9</span>))</a></code></pre></div>
<div class="sourceCode" id="cb1081"><pre class="sourceCode r fold-show"><code class="sourceCode r"><a class="sourceLine" id="cb1081-1" data-line-number="1"><span class="kw">print</span>(fit_mix_h, <span class="dt">pars =</span> <span class="kw">c</span>(<span class="st">&quot;alpha&quot;</span>, <span class="st">&quot;beta&quot;</span>, <span class="st">&quot;sigma&quot;</span>, <span class="st">&quot;gamma&quot;</span>, <span class="st">&quot;sigma2&quot;</span>,</a>
<a class="sourceLine" id="cb1081-2" data-line-number="2">                          <span class="st">&quot;p_correct&quot;</span>,<span class="st">&quot;p_btask&quot;</span>, <span class="st">&quot;beta_task&quot;</span>, <span class="st">&quot;tau_u&quot;</span>,</a>
<a class="sourceLine" id="cb1081-3" data-line-number="3">                          <span class="st">&quot;rho_u[1,2]&quot;</span>, <span class="st">&quot;rho_u[1,3]&quot;</span>, <span class="st">&quot;rho_u[2,3]&quot;</span>))</a></code></pre></div>
<pre><code>##             mean  2.5% 97.5% n_eff Rhat
## alpha       5.73  5.65  5.82   821 1.00
## beta        0.05  0.00  0.09  6061 1.00
## sigma       0.40  0.38  0.42  8705 1.00
## gamma       5.16  4.93  5.38  2383 1.00
## sigma2      0.55  0.49  0.61  8497 1.00
## p_correct   1.00  0.99  1.00  8264 1.00
## p_btask     0.85  0.83  0.88  8341 1.00
## beta_task   0.07 -0.24  0.39  9331 1.00
## tau_u[1]    0.19  0.13  0.28  1549 1.00
## tau_u[2]    0.06  0.00  0.14  1499 1.00
## tau_u[3]    0.46  0.31  0.67  2519 1.00
## rho_u[1,2]  0.04 -0.60  0.64  7077 1.00
## rho_u[1,3]  0.04 -0.40  0.46  2717 1.00
## rho_u[2,3] -0.08 -0.71  0.58   615 1.01</code></pre>
<p>We see that we can fit the hierarchical extension of our model to simulated data. Next we’ll evaluate whether we can recover the true values of the parameters.</p>
<div id="recovery-of-the-parameters" class="section level4">
<h4><span class="header-section-number">20.1.5.1</span> Recovery of the parameters</h4>
<p>By “recovering” the true values of the parameters, we mean that the true values are somewhere inside the bulk of the posterior distribution of the model.</p>
<p>We use <code>mcmc_recover_hist</code> to compare the posterior distributions of the relevant parameters of the model with their true values.</p>
<div class="sourceCode" id="cb1083"><pre class="sourceCode r fold-show"><code class="sourceCode r"><a class="sourceLine" id="cb1083-1" data-line-number="1">df_fit_mix_h &lt;-<span class="st"> </span>fit_mix_h <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">as.data.frame</span>() <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb1083-2" data-line-number="2"><span class="st">  </span><span class="kw">select</span>(<span class="kw">c</span>(<span class="st">&quot;alpha&quot;</span>, <span class="st">&quot;beta&quot;</span>, <span class="st">&quot;sigma&quot;</span>, <span class="st">&quot;gamma&quot;</span>, <span class="st">&quot;sigma2&quot;</span>,</a>
<a class="sourceLine" id="cb1083-3" data-line-number="3">           <span class="st">&quot;p_correct&quot;</span>,<span class="st">&quot;p_btask&quot;</span>, <span class="st">&quot;beta_task&quot;</span>, <span class="st">&quot;tau_u[1]&quot;</span>,</a>
<a class="sourceLine" id="cb1083-4" data-line-number="4">           <span class="st">&quot;tau_u[2]&quot;</span>, <span class="st">&quot;tau_u[3]&quot;</span>, <span class="st">&quot;rho_u[1,2]&quot;</span>, <span class="st">&quot;rho_u[1,3]&quot;</span>,</a>
<a class="sourceLine" id="cb1083-5" data-line-number="5">           <span class="st">&quot;rho_u[2,3]&quot;</span>))</a>
<a class="sourceLine" id="cb1083-6" data-line-number="6">true_values &lt;-<span class="st"> </span><span class="kw">c</span>(alpha, beta, sigma, gamma, sigma2,</a>
<a class="sourceLine" id="cb1083-7" data-line-number="7">                p_correct, p_btask, beta_task, tau_u[<span class="dv">1</span>],</a>
<a class="sourceLine" id="cb1083-8" data-line-number="8">                tau_u[<span class="dv">2</span>], tau_u[<span class="dv">3</span>], <span class="kw">rep</span>(rho,<span class="dv">3</span>))</a>
<a class="sourceLine" id="cb1083-9" data-line-number="9"><span class="kw">mcmc_recover_hist</span>(df_fit_mix_h, true_values)</a></code></pre></div>
<p><img src="bookdown_files/figure-html/unnamed-chunk-592-1.svg" width="672" /></p>
<p>The model seems to be underestimating the probability of being correct of the subjects (<code>p_correct</code>) and overestimating the probability of being engaged in the task (<code>p_btask</code>). However, the numerical differences are very small. We can be relatively certain that the model is not seriously misspecified. A more principled (and computationally demanding) approach uses simulation based calibration (SBC), which is discussed in <span class="citation">Talts et al. (<a href="#ref-talts2018validating">2018</a>)</span> and <span class="citation">Schad, Betancourt, and Vasishth (<a href="#ref-schad2020toward">2020</a>)</span>.</p>
</div>
<div id="fitting-the-model-to-real-data" class="section level4">
<h4><span class="header-section-number">20.1.5.2</span> Fitting the model to real data</h4>
<p>After verifying that our model works as expected, we are ready to fit it to real data. We code the predictors <span class="math inline">\(x\)</span> and <span class="math inline">\(x_2\)</span> as we did for the simulated data:</p>
<div class="sourceCode" id="cb1084"><pre class="sourceCode r fold-show"><code class="sourceCode r"><a class="sourceLine" id="cb1084-1" data-line-number="1">df_dots &lt;-<span class="st"> </span>df_dots <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb1084-2" data-line-number="2"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">x =</span> <span class="kw">if_else</span>(diff <span class="op">==</span><span class="st"> &quot;easy&quot;</span>, <span class="fl">-.5</span>, <span class="fl">.5</span>),</a>
<a class="sourceLine" id="cb1084-3" data-line-number="3">         <span class="dt">x2 =</span> <span class="kw">if_else</span>(emphasis <span class="op">==</span><span class="st"> &quot;accuracy&quot;</span>, <span class="fl">.5</span>, <span class="fl">-.5</span>))</a></code></pre></div>
<p>The main obstacle now is that fitting the entire data set takes around 12 hours! We’ll sample 600 observations of each subject as follows:</p>
<div class="sourceCode" id="cb1085"><pre class="sourceCode r fold-show"><code class="sourceCode r"><a class="sourceLine" id="cb1085-1" data-line-number="1">df_dots_data_short &lt;-<span class="st"> </span>df_dots <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb1085-2" data-line-number="2"><span class="st">  </span><span class="kw">group_by</span>(subj) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1085-3" data-line-number="3"><span class="st">  </span><span class="kw">sample_n</span>(<span class="dv">600</span>)</a></code></pre></div>
<div class="sourceCode" id="cb1086"><pre class="sourceCode r fold-show"><code class="sourceCode r"><a class="sourceLine" id="cb1086-1" data-line-number="1">ls_dots_data_short &lt;-</a>
<a class="sourceLine" id="cb1086-2" data-line-number="2"><span class="st">  </span><span class="kw">list</span>(<span class="dt">N =</span> <span class="kw">nrow</span>(df_dots_data_short),</a>
<a class="sourceLine" id="cb1086-3" data-line-number="3">       <span class="dt">rt =</span> df_dots_data_short<span class="op">$</span>rt,</a>
<a class="sourceLine" id="cb1086-4" data-line-number="4">       <span class="dt">x =</span> df_dots_data_short<span class="op">$</span>x,</a>
<a class="sourceLine" id="cb1086-5" data-line-number="5">       <span class="dt">x2 =</span> df_dots_data_short<span class="op">$</span>x2,</a>
<a class="sourceLine" id="cb1086-6" data-line-number="6">       <span class="dt">acc =</span> df_dots_data_short<span class="op">$</span>acc,</a>
<a class="sourceLine" id="cb1086-7" data-line-number="7">       <span class="dt">subj =</span> <span class="kw">as.numeric</span>(df_dots_data_short<span class="op">$</span>subj),</a>
<a class="sourceLine" id="cb1086-8" data-line-number="8">       <span class="dt">N_subj =</span> <span class="kw">length</span>(<span class="kw">unique</span>(df_dots_data_short<span class="op">$</span>subj)))</a>
<a class="sourceLine" id="cb1086-9" data-line-number="9">fit_mix_data &lt;-<span class="st"> </span><span class="kw">stan</span>(<span class="dt">file =</span> mixture_h,</a>
<a class="sourceLine" id="cb1086-10" data-line-number="10">                     <span class="dt">data =</span> ls_dots_data_short,</a>
<a class="sourceLine" id="cb1086-11" data-line-number="11">                     <span class="dt">chains =</span> <span class="dv">4</span>,</a>
<a class="sourceLine" id="cb1086-12" data-line-number="12">                     <span class="dt">iter =</span> <span class="dv">2000</span>,</a>
<a class="sourceLine" id="cb1086-13" data-line-number="13">                     <span class="dt">control =</span> <span class="kw">list</span>(<span class="dt">adapt_delta =</span>.<span class="dv">9</span>,</a>
<a class="sourceLine" id="cb1086-14" data-line-number="14">                                    <span class="dt">max_treedepth =</span> <span class="dv">12</span>))</a></code></pre></div>
<p>The model has not converged at all!</p>
<div class="sourceCode" id="cb1087"><pre class="sourceCode r fold-show"><code class="sourceCode r"><a class="sourceLine" id="cb1087-1" data-line-number="1"><span class="kw">print</span>(fit_mix_data,</a>
<a class="sourceLine" id="cb1087-2" data-line-number="2">      <span class="dt">pars =</span> <span class="kw">c</span>(<span class="st">&quot;alpha&quot;</span>, <span class="st">&quot;beta&quot;</span>, <span class="st">&quot;sigma&quot;</span>, <span class="st">&quot;gamma&quot;</span>, <span class="st">&quot;sigma2&quot;</span>,</a>
<a class="sourceLine" id="cb1087-3" data-line-number="3">               <span class="st">&quot;p_correct&quot;</span>,<span class="st">&quot;p_btask&quot;</span>, <span class="st">&quot;beta_task&quot;</span>, <span class="st">&quot;tau_u&quot;</span>,</a>
<a class="sourceLine" id="cb1087-4" data-line-number="4">               <span class="st">&quot;rho_u[1,2]&quot;</span>, <span class="st">&quot;rho_u[1,3]&quot;</span>, <span class="st">&quot;rho_u[2,3]&quot;</span>))</a></code></pre></div>
<pre><code>##            mean  2.5% 97.5% n_eff  Rhat
## alpha      6.36  6.28  6.47     3  1.55
## beta       0.11  0.07  0.17     2  2.44
## sigma      0.24  0.22  0.29     2 11.65
## gamma      6.24  6.07  6.35     2  2.48
## sigma2     0.38  0.21  0.44     2 18.19
## p_correct  0.98  0.93  1.00     2 11.74
## p_btask    0.75  0.68  0.92     2  8.77
## beta_task  2.00  0.78  5.71     2 10.99
## tau_u[1]   0.14  0.10  0.20    40  1.06
## tau_u[2]   0.05  0.03  0.08    16  1.08
## tau_u[3]   0.18  0.12  0.27     7  1.18
## rho_u[1,2] 0.46  0.00  0.82    23  1.06
## rho_u[1,3] 0.16 -0.28  0.55   518  1.02
## rho_u[2,3] 0.02 -0.46  0.52    13  1.11</code></pre>
<p>The traceplots in Figure <a href="a-mixture-model-of-the-speed-accuracy-trade-off-the-fast-guess-model-account.html#fig:traceplotmulti">20.14</a> show that the chains are not mixing at all. It seems that the posterior is multimodal, and there are at least two combinations of parameters that would fit the data equally well.</p>

<div class="sourceCode" id="cb1089"><pre class="sourceCode r fold-show"><code class="sourceCode r"><a class="sourceLine" id="cb1089-1" data-line-number="1"><span class="kw">traceplot</span>(fit_mix_data)</a></code></pre></div>
<div class="figure"><span style="display:block;" id="fig:traceplotmulti"></span>
<img src="bookdown_files/figure-html/traceplotmulti-1.svg" alt="Traceplots from the hierarchical model (mixture_h.stan) fit to (a subset) of the real data. The traceplot shows clearly that the posterior has at least two modes." width="672" />
<p class="caption">
FIGURE 20.14: Traceplots from the hierarchical model (<code>mixture_h.stan</code>) fit to (a subset) of the real data. The traceplot shows clearly that the posterior has at least two modes.
</p>
</div>
<p>What should we do now? It can be a good idea to back off and simplify the model. Once the simplified model converges, we can think about adding further complexity. The verbal description of our model says that the accuracy in the task-engaged mode should be close to 100%. To simplify the model, we’ll assume that it’s exactly 100%. This entails the following:</p>
<p><span class="math display">\[\begin{equation}
p_{correct} = 1
\end{equation}\]</span></p>
<p>We adapt our Stan code in <code>mixture_h2.stan</code> reflecting that <code>p_correct</code> is no longer a parameter and it’s now in a block called <code>transformed data</code>. There we assign to <code>p_correct</code> the value of <code>1</code>.</p>
<pre class="stan fold-show"><code>data {
  int&lt;lower = 1&gt; N;
  vector[N] x;
  vector[N] rt;
  int acc[N];
  vector[N] x2; //speed or accuracy emphasis
  int&lt;lower = 1&gt; N_subj;
  int&lt;lower = 1, upper = N_subj&gt; subj[N];
}
transformed data {
  real p_correct = 1;
}
parameters {
  real alpha;
  real beta;
  real&lt;lower = 0&gt; sigma;
  real&lt;upper = alpha&gt; gamma; //guessing
  real&lt;lower = 0&gt; sigma2;
  real&lt;lower = 0, upper = 1&gt; p_btask;
  real beta_task;
  vector&lt;lower = 0&gt;[3]  tau_u;   
  matrix[3, N_subj] z_u;
  cholesky_factor_corr[3] L_u;
}
transformed parameters {
  matrix[N_subj, 3] u;
  u = (diag_pre_multiply(tau_u, L_u) * z_u)&#39;;
}
model {
  // priors for the task component
  target += normal_lpdf(alpha | 6, 1);
  target += normal_lpdf(beta | 0, .1);
  target += normal_lpdf(sigma | .5, .2)
    - normal_lccdf(0 | .5, .2);
  // priors for the guessing component
  target += normal_lpdf(gamma | 6, 1) - 
    normal_lcdf(alpha | 6, 1);
  target += normal_lpdf(sigma2 | .5, .2)
    - normal_lccdf(0 | .5, .2);
  target += normal_lpdf(tau_u | 0, .5)
    - 3* normal_lccdf(0 | 0, .5);
  target += normal_lpdf(beta_task | 0, 1);
  target += beta_lpdf(p_btask | 8, 2);
  target += lkj_corr_cholesky_lpdf(L_u | 2);
  target += std_normal_lpdf(to_vector(z_u));

  for(n in 1:N){
    real lodds_task = logit(p_btask) + x2[n] * beta_task;
    target += log_sum_exp(log_inv_logit(lodds_task) +
                          lognormal_lpdf(rt[n] | alpha + u[subj[n], 1] +
                                         x[n] * (beta + u[subj[n], 2]), sigma) +
                          bernoulli_lpmf(acc[n] | p_correct),
                          log1m_inv_logit(lodds_task) +
                          lognormal_lpdf(rt[n] | gamma + u[subj[n], 3], sigma2) +
                          bernoulli_lpmf(acc[n] |.5));
  }
}
generated quantities {
  corr_matrix[3] rho_u = L_u * L_u&#39;;
}</code></pre>
<p>Fit the model again to the same data:</p>
<div class="sourceCode" id="cb1091"><pre class="sourceCode r fold-show"><code class="sourceCode r"><a class="sourceLine" id="cb1091-1" data-line-number="1">fit_mixs_data &lt;-<span class="st"> </span><span class="kw">stan</span>(<span class="dt">file =</span> mixture_h,</a>
<a class="sourceLine" id="cb1091-2" data-line-number="2">                     <span class="dt">data =</span> ls_dots_data_short,</a>
<a class="sourceLine" id="cb1091-3" data-line-number="3">                     <span class="dt">chains =</span> <span class="dv">4</span>,</a>
<a class="sourceLine" id="cb1091-4" data-line-number="4">                     <span class="dt">iter =</span> <span class="dv">2000</span>,</a>
<a class="sourceLine" id="cb1091-5" data-line-number="5">                     <span class="dt">control =</span> <span class="kw">list</span>(<span class="dt">adapt_delta =</span>.<span class="dv">9</span>,</a>
<a class="sourceLine" id="cb1091-6" data-line-number="6">                                    <span class="dt">max_treedepth =</span> <span class="dv">12</span>))</a></code></pre></div>
<p>The model has now converged.</p>
<div class="sourceCode" id="cb1092"><pre class="sourceCode r fold-show"><code class="sourceCode r"><a class="sourceLine" id="cb1092-1" data-line-number="1"><span class="kw">print</span>(fit_mixs_data,</a>
<a class="sourceLine" id="cb1092-2" data-line-number="2">      <span class="dt">pars =</span> <span class="kw">c</span>(<span class="st">&quot;alpha&quot;</span>, <span class="st">&quot;beta&quot;</span>, <span class="st">&quot;sigma&quot;</span>, <span class="st">&quot;gamma&quot;</span>, <span class="st">&quot;sigma2&quot;</span>,</a>
<a class="sourceLine" id="cb1092-3" data-line-number="3">               <span class="st">&quot;p_btask&quot;</span>, <span class="st">&quot;beta_task&quot;</span>, <span class="st">&quot;tau_u&quot;</span>,</a>
<a class="sourceLine" id="cb1092-4" data-line-number="4">               <span class="st">&quot;rho_u[1,2]&quot;</span>, <span class="st">&quot;rho_u[1,3]&quot;</span>, <span class="st">&quot;rho_u[2,3]&quot;</span>))</a></code></pre></div>
<pre><code>##             mean  2.5% 97.5% n_eff Rhat
## alpha       6.34  6.29  6.40   667    1
## beta        0.10  0.07  0.12  1841    1
## sigma       0.22  0.21  0.23  4727    1
## gamma       6.29  6.21  6.35  1254    1
## sigma2      0.43  0.42  0.44  4386    1
## p_btask     0.69  0.68  0.70  4686    1
## beta_task   0.88  0.75  1.02  4608    1
## tau_u[1]    0.14  0.10  0.20   942    1
## tau_u[2]    0.05  0.03  0.08  1737    1
## tau_u[3]    0.19  0.13  0.27  1552    1
## rho_u[1,2]  0.40 -0.07  0.75  2194    1
## rho_u[1,3]  0.15 -0.28  0.53  1390    1
## rho_u[2,3] -0.03 -0.48  0.44  1071    1</code></pre>
<p>The traceplots in Figure <a href="a-mixture-model-of-the-speed-accuracy-trade-off-the-fast-guess-model-account.html#fig:traceplotnomulti">20.15</a> show that this times the chains are mixing well.</p>

<div class="sourceCode" id="cb1094"><pre class="sourceCode r fold-hide"><code class="sourceCode r"><a class="sourceLine" id="cb1094-1" data-line-number="1"></a>
<a class="sourceLine" id="cb1094-2" data-line-number="2"><span class="kw">traceplot</span>(fit_mixs_data)</a></code></pre></div>
<div class="figure"><span style="display:block;" id="fig:traceplotnomulti"></span>
<img src="bookdown_files/figure-html/traceplotnomulti-1.svg" alt="Traceplots from the simplified hierarchical model (mixture_h.stan, assuming that p_correct = 1) fit to (a subset) of the real data. The traceplot shows that chains are mixing well." width="672" />
<p class="caption">
FIGURE 20.15: Traceplots from the simplified hierarchical model (<code>mixture_h.stan</code>, assuming that <code>p_correct = 1</code>) fit to (a subset) of the real data. The traceplot shows that chains are mixing well.
</p>
</div>
<p>What can we say about the fit of the model now?</p>
<p><em>Under the assumptions that we have made</em> (e.g., there are two processing modes, response times are affected by the difficulty of the task in the task-engaged mode, accuracy is not affected by the difficulty of the task and is perfect at the task-engaged mode, etc.), we can look at the parameters and conclude the following:</p>
<!-- - Subjects seemed to have a very high accuracy once they were engaged in the task. (`p_correct` is very high). -->
<ul>
<li>The instructions seemed to have a strong effect on the processing mode of the subjects (<code>beta_task</code> is relatively high), and in the expected direction (emphasis in accuracy led to a higher probability to be in the task engaged mode).</li>
<li>The guessing mode seemed to be much noisier than the task-engaged mode (compare <code>sigma</code> with <code>sigma2</code>).</li>
<li>Slow subjects seemed to show a stronger effect of the experimental manipulation (<code>rho_u1[1,2]</code> is mostly positive).</li>
</ul>
<p>If we want to know whether our model achieves descriptive adequacy, we need to look at the posterior predictive distributions of the model. However, by using posterior predictive checks, we won’t be able to conclude that our model is not overfitting. Our success in fitting the fast-guess model to real data does not entail that the model is a good account of the data. It just means that it’s flexible enough to fit the data. One further step could be to develop a competing model, and then comparing the performances of the models, using Bayes factors or K-fold-CV.</p>
</div>
<div id="posterior-predictive-checks" class="section level4">
<h4><span class="header-section-number">20.1.5.3</span> Posterior predictive checks</h4>
<p>For the posterior predictive checks, we can write the generated quantities block in a new file. The advantage is that we can generate as many observations as needed <em>after estimating the parameters</em>. There is no model block in the follow Stan program. The new code here is the use of the <code>gqs</code> function in the <code>rstan</code> library, which allows us to use the posterior draws from a previously fitted model to generate posterior predicted data.</p>
<pre class="stan fold-show"><code></code></pre>
<p>Generate 500 simulated data sets as follows:</p>
<div class="sourceCode" id="cb1096"><pre class="sourceCode r fold-show"><code class="sourceCode r"><a class="sourceLine" id="cb1096-1" data-line-number="1">mixture_h_gen &lt;-<span class="st"> </span><span class="kw">system.file</span>(<span class="st">&quot;stan_models&quot;</span>,</a>
<a class="sourceLine" id="cb1096-2" data-line-number="2">                            <span class="st">&quot;mixture_h_gen.stan&quot;</span>,</a>
<a class="sourceLine" id="cb1096-3" data-line-number="3">                            <span class="dt">package =</span> <span class="st">&quot;bcogsci&quot;</span>)</a>
<a class="sourceLine" id="cb1096-4" data-line-number="4">gen_model &lt;-<span class="st"> </span><span class="kw">stan_model</span>(mixture_h_gen)</a>
<a class="sourceLine" id="cb1096-5" data-line-number="5">draws_par &lt;-<span class="st"> </span><span class="kw">as.matrix</span>(fit_mixs_data)[<span class="dv">1</span><span class="op">:</span><span class="dv">500</span>, ,drop =<span class="st"> </span><span class="ot">FALSE</span>]</a>
<a class="sourceLine" id="cb1096-6" data-line-number="6">gen_mix_data &lt;-<span class="st"> </span><span class="kw">gqs</span>(gen_model,</a>
<a class="sourceLine" id="cb1096-7" data-line-number="7">                    <span class="dt">data =</span> ls_dots_data_short,</a>
<a class="sourceLine" id="cb1096-8" data-line-number="8">                    <span class="dt">draws =</span> draws_par)</a></code></pre></div>
<p>We first take a look at the general distribution of response times generated by the posterior predictive model and by our real data in Figure <a href="a-mixture-model-of-the-speed-accuracy-trade-off-the-fast-guess-model-account.html#fig:postpmix">20.16</a>.</p>

<div class="sourceCode" id="cb1097"><pre class="sourceCode r fold-show"><code class="sourceCode r"><a class="sourceLine" id="cb1097-1" data-line-number="1">rt_pred &lt;-<span class="st"> </span><span class="kw">extract</span>(gen_mix_data)<span class="op">$</span>rt_pred </a>
<a class="sourceLine" id="cb1097-2" data-line-number="2"><span class="kw">ppc_dens_overlay</span>(<span class="dt">y =</span> ls_dots_data_short<span class="op">$</span>rt, <span class="dt">yrep =</span> rt_pred[<span class="dv">1</span><span class="op">:</span><span class="dv">100</span>,]) <span class="op">+</span></a>
<a class="sourceLine" id="cb1097-3" data-line-number="3"><span class="st">  </span><span class="kw">coord_cartesian</span>(<span class="dt">xlim =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">2000</span>)) </a></code></pre></div>
<div class="figure"><span style="display:block;" id="fig:postpmix"></span>
<img src="bookdown_files/figure-html/postpmix-1.svg" alt="Posterior predictive distribution of the hierarchical fast-guess model (using mixture_h_gen.stan) in comparison with the observed response times." width="672" />
<p class="caption">
FIGURE 20.16: Posterior predictive distribution of the hierarchical fast-guess model (using <code>mixture_h_gen.stan</code>) in comparison with the observed response times.
</p>
</div>
<p>We see that the distribution of the observed response times is narrower than the predictive distribution. We are generating response times that are more spread out than the real data. <!-- has heavier tails than the predictive distribution. This means that somewhere in our model we are failing to account for response time variability. --></p>
<!-- We see that we tend to generate some responses that are too large, but the general shape of the predictive distribution of the response times is fine. -->
<!-- If we want to plot the prior predicted distribution of differences in response time conditioning on task difficulty, we need to define a new function. Then we use the `bayesplot` function `ppc_stat()` that takes as an argument of `stat` any summary function. -->
<p>Next we examine the effect of the experimental manipulation in Figure <a href="a-mixture-model-of-the-speed-accuracy-trade-off-the-fast-guess-model-account.html#fig:postpmanip">20.17</a>: The posterior predictive check reveals that the model underestimates the observed effect of the experimental manipulation: the observed difference between response times is well outside the bulk of the predictive distribution.</p>

<div class="sourceCode" id="cb1098"><pre class="sourceCode r fold-show"><code class="sourceCode r"><a class="sourceLine" id="cb1098-1" data-line-number="1">meanrt_diff &lt;-<span class="st"> </span><span class="cf">function</span>(rt){</a>
<a class="sourceLine" id="cb1098-2" data-line-number="2">  <span class="kw">mean</span>(rt[ls_dots_data_short<span class="op">$</span>x <span class="op">==</span><span class="st"> </span><span class="fl">.5</span>]) <span class="op">-</span></a>
<a class="sourceLine" id="cb1098-3" data-line-number="3"><span class="st">    </span><span class="kw">mean</span>(rt[ls_dots_data_short<span class="op">$</span>x <span class="op">==</span><span class="st"> </span><span class="fl">-.5</span>])</a>
<a class="sourceLine" id="cb1098-4" data-line-number="4">}  </a>
<a class="sourceLine" id="cb1098-5" data-line-number="5"><span class="kw">ppc_stat</span>(ls_dots_data_short<span class="op">$</span>rt,</a>
<a class="sourceLine" id="cb1098-6" data-line-number="6">         <span class="dt">yrep =</span> rt_pred,</a>
<a class="sourceLine" id="cb1098-7" data-line-number="7">         <span class="dt">stat =</span> meanrt_diff) </a></code></pre></div>
<div class="figure"><span style="display:block;" id="fig:postpmanip"></span>
<img src="bookdown_files/figure-html/postpmanip-1.svg" alt="Posterior predictive distribution (using mixture_h_gen.stan) of the difference in response time due to the experimental manipulation. The vertical bar shows the observed difference in the data." width="672" />
<p class="caption">
FIGURE 20.17: Posterior predictive distribution (using <code>mixture_h_gen.stan</code>) of the difference in response time due to the experimental manipulation. The vertical bar shows the observed difference in the data.
</p>
</div>
<p>We also look at some instances of the predictive distribution. Figure <a href="a-mixture-model-of-the-speed-accuracy-trade-off-the-fast-guess-model-account.html#fig:postppdobs">20.18</a> shows a simulated data set in black overlaid onto the real observations in gray. As we noticed in Figure <a href="a-mixture-model-of-the-speed-accuracy-trade-off-the-fast-guess-model-account.html#fig:postpmix">20.16</a>, the model is predicting less variability than what we find in the data, especially when the emphasis is on accuracy.</p>
<div class="sourceCode" id="cb1099"><pre class="sourceCode r fold-show"><code class="sourceCode r"><a class="sourceLine" id="cb1099-1" data-line-number="1">acc_pred &lt;-<span class="st"> </span><span class="kw">extract</span>(gen_mix_data)<span class="op">$</span>acc_pred</a>
<a class="sourceLine" id="cb1099-2" data-line-number="2">df_dots_pred &lt;-</a>
<a class="sourceLine" id="cb1099-3" data-line-number="3"><span class="st">  </span><span class="kw">tibble</span>(<span class="dt">rt =</span> ls_dots_data_short<span class="op">$</span>rt,</a>
<a class="sourceLine" id="cb1099-4" data-line-number="4">         <span class="dt">acc =</span> ls_dots_data_short<span class="op">$</span>acc,</a>
<a class="sourceLine" id="cb1099-5" data-line-number="5">         <span class="dt">difficulty =</span> <span class="kw">ifelse</span>(ls_dots_data_short<span class="op">$</span>x<span class="op">==</span>.<span class="dv">5</span>,</a>
<a class="sourceLine" id="cb1099-6" data-line-number="6">                             <span class="st">&quot;hard&quot;</span>, <span class="st">&quot;easy&quot;</span>),</a>
<a class="sourceLine" id="cb1099-7" data-line-number="7">         <span class="dt">emphasis =</span> <span class="kw">ifelse</span>(ls_dots_data_short<span class="op">$</span>x2 <span class="op">==-</span>.<span class="dv">5</span>,</a>
<a class="sourceLine" id="cb1099-8" data-line-number="8">                           <span class="st">&quot;speed&quot;</span>, <span class="st">&quot;accuracy&quot;</span>),</a>
<a class="sourceLine" id="cb1099-9" data-line-number="9">         <span class="dt">acc_pred1 =</span> acc_pred[<span class="dv">1</span>,],</a>
<a class="sourceLine" id="cb1099-10" data-line-number="10">         <span class="dt">rt_pred1 =</span> rt_pred[<span class="dv">1</span>,])</a></code></pre></div>

<div class="figure"><span style="display:block;" id="fig:postppdobs"></span>
<img src="bookdown_files/figure-html/postppdobs-1.svg" alt="A simulated (posterior predictive) data set in black overlaid onto the observations in gray (based on mixture_h_gen.stan)." width="672" />
<p class="caption">
FIGURE 20.18: A simulated (posterior predictive) data set in black overlaid onto the observations in gray (based on <code>mixture_h_gen.stan</code>).
</p>
</div>
<p>To conclude, the fast-guess model shows a decent fit to the data and is able to account for the speed-accuracy trade-off. The model shows some inaccuracies that could lead to its revision and improvement. To what extent the inaccuracies are acceptable or not depends on (i) the empirical finding that we want to account for (for example, we can already assume that the model will struggle to fit data sets that show slow errors); and (ii) its comparison with a competing account.</p>
<!-- #### An alternative model and model comparison -->
<!-- Finally we implement a very simple model that posits that RTs and accuracy both depend on the difficulty of the task and ignores the emphasis manipulation. -->
<!-- ```{r,  echo = FALSE, eval = !file.exists("dataR/fit_mv_data.RDS"), echo = FALSE} -->
<!--  fit_mv_data <- stan(file = 'stan_models_remove/multiv.stan', -->
<!--                      data = ls_dots_data_short, -->
<!--                      control = list(adapt_delta =.9, max_treedepth = 12)) -->
<!-- ``` -->
</div>
</div>
</div>
<h3>References</h3>
<div id="refs" class="references">
<div id="ref-britten_shadlen_newsome_movshon_1993">
<p>Britten, Kenneth H., Michael N. Shadlen, William T. Newsome, and J. Anthony Movshon. 1993. “Responses of Neurons in Macaque Mt to Stochastic Motion Signals.” <em>Visual Neuroscience</em> 10 (6). Cambridge University Press: 1157–69. <a href="https://doi.org/10.1017/S0952523800010269" class="uri">https://doi.org/10.1017/S0952523800010269</a>.</p>
</div>
<div id="ref-brownSimplestCompleteModel2008">
<p>Brown, Scott D., and Andrew Heathcote. 2008. “The Simplest Complete Model of Choice Response Time: Linear Ballistic Accumulation.” <em>Cognitive Psychology</em> 57 (3): 153–78. <a href="https://doi.org/10.1016/j.cogpsych.2007.12.002" class="uri">https://doi.org/10.1016/j.cogpsych.2007.12.002</a>.</p>
</div>
<div id="ref-Dutilh2019quality">
<p>Dutilh, Gilles, Jeffrey Annis, Scott D Brown, Peter Cassey, Nathan J Evans, Raoul PPP Grasman, Guy E Hawkins, et al. 2019. “The Quality of Response Time Data Inference: A Blinded, Collaborative Assessment of the Validity of Cognitive Models.” <em>Psychonomic Bulletin &amp; Review</em> 26 (4). Springer: 1051–69.</p>
</div>
<div id="ref-DutilhEtAl2011">
<p>Dutilh, Gilles, Eric-Jan Wagenmakers, Ingmar Visser, and Han L. J. van der Maas. 2011. “A Phase Transition Model for the Speed-Accuracy Trade-Off in Response Time Experiments.” <em>Cognitive Science</em> 35 (2): 211–50. <a href="https://doi.org/10.1111/j.1551-6709.2010.01147.x" class="uri">https://doi.org/10.1111/j.1551-6709.2010.01147.x</a>.</p>
</div>
<div id="ref-DingEtAl">
<p>Han, Ding, Jana Wegrzyn, Hua Bi, Ruihua Wei, Bin Zhang, and Xiaorong Li. 2018. “Practice Makes the Deficiency of Global Motion Detection in People with Pattern-Related Visual Stress More Apparent.” <em>PLOS ONE</em> 13 (2). Public Library of Science: 1–13. <a href="https://doi.org/10.1371/journal.pone.0193215" class="uri">https://doi.org/10.1371/journal.pone.0193215</a>.</p>
</div>
<div id="ref-HeathcoteLove2012">
<p>Heathcote, Andrew, and Jonathon Love. 2012. “Linear Deterministic Accumulator Models of Simple Choice.” <em>Frontiers in Psychology</em> 3: 292. <a href="https://doi.org/10.3389/fpsyg.2012.00292" class="uri">https://doi.org/10.3389/fpsyg.2012.00292</a>.</p>
</div>
<div id="ref-Ollman1966">
<p>Ollman, Robert. 1966. “Fast Guesses in Choice Reaction Time.” <em>Psychonomic Science</em> 6 (4). Springer: 155–56.</p>
</div>
<div id="ref-Ratcliff1978">
<p>Ratcliff, Roger. 1978. “A Theory of Memory Retrieval.” <em>Psychological Review</em> 85 (2). American Psychological Association: 59.</p>
</div>
<div id="ref-Ratcliff2016">
<p>Ratcliff, Roger, Philip L. Smith, Scott D. Brown, and Gail McKoon. 2016. “Diffusion Decision Model: Current Issues and History.” <em>Trends in Cognitive Sciences</em> 20 (4): 260–81. <a href="https://doi.org/https://doi.org/10.1016/j.tics.2016.01.007" class="uri">https://doi.org/https://doi.org/10.1016/j.tics.2016.01.007</a>.</p>
</div>
<div id="ref-RouderEtAl2015">
<p>Rouder, Jeffrey N., Jordan M. Province, Richard D. Morey, Pablo Gomez, and Andrew Heathcote. 2015. “The Lognormal Race: A Cognitive-Process Model of Choice and Latency with Desirable Psychometric Properties.” <em>Psychometrika</em> 80 (2): 491–513. <a href="https://doi.org/10.1007/s11336-013-9396-3" class="uri">https://doi.org/10.1007/s11336-013-9396-3</a>.</p>
</div>
<div id="ref-schad2020toward">
<p>Schad, Daniel J., Michael J. Betancourt, and Shravan Vasishth. 2019. “Toward a Principled Bayesian Workflow in Cognitive Science.” <em>arXiv Preprint arXiv:1904.12765</em>.</p> 2020. “Toward a Principled Bayesian Workflow in Cognitive Science.” <em>Psychological Methods</em> 26 (1). American Psychological Association: 103–26.</p>
</div>
<div id="ref-talts2018validating">
<p>Talts, Sean, Michael J. Betancourt, Daniel Simpson, Aki Vehtari, and Andrew Gelman. 2018. “Validating Bayesian Inference Algorithms with Simulation-Based Calibration.” <em>arXiv Preprint arXiv:1804.06788</em>.</p>
</div>
<div id="ref-wickelgren1977speed">
<p>Wickelgren, Wayne A. 1977. “Speed-Accuracy Tradeoff and Information Processing Dynamics.” <em>Acta Psychologica</em> 41 (1): 67–85.</p>
</div>
<div id="ref-Yellott1967">
<p>Yellott, John I. 1967. “Correction for Guessing in Choice Reaction Time.” <em>Psychonomic Science</em> 8 (8): 321–22. <a href="https://doi.org/10.3758/BF03331682" class="uri">https://doi.org/10.3758/BF03331682</a>.</p>
</div>
<div id="ref-Yellott1971">
<p>Yellott, John I. 1971. “Correction for Fast Guessing and the Speed-Accuracy Tradeoff in Choice Reaction Time.” <em>Journal of Mathematical Psychology</em> 8 (2): 159–99. <a href="https://doi.org/10.1016/0022-2496(71)90011-3" class="uri">https://doi.org/10.1016/0022-2496(71)90011-3</a>.</p>
</div>
</div>
<div class="footnotes">
<hr />
<ol start="42">
<li id="fn42"><p>Ollman original model was meant to be relevant for only means, and Yellott <span class="citation">(<a href="#ref-Yellott1967">1967</a>, <a href="#ref-Yellott1971">1971</a>)</span> generalized it to a distributional form.<a href="a-mixture-model-of-the-speed-accuracy-trade-off-the-fast-guess-model-account.html#fnref42" class="footnote-back">↩</a></p></li>
</ol>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="ch:mixture.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="summary-14.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook/js/app.min.js"></script>
<script src="libs/gitbook/js/clipboard.min.js"></script>
<script src="libs/gitbook/js/plugin-search.js"></script>
<script src="libs/gitbook/js/plugin-sharing.js"></script>
<script src="libs/gitbook/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook/js/plugin-bookdown.js"></script>
<script src="libs/gitbook/js/jquery.highlight.js"></script>
<script src="libs/gitbook/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": true,
"facebook": false,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/rstudio/bookdown/edit/master/inst/examples/20-mixtures.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["bookdown.pdf", "bookdown.epub", "bookdown.mobi"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "none"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
